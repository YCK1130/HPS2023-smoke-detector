[
    {
        "id": "9357338e01a30d92",
        "type": "tab",
        "label": "tab 跳轉",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "4f79fdad1c282705",
        "type": "tab",
        "label": "hello-world",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "e8560f358cae048b",
        "type": "tab",
        "label": "bedroom",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "b435fa1f0cb3b040",
        "type": "tab",
        "label": "Bedroom B",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "92d2ee6e5b09e9e8",
        "type": "tab",
        "label": "kitchen",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "52a4a3dc27f335fb",
        "type": "tab",
        "label": "流程3",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "5d81d50e014fd538",
        "type": "tab",
        "label": "meeting room",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "c3ddefd23650fc43",
        "type": "tab",
        "label": "流程1",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "af0d5e987f6889af",
        "type": "tab",
        "label": "Bedroom C",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "c4f86fdc5e8c2f1f",
        "type": "tab",
        "label": "entry A",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "05895f55507a8cbc",
        "type": "tab",
        "label": "entry B",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "f141c113f55a94bd",
        "type": "tab",
        "label": "aisle A",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "901e2cd0c21d04eb",
        "type": "tab",
        "label": "aisle B",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "d1a1753721bf8ad1",
        "type": "tab",
        "label": "aisle C",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "57c7b1d92e451835",
        "type": "tab",
        "label": "intersection",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "c2efc8683c66d9a1",
        "type": "tab",
        "label": "study room",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "2655994f6874c67a",
        "type": "ui_base",
        "theme": {
            "name": "theme-light",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
            },
            "themeState": {
                "base-color": {
                    "default": "#0094CE",
                    "value": "#0094CE",
                    "edited": false
                },
                "page-titlebar-backgroundColor": {
                    "value": "#0094CE",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#fafafa",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#1bbfff",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#111111",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#0094ce",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey",
                "palette": "light"
            }
        },
        "site": {
            "name": "Node-RED Dashboard",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "true",
            "dateFormat": "DD/MM/YYYY",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "70cfa938d1a6f3e9",
        "type": "ui_group",
        "name": "sensor data",
        "tab": "1b7fd984aa23bbf2",
        "order": 1,
        "disp": false,
        "width": "14",
        "collapse": false,
        "className": ""
    },
    {
        "id": "fc4acb4da1369f93",
        "type": "ui_tab",
        "name": "Home",
        "icon": "dashboard",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "1b7fd984aa23bbf2",
        "type": "ui_tab",
        "name": "bedroom",
        "icon": "dashboard",
        "order": 3,
        "disabled": false,
        "hidden": true
    },
    {
        "id": "590e1a4403a98581",
        "type": "ui_tab",
        "name": "kitchen",
        "icon": "dashboard",
        "order": 5,
        "disabled": false,
        "hidden": true
    },
    {
        "id": "bf27c1590187175e",
        "type": "ui_group",
        "name": "senor data",
        "tab": "590e1a4403a98581",
        "order": 1,
        "disp": false,
        "width": "14",
        "collapse": false,
        "className": ""
    },
    {
        "id": "654c532714216822",
        "type": "mqtt-broker",
        "name": "rpi3",
        "broker": "mqtt://rpi3.local",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "4ba5d415.d302ec",
        "type": "ui_group",
        "name": "floor plan",
        "tab": "fc4acb4da1369f93",
        "order": 1,
        "disp": false,
        "width": "16",
        "collapse": false,
        "className": ""
    },
    {
        "id": "81b1bdc3.9a60b8",
        "type": "ui_group",
        "name": "Hacks",
        "tab": "2f5baa7e.0221fe",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "2f5baa7e.0221fe",
        "type": "ui_tab",
        "name": "Settings",
        "icon": "timeline",
        "order": 2,
        "disabled": true,
        "hidden": false
    },
    {
        "id": "63115de6b1972cd9",
        "type": "linetoken",
        "name": "YCK"
    },
    {
        "id": "52377bbe3c3d6c15",
        "type": "ui_tab",
        "name": "Bedroom B",
        "icon": "dashboard",
        "order": 4,
        "disabled": false,
        "hidden": true
    },
    {
        "id": "b973fd68fe795a1c",
        "type": "ui_group",
        "name": "sensor data",
        "tab": "52377bbe3c3d6c15",
        "order": 1,
        "disp": false,
        "width": "14",
        "collapse": false,
        "className": ""
    },
    {
        "id": "f22ba35bb9141970",
        "type": "ui_tab",
        "name": "meeting room",
        "icon": "dashboard",
        "order": 6,
        "disabled": false,
        "hidden": true
    },
    {
        "id": "d5323f44ca2adf10",
        "type": "ui_group",
        "name": "sensor",
        "tab": "f22ba35bb9141970",
        "order": 1,
        "disp": false,
        "width": "14",
        "collapse": false,
        "className": ""
    },
    {
        "id": "79a66be2696ab45c",
        "type": "MySQLdatabase",
        "name": "",
        "host": "127.0.0.1",
        "port": "3306",
        "db": "sensor",
        "tz": "",
        "charset": "UTF8"
    },
    {
        "id": "4f6c8a65bb8820c6",
        "type": "mqtt-broker",
        "name": "local",
        "broker": "localhost",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "d22623692b8e01e8",
        "type": "ui_tab",
        "name": "Bedroom C",
        "icon": "dashboard",
        "disabled": false,
        "hidden": true
    },
    {
        "id": "21b841d6128a5cde",
        "type": "ui_group",
        "name": "sensor data",
        "tab": "d22623692b8e01e8",
        "order": 1,
        "disp": false,
        "width": "14",
        "collapse": false,
        "className": ""
    },
    {
        "id": "dc87ea581ec639fa",
        "type": "ui_group",
        "name": "Default",
        "tab": "98acecf0e9e2c51d",
        "order": 2,
        "disp": false,
        "width": "14",
        "collapse": false,
        "className": ""
    },
    {
        "id": "98acecf0e9e2c51d",
        "type": "ui_tab",
        "name": "entry A",
        "icon": "dashboard",
        "disabled": false,
        "hidden": true
    },
    {
        "id": "589a172e149adb34",
        "type": "ui_tab",
        "name": "entry B",
        "icon": "dashboard",
        "disabled": false,
        "hidden": true
    },
    {
        "id": "260eb05ccce4ca18",
        "type": "ui_group",
        "name": "Default",
        "tab": "589a172e149adb34",
        "order": 1,
        "disp": false,
        "width": "14",
        "collapse": false,
        "className": ""
    },
    {
        "id": "a17d3ecd78c07139",
        "type": "ui_tab",
        "name": "aisle A",
        "icon": "dashboard",
        "disabled": false,
        "hidden": true
    },
    {
        "id": "a728dc84b50e05ad",
        "type": "ui_group",
        "name": "Default",
        "tab": "a17d3ecd78c07139",
        "order": 1,
        "disp": false,
        "width": "14",
        "collapse": false,
        "className": ""
    },
    {
        "id": "f145932787092114",
        "type": "ui_tab",
        "name": "aisle B",
        "icon": "dashboard",
        "disabled": false,
        "hidden": true
    },
    {
        "id": "9d22087fef187392",
        "type": "ui_group",
        "name": "Default",
        "tab": "f145932787092114",
        "order": 1,
        "disp": false,
        "width": "14",
        "collapse": false,
        "className": ""
    },
    {
        "id": "fc215ca8937d85ba",
        "type": "ui_tab",
        "name": "aisle C",
        "icon": "dashboard",
        "disabled": false,
        "hidden": true
    },
    {
        "id": "2cfd868ec03347d9",
        "type": "ui_group",
        "name": "Default",
        "tab": "fc215ca8937d85ba",
        "order": 1,
        "disp": false,
        "width": "14",
        "collapse": false,
        "className": ""
    },
    {
        "id": "c210ede6827b628a",
        "type": "ui_tab",
        "name": "intersection",
        "icon": "dashboard",
        "disabled": false,
        "hidden": true
    },
    {
        "id": "96e7171c97b237eb",
        "type": "ui_group",
        "name": "Default",
        "tab": "c210ede6827b628a",
        "order": 1,
        "disp": false,
        "width": "14",
        "collapse": false,
        "className": ""
    },
    {
        "id": "cdaa0f463eae31d5",
        "type": "ui_tab",
        "name": "study room",
        "icon": "dashboard",
        "disabled": false,
        "hidden": true
    },
    {
        "id": "0253ddd8e0d72747",
        "type": "ui_group",
        "name": "Default",
        "tab": "cdaa0f463eae31d5",
        "order": 1,
        "disp": false,
        "width": "14",
        "collapse": false,
        "className": ""
    },
    {
        "id": "f26a59b.bdf94a8",
        "type": "ui_template",
        "z": "9357338e01a30d92",
        "group": "4ba5d415.d302ec",
        "name": "Get image click/touch coordinates",
        "order": 1,
        "width": 16,
        "height": 9,
        "format": "<img id=\"imgmap\" style=\"position: absolute; top: 0px; left: 0px;\" src=\"/floor_img.jpg\" draggable=\"false\">\n\n<div id=\"dot_bedroom\" style=\"position: absolute; top: 263px; left: 169px;\" class=\"mydot\" >\n    <img id=\"arrow_bedroom\" class=\"myArrow\"  src=\"https://cdn-icons-png.flaticon.com/512/109/109618.png\">\n</div>\n\n<div id=\"dot_kitchen\" style=\"position: absolute; top: 60px; left: 610px;\" class=\"mydot\">\n    <img id=\"arrow_kitchen\" class=\"myArrow\"  src=\"https://cdn-icons-png.flaticon.com/512/109/109618.png\">\n</div>\n\n<div id=\"dot_BedroomC\"\n    style=\"position: absolute; top: 344px; left: 365px;\" class=\"mydot\">\n    <img id=\"arrow_BedroomC\" class=\"myArrow\"  src=\"https://cdn-icons-png.flaticon.com/512/109/109618.png\">\n</div>\n\n<div id=\"dot_meetingroom\"\n    style=\"position: absolute; top: 253px; left: 615px;\" class=\"mydot\">\n    <img id=\"arrow_meetingroom\" class=\"myArrow\"  src=\"https://cdn-icons-png.flaticon.com/512/109/109618.png\">\n</div>\n<!-- \n<div id=\"dot_BedroomB\"\n    style=\"position: absolute; top: 197px; left: 767px;\" class=\"mydot\">\n    <img id=\"arrow_BedroomB\" class=\"myArrow\"  src=\"https://cdn-icons-png.flaticon.com/512/109/109618.png\">\n</div>\n\n<div id=\"dot_entryA\"\n    style=\"position: absolute; top: 163px; left: 71px;\" class=\"mydot\">\n    <img id=\"arrow_entryA\" class=\"myArrow\"  src=\"https://cdn-icons-png.flaticon.com/512/109/109618.png\">\n</div>\n\n<div id=\"dot_entryB\"\n    style=\"position: absolute; top: 345px; left: 720px;\" class=\"mydot\">\n    <img id=\"arrow_entryB\" class=\"myArrow\"  src=\"https://cdn-icons-png.flaticon.com/512/109/109618.png\">\n</div>\n\n<div id=\"dot_aisleA\"\n    style=\"position: absolute; top: 156px; left: 263px;\" class=\"mydot\">\n    <img id=\"arrow_aisleA\" class=\"myArrow\"  src=\"https://cdn-icons-png.flaticon.com/512/109/109618.png\">\n</div>\n\n<div id=\"dot_aisleB\" style=\"position: absolute; top: 156px; left: 593px;\" class=\"mydot\">\n    <img id=\"arrow_aisleB\" class=\"myArrow\"  src=\"https://cdn-icons-png.flaticon.com/512/109/109618.png\">\n</div>\n\n<div id=\"dot_aisleC\" style=\"position: absolute; top: 325px; left: 484px;\" class=\"mydot\">\n    <img id=\"arrow_aisleC\" class=\"myArrow\"  src=\"https://cdn-icons-png.flaticon.com/512/109/109618.png\">\n</div>\n\n<div id=\"dot_intersection\" style=\"position: absolute; top: 156px; left: 479px;\" class=\"mydot\">\n    <img id=\"arrow_intersection\" class=\"myArrow\"  src=\"https://cdn-icons-png.flaticon.com/512/109/109618.png\">\n</div>\n\n<div id=\"dot_studyroom\" style=\"position: absolute; top: 235px; left: 341px;\" class=\"mydot\">\n    <img id=\"arrow_studyroom\" class=\"myArrow\"  src=\"https://cdn-icons-png.flaticon.com/512/109/109618.png\">\n</div> -->\n\n<div id=\"coords\" style=\"color: black; z-index: 100; pointer-events:none;\"></div>\n<div id=\"pixels\" style=\"color: black; z-index: 100; pointer-events:none;\"></div>\n<img id=\"imgcursor\" style=\"position: absolute; top: 0px; left: 0px; height: 40px; width: 40px \" src=\"http://www.pngall.com/wp-content/uploads/2017/05/Map-Marker-PNG-File.png\">\n<div id=\"redirectButt\" class=\"mybutt\" style=\"min-width: 5em; max-width: fit-content;height:1.5em; z-index: 110;opacity:0; padding: 0 10px \">None</div>\n\n<script>\nvar areas = {\n    \"bedroom\":\"bedroom\",\n    \"kitchen\":\"kitchen\",\n    \"BedroomC\":\"Bedroom C\",\n    \"BedroomB\":\"Bedroom B\",\n    \"entryA\":\"entry A\",\n    \"entryB\":\"entry B\",\n    \"aisleA\":\"aisle A\",\n    \"aisleB\":\"aisle B\",\n    \"aisleC\":\"aisle C\",\n    \"intersection\":\"intersection\",\n    \"studyroom\":\"study room\",\n    \"meetingroom\":\"meeting room\"\n}\nvar boundary = {\n    \"bedroom\": {\n        block1: {\n            x: [0.1212, 0.2809],\n            y: [0.5010, 0.9189]\n        }\n    },\n    \"kitchen\": {\n        block1: {\n            x: [0.6399, 0.8205],\n            y: [0.00674, 0.2471]\n        },\n        block2: {\n            x: [0.6002, 0.6562],\n            y: [0.1460, 0.2471]\n        }\n    },\n    \"Bedroom C\": {\n        block1: {\n            x: [0.3636, 0.4953],\n            y: [0.6493, 0.9144]\n        }\n    },\n    \"Bedroom B\": {\n        block1: {\n            x: [0.8275, 0.9662],\n            y: [0.2696, 0.7100]\n        }\n    },\n    \"meeting room\": {\n        block1: {\n            x: [0.6061, 0.8228],\n            y: [0.5055, 0.7122]\n        }\n    },\n    \"entry A\": {\n        block1: {\n            x: [0.0315, 0.1200],\n            y: [0.2651, 0.4943]\n        }\n    },\n    \"entry B\": {\n        block1: {\n            x: [0.6651, 0.9680],\n            y: [0.7190, 0.9212]\n        }\n    },\n    \"aisle A\":{\n        block1: {\n            x: [0.1224, 0.5023],\n            y: [0.2651, 0.4988]\n        }\n    },\n    \"intersection\":{\n        block1: {\n            x: [0.5023, 0.6100],\n            y: [0.2651, 0.4988]\n        }\n    },\n    \"aisle B\":{\n        block1: {\n            x: [0.6100, 0.8223],\n            y: [0.2651, 0.4988]\n        }\n    },\n    \"aisle C\":{\n        block1: {\n            x: [0.5023, 0.6100],\n            y: [0.4988, 0.7155]\n        },\n        block2: {\n            x: [0.5023, 0.6632],\n            y: [0.7155, 0.9198]\n        }\n    },\n    \"study room\":{\n        block1: {\n            x: [0.2844, 0.5023],\n            y: [0.5078, 0.6516]\n        }\n    },\n\n}\nfunction findPlace(payload){\n    const target = payload;\n    const point = {\n        x: parseFloat(target.coordX),\n        y: parseFloat(target.coordY),\n    }\n    for (const [key, place] of Object.entries(boundary)){\n        for (const [_, block] of Object.entries(place)){\n            let inX = point.x > block.x[0] && point.x < block.x[1];\n            let inY=point.y> block.y[0] && point.y < block.y[1];\n            if(inX&&inY){ \n                return key;\n            }\n        }\n    }\n    return \"None\" ; \n}\n(function($scope){\n    $('#redirectButt').on('click',function(e){\n        $scope.send({\"payload\":  e.target.innerHTML})\n    })\n    for(const [key, place] of Object.entries(areas)){\n        $(`#dot_${key}`).on('dblclick',function(e){\n            $scope.send({\"payload\": place})\n        });\n        $(`#arrow_${key}`).on('dblclick',function(e){\n            $scope.send({\"payload\": place})\n        });\n    }\n\n})(scope);\n\n/* pin location (touch screen)*/\nfunction pinLocationMobile(e){\n    e.preventDefault();\n    const map = document.getElementById(\"imgmap\");\n    let rect = map.getBoundingClientRect();\n    let xCoordinate = ((e.touches[0].clientX - rect.left)/ (rect.right- rect.left)).toFixed(4);\n    let yCoordinate = ((e.touches[0].clientY - rect.top)/(rect.bottom - rect.top)).toFixed(4);\n    if (xCoordinate < 1 && xCoordinate > 0 && yCoordinate < 1 && yCoordinate > 0){\n        $(\"#coords\").text( \"X: \" + xCoordinate + \", Y: \" + yCoordinate);\n        $(\"#imgcursor\").css( \"left\", (e.touches[0].clientX - rect.left) - 20 ); // offset to half of the cursor's width\n        $(\"#imgcursor\").css( \"top\", (e.touches[0].clientY - rect.top) - 20 );  // offset to half of the cursor's height\n        \n        payload = findPlace({\"coordX\": xCoordinate, \"coordY\": yCoordinate})\n        \n        const place=payload;\n        const butt = document.getElementById(\"redirectButt\");\n        if(place!==\"None\"){\n            butt.innerHTML = place;\n            butt.style.opacity = 1;\n        }else{\n            butt.style.opacity = 0;\n        }\n        \n    }\n}\n/* pin location*/\nfunction pinLocation(e){\n    e.preventDefault();\n    const map = document.getElementById(\"imgmap\");\n    let rect = map.getBoundingClientRect();\n    let xCoordinate = ((e.clientX - rect.left)/ (rect.right- rect.left)).toFixed(4);\n    let yCoordinate = ((e.clientY - rect.top)/(rect.bottom - rect.top)).toFixed(4);\n    if (xCoordinate < 1 && xCoordinate> 0 && yCoordinate < 1 && yCoordinate> 0 && e.buttons == 1){\n        $(\"#coords\").text( \"X: \" + xCoordinate + \", Y: \" + yCoordinate);\n        $(\"#pixels\").text( \"X: \" + (e.clientX - rect.left) + \", Y: \" + (e.clientY - rect.top));\n        $(\"#imgcursor\").css( \"left\", (e.clientX - rect.left) - 20); // offset to half of the cursor's width\n        $(\"#imgcursor\").css( \"top\", (e.clientY - rect.top) - 20 ); // offset to half of the cursor's height\n\n        //$scope.send({\"payload\":{\"coordX\": xCoordinate, \"coordY\": yCoordinate}});\n        payload = findPlace({\"coordX\": xCoordinate, \"coordY\": yCoordinate})\n\n        const place=payload;\n        const butt = document.getElementById(\"redirectButt\");\n        if(place!==\"None\"){\n            butt.innerHTML = place;\n            butt.style.opacity = 1;\n        }else{\n            butt.style.opacity = 0;\n        }\n    }\n}\n\n(function($scope) {\n    $('#imgmap').on('touchstart touchmove',pinLocationMobile);\n    $('#imgmap').on('mousemove mousedown mouseup',pinLocation);\n\n    for(const [key, place] of Object.entries(areas)){\n        $(`#dot_${key}`).on('touchstart touchmove',pinLocationMobile);\n        $(`#dot_${key}`).on('mousemove click',pinLocation);\n\n        $(`#arrow_${key}`).on('touchstart touchmove',pinLocationMobile);\n        $(`#arrow_${key}`).on('mousemove click',pinLocation);\n    }\n\n    $('#imgcursor').on('touchstart touchmove',pinLocationMobile);\n    $('#imgcursor').on('mousemove mousedown mouseup',pinLocation);\n})(scope);\n\n(function($scope){\n    $scope.$watch('msg', function(){\n        const place = $scope.msg.payload.place;\n        const color = $scope.msg.payload.color;\n        $(`#dot_${place}`).css(\"background-color\",color);\n        if(color==\"red\"){\n            $(`#arrow_${place}`).css(\"opacity\",1);\n        }\n    })\n    $scope.$watch('msg', function(){\n        if ($scope.msg.topic!==\"state\")return;\n        const paths = $scope.msg.payload;\n        for(const [key, degree] of Object.entries(paths)){\n            $(`#arrow_${key}`).css(\"transform\", `rotate(${degree}deg)`);\n            if($scope.msg.path === \"NORMAL\"){\n                $(`#arrow_${key}`).css(\"opacity\",0);\n            }else {\n                $(`#arrow_${key}`).css(\"opacity\",1);\n            }\n        }\n    })\n})(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 480,
        "y": 240,
        "wires": [["6cd299df2cf118bd"]]
    },
    {
        "id": "6cd299df2cf118bd",
        "type": "ui_ui_control",
        "z": "9357338e01a30d92",
        "name": "",
        "events": "all",
        "x": 720,
        "y": 240,
        "wires": [[]]
    },
    {
        "id": "dd5f965e.fb70b8",
        "type": "ui_template",
        "z": "9357338e01a30d92",
        "group": "81b1bdc3.9a60b8",
        "name": "CSS-Basics",
        "order": 2,
        "width": 0,
        "height": 0,
        "format": "<style>\n/*\n* {\n    background: none !important;\n}*/\n\n    root, a, button, p, div {\n        -webkit-user-select: none !important;\n    }\n    p font{\n        display: flex;\n        text-align:center;\n    }\n    .nr-dashboard-template p{\n        background: none !important;\n    }\n    body {\n        /*background-image: url(\"http://192.168.178.1:1880/ui/2023.jpg\");*/\n        /*background: linear-gradient(120deg, rgba(40, 42, 49, 1.0) 40%, rgba(47, 49, 56, 1.0) 80%) !important;*/\n        /*background-size: cover !important;*/\n        background: transparent !important;\n\n        background: -webkit-linear-gradient(\n            55deg,\n            #009785 0%,\n            #245aa5 100%\n        ) !important;\n        \n        -webkit-touch-callout: none !important;\n        color: #ffffff !important;\n        padding-top:5px !important;\n    }\n    \n    body.nr-dashboard-theme md-toolbar,\n    body.nr-dashboard-theme md-content md-card {\n\n    }\n\n    \n    ui-card-panel {\n        background-color: rgba(250,250,250,0.3) !important;\n        border:none !important;\n        border-radius: 10px !important;\n/*        box-shadow: 0 3px 6px 0 rgba(0, 0, 0, 0.2), 0 4px 8px 0 rgba(0, 0, 0, 0.19) !important;\n*/    }\n\n    ui-card-panel>div.nr-dashboard-cardpanel>div>md-card {\n        background: none !important;\n    }\n    ui-card-panel>div.nr-dashboard-cardpanel button {\n        /*background: none !important;*/\n    } \n    md-toolbar {\n        background: none !important;\n    }\n    md-sidenav {\n        background: linear-gradient(120deg, rgba(40, 42, 49, 0.90) 20%, rgba(47, 49, 56, 0.90) 80%) !important;\n    }\n    md-card.nr-dashboard-button * {\n        box-shadow: none !important;\n    }\n    /*md-card.nr-dashboard-template * {\n        background: none !important;\n    }*/\n    \n</style>\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "global",
        "className": "",
        "x": 110,
        "y": 100,
        "wires": [[]]
    },
    {
        "id": "2071531519d8ab32",
        "type": "ui_template",
        "z": "9357338e01a30d92",
        "group": "81b1bdc3.9a60b8",
        "name": "mybutt css",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<style>\n    .mybutt{\n        color: white;\n        background: border-box !important;\n        background-color: #0047AB !important;\n        border-radius: 10px;\n        display:flex;\n        align-content: center;\n        justify-content: center;\n    }\n\n    .mybutt:hover {\n        color: black;\n        background-color: #89CFF0 !important;\n    }\n    .mydot{\n        background-color:black;\n        border-radius:5px;\n        height:10px;\n        width:10px;\n        border: 1px solid black;\n    }\n    .myArrow {\n        position: absolute;\n        top: -7px;\n        left: -7px;\n        height: 25px;\n        width: 25px;\n        transform: rotate(135deg);\n        animation: blinker 1s linear infinite;\n    }\n    .myArrow:hover {\n        animation: none;\n    }\n    @keyframes blinker {\n        50% {\n            opacity: 0;\n        }\n    }\n</style>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "global",
        "className": "",
        "x": 110,
        "y": 60,
        "wires": [[]]
    },
    {
        "id": "c97ad871543274fa",
        "type": "link in",
        "z": "9357338e01a30d92",
        "name": "floor plan display",
        "links": [
            "07039cea834378fa",
            "28f138029255fbe1",
            "33a0094d6ccb0164",
            "e862d0dadea0ac5b"
        ],
        "x": 35,
        "y": 240,
        "wires": [["f26a59b.bdf94a8", "d2a426bc1f8a90ed"]]
    },
    {
        "id": "b2772c54688b0846",
        "type": "finite-state-machine",
        "z": "9357338e01a30d92",
        "name": "paths type",
        "fsmDefinition": "{\"state\":{\"status\":\"NORMAL\"},\"transitions\":{\"NORMAL\":{\"normal\":\"NORMAL\",\"bedroom\":\"PATH_A\",\"kitchen\":\"PATH_B\",\"BedroomC\":\"PATH_C\",\"meetingroom\":\"PATH_D\",\"BedroomB\":\"PATH_E\",\"entryA\":\"PATH_A\",\"entryB\":\"PATH_D\",\"aisleA\":\"PATH_A\",\"aisleB\":\"PATH_A\",\"aisleC\":\"PATH_A\",\"intersection\":\"PATH_A\",\"studyroom\":\"PATH_A\",\"reset\":\"NORMAL\"},\"PATH_A\":{\"normal\":\"PATH_A\",\"bedroom\":\"PATH_A\",\"kitchen\":\"PATH_A\",\"BedroomC\":\"PATH_A\",\"meetingroom\":\"PATH_A\",\"BedroomB\":\"PATH_A\",\"entryA\":\"PATH_A\",\"entryB\":\"PATH_D\",\"aisleA\":\"PATH_A\",\"aisleB\":\"PATH_A\",\"aisleC\":\"PATH_A\",\"intersection\":\"PATH_A\",\"studyroom\":\"PATH_A\",\"reset\":\"NORMAL\"},\"PATH_B\":{\"normal\":\"PATH_B\",\"bedroom\":\"PATH_B\",\"kitchen\":\"PATH_B\",\"BedroomC\":\"PATH_B\",\"meetingroom\":\"PATH_B\",\"BedroomB\":\"PATH_B\",\"entryA\":\"PATH_A\",\"entryB\":\"PATH_D\",\"aisleA\":\"PATH_A\",\"aisleB\":\"PATH_A\",\"aisleC\":\"PATH_A\",\"intersection\":\"PATH_A\",\"studyroom\":\"PATH_A\",\"reset\":\"NORMAL\"},\"PATH_C\":{\"normal\":\"PATH_C\",\"bedroom\":\"PATH_C\",\"kitchen\":\"PATH_C\",\"BedroomC\":\"PATH_C\",\"meetingroom\":\"PATH_C\",\"BedroomB\":\"PATH_C\",\"entryA\":\"PATH_A\",\"entryB\":\"PATH_D\",\"aisleA\":\"PATH_A\",\"aisleB\":\"PATH_A\",\"aisleC\":\"PATH_A\",\"intersection\":\"PATH_A\",\"studyroom\":\"PATH_A\",\"reset\":\"NORMAL\"},\"PATH_D\":{\"normal\":\"PATH_D\",\"bedroom\":\"PATH_D\",\"kitchen\":\"PATH_D\",\"BedroomC\":\"PATH_D\",\"meetingroom\":\"PATH_D\",\"BedroomB\":\"PATH_D\",\"entryA\":\"PATH_A\",\"entryB\":\"PATH_D\",\"aisleA\":\"PATH_A\",\"aisleB\":\"PATH_A\",\"aisleC\":\"PATH_A\",\"intersection\":\"PATH_A\",\"studyroom\":\"PATH_A\",\"reset\":\"NORMAL\"},\"PATH_E\":{\"normal\":\"PATH_E\",\"bedroom\":\"PATH_E\",\"kitchen\":\"PATH_E\",\"BedroomC\":\"PATH_E\",\"meetingroom\":\"PATH_E\",\"BedroomB\":\"PATH_E\",\"entryA\":\"PATH_A\",\"entryB\":\"PATH_D\",\"aisleA\":\"PATH_A\",\"aisleB\":\"PATH_A\",\"aisleC\":\"PATH_A\",\"intersection\":\"PATH_A\",\"studyroom\":\"PATH_A\",\"reset\":\"NORMAL\"}}}",
        "sendInitialState": true,
        "sendStateWithoutChange": true,
        "showTransitionErrors": false,
        "x": 370,
        "y": 520,
        "wires": [["29d9c877afb8317f"]]
    },
    {
        "id": "5d9f4fb4dc1b462f",
        "type": "function",
        "z": "9357338e01a30d92",
        "name": "where is on fire",
        "func": "const { place, color } = msg.payload;\nmsg.topic = \"normal\"\nmsg.data = { place, color }\nmsg.control = {}\nif (color === \"red\") msg.topic = place;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 180,
        "y": 520,
        "wires": [["b2772c54688b0846"]]
    },
    {
        "id": "29d9c877afb8317f",
        "type": "function",
        "z": "9357338e01a30d92",
        "name": "assign path",
        "func": "const PATH = {\n    \"PATH_A\":{\n        \"bedroom\": 90,\n        \"kitchen\": 315,\n        \"BedroomC\": 215,\n        \"BedroomB\": 30,\n        \"meetingroom\": 235,\n        \"entryA\": 0,\n        \"entryB\": 180,\n        \"aisleA\": 0,\n        \"aisleB\": 0,\n        \"aisleC\": 180,\n        \"intersection\": 0,\n        \"studyroom\": 90\n    },\n    \"PATH_B\": {\n        \"bedroom\": 90,\n        \"kitchen\": 315,\n        \"BedroomC\": 215,\n        \"BedroomB\": 30,\n        \"entryA\": 0,\n        \"entryB\": 180,\n        \"aisleA\": 0,\n        \"aisleB\": 0,\n        \"aisleC\": 180,\n        \"intersection\": 0,\n        \"studyroom\": 90,\n        \"meetingroom\": 235\n    },\n    \"PATH_C\": {\n        \"bedroom\": 90,\n        \"kitchen\": 215,\n        \"BedroomC\": 215,\n        \"BedroomB\": 30,\n        \"entryA\": 0,\n        \"entryB\": 180,\n        \"aisleA\": 0,\n        \"aisleB\": 0,\n        \"aisleC\": 180,\n        \"intersection\": 0,\n        \"studyroom\": 90,\n        \"meetingroom\": 235\n    },\n    \"PATH_D\": {\n        \"bedroom\": 90,\n        \"kitchen\": 315,\n        \"BedroomC\": 215,\n        \"BedroomB\": 30,\n        \"entryA\": 0,\n        \"entryB\": 180,\n        \"aisleA\": 0,\n        \"aisleB\": 0,\n        \"aisleC\": 180,\n        \"intersection\": 0,\n        \"studyroom\": 90,\n        \"meetingroom\": 235\n    },\n    \"PATH_E\": {\n        \"bedroom\": 90,\n        \"kitchen\": 315,\n        \"BedroomC\": 215,\n        \"BedroomB\": 30,\n        \"entryA\": 0,\n        \"entryB\": 180,\n        \"aisleA\": 0,\n        \"aisleB\": 0,\n        \"aisleC\": 180,\n        \"intersection\": 0,\n        \"studyroom\": 90,\n        \"meetingroom\": 235\n    },\n    \"default\":{\n        \"bedroom\": 90,\n        \"kitchen\": 315,\n        \"BedroomC\": 215,\n        \"BedroomB\": 30,\n        \"entryA\": 0,\n        \"entryB\": 180,\n        \"aisleA\": 0,\n        \"aisleB\": 0,\n        \"aisleC\": 180,\n        \"intersection\": 0,\n        \"studyroom\": 90,\n        \"meetingroom\": 235\n    }\n}\nconst type = msg.payload.status;\nif (PATH[type] === undefined) msg.payload = PATH[\"default\"];\nelse msg.payload = PATH[type];\nmsg.path = type;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 530,
        "y": 520,
        "wires": [["ec55de35b196061c", "3e029767408763f5", "2d256c10ef39cfd2"]]
    },
    {
        "id": "ec55de35b196061c",
        "type": "debug",
        "z": "9357338e01a30d92",
        "name": "debug 15",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 700,
        "y": 460,
        "wires": []
    },
    {
        "id": "c5274b54a9775451",
        "type": "inject",
        "z": "9357338e01a30d92",
        "name": "reset",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "reset",
        "payload": "",
        "payloadType": "date",
        "x": 110,
        "y": 440,
        "wires": [["b2772c54688b0846", "1765ee585273167c"]]
    },
    {
        "id": "1765ee585273167c",
        "type": "link out",
        "z": "9357338e01a30d92",
        "name": "reset",
        "mode": "link",
        "links": [
            "09bf2fe2757421fd",
            "11b7216be9bf733f",
            "69c5693719c5afac",
            "78b13c4581252f09",
            "838f2d8bc711e907",
            "83c896b0d0c3cfbd",
            "d6ac4f62ad49c8d6",
            "ef3bdeb37b590597"
        ],
        "x": 255,
        "y": 440,
        "wires": []
    },
    {
        "id": "3429b3a17b44be7e",
        "type": "mqtt out",
        "z": "9357338e01a30d92",
        "name": "notify status(bedroom)",
        "topic": "",
        "qos": "2",
        "retain": "true",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "4f6c8a65bb8820c6",
        "x": 580,
        "y": 320,
        "wires": []
    },
    {
        "id": "212aac259bb57f62",
        "type": "ui_ui_control",
        "z": "9357338e01a30d92",
        "name": "",
        "events": "all",
        "x": 120,
        "y": 600,
        "wires": [["7272c25c0dba8471", "6504c18af04fae4b"]]
    },
    {
        "id": "7272c25c0dba8471",
        "type": "debug",
        "z": "9357338e01a30d92",
        "name": "debug 18",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 540,
        "y": 600,
        "wires": []
    },
    {
        "id": "6504c18af04fae4b",
        "type": "function",
        "z": "9357338e01a30d92",
        "name": "trigger when chage page",
        "func": "msg.topic = \"normal\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 330,
        "y": 600,
        "wires": [["b2772c54688b0846"]]
    },
    {
        "id": "478292a4ebaca8d2",
        "type": "link in",
        "z": "9357338e01a30d92",
        "name": "floor plan display",
        "links": [
            "07039cea834378fa",
            "28f138029255fbe1",
            "33a0094d6ccb0164",
            "e862d0dadea0ac5b"
        ],
        "x": 55,
        "y": 520,
        "wires": [["5d9f4fb4dc1b462f"]]
    },
    {
        "id": "3e029767408763f5",
        "type": "link out",
        "z": "9357338e01a30d92",
        "name": "path out",
        "mode": "link",
        "links": ["0ac0f5ca67ba0465"],
        "x": 775,
        "y": 520,
        "wires": []
    },
    {
        "id": "0ac0f5ca67ba0465",
        "type": "link in",
        "z": "9357338e01a30d92",
        "name": "path",
        "links": ["3e029767408763f5"],
        "x": 195,
        "y": 280,
        "wires": [["f26a59b.bdf94a8"]]
    },
    {
        "id": "5d0d05e9a2a6b7a3",
        "type": "rbe",
        "z": "9357338e01a30d92",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": true,
        "property": "payload",
        "topi": "topic",
        "x": 390,
        "y": 320,
        "wires": [["3429b3a17b44be7e", "b68872ad3596be03"]]
    },
    {
        "id": "d2a426bc1f8a90ed",
        "type": "function",
        "z": "9357338e01a30d92",
        "name": "change topic",
        "func": "msg.topic = `/${msg.payload.place}/status`;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 230,
        "y": 320,
        "wires": [["5d0d05e9a2a6b7a3"]]
    },
    {
        "id": "2d256c10ef39cfd2",
        "type": "mqtt out",
        "z": "9357338e01a30d92",
        "name": "notify path",
        "topic": "path",
        "qos": "2",
        "retain": "true",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "4f6c8a65bb8820c6",
        "x": 710,
        "y": 580,
        "wires": []
    },
    {
        "id": "b68872ad3596be03",
        "type": "debug",
        "z": "9357338e01a30d92",
        "name": "debug 19",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 540,
        "y": 400,
        "wires": []
    },
    {
        "id": "7e65aef77ae45059",
        "type": "comment",
        "z": "9357338e01a30d92",
        "name": "新增Node看這",
        "info": "請複製Bedroom C的flow\n改所有place、group\n在主頁加點\n重新圈範圍\n增加path",
        "x": 490,
        "y": 200,
        "wires": []
    },
    {
        "id": "447eebd161c2214a",
        "type": "function",
        "z": "9357338e01a30d92",
        "name": "dot ",
        "func": "msg.payload = {\n    \"smoke_detector\":[\n        {\n            place:\"bedroom\",\n            top: 263,\n            left: 169,\n            status: \"Normal\"\n        }, \n        {\n            place: \"kitchen\",\n            top: 60,\n            left: 610,\n            status: \"Normal\"\n        },\n        {\n            place: \"BedroomC\",\n            top: 344,\n            left: 365,\n            status: \"Normal\"\n        }\n    ]\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 290,
        "y": 160,
        "wires": [[]]
    },
    {
        "id": "a433e237cd1c112c",
        "type": "http in",
        "z": "4f79fdad1c282705",
        "name": "",
        "url": "/hello-world",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 180,
        "y": 140,
        "wires": [["418d78b6169be4ac"]]
    },
    {
        "id": "418d78b6169be4ac",
        "type": "template",
        "z": "4f79fdad1c282705",
        "name": "hello world page",
        "field": "payload",
        "fieldType": "msg",
        "format": "html",
        "syntax": "plain",
        "template": "<!DOCTYPE html>\n<html>\n<head>\n\t<title>Hello</title>\n\n\t<h1>Hello World</h1>\n</head>\n<body>\n\n<p> This is a demo on how to create webpages and dashboards </p>\n</body>\n</html>",
        "output": "str",
        "x": 420,
        "y": 140,
        "wires": [["9c61cddd2cb9d6d9"]]
    },
    {
        "id": "9c61cddd2cb9d6d9",
        "type": "http response",
        "z": "4f79fdad1c282705",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 630,
        "y": 140,
        "wires": []
    },
    {
        "id": "6eae080fe2ef7b04",
        "type": "function",
        "z": "e8560f358cae048b",
        "name": "add node information",
        "func": "msg.payload.place = \"bedroom\";\nmsg.payload.time = Date.now();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1120,
        "y": 200,
        "wires": [["a79ccc4d0952d01c", "7d4bc13172f71ca5"]]
    },
    {
        "id": "6ce83436cef07a13",
        "type": "random",
        "z": "e8560f358cae048b",
        "name": "偵煙器",
        "low": "0",
        "high": "1",
        "inte": "true",
        "property": "payload",
        "x": 250,
        "y": 160,
        "wires": [["460bac982611fbe0"]]
    },
    {
        "id": "7a8faf3792d53b4e",
        "type": "random",
        "z": "e8560f358cae048b",
        "name": "CO(ppm)",
        "low": "0",
        "high": 10,
        "inte": "false",
        "property": "payload",
        "x": 260,
        "y": 200,
        "wires": [["efbc055c842936f4"]]
    },
    {
        "id": "7e33b60b7a665815",
        "type": "random",
        "z": "e8560f358cae048b",
        "name": "溫度",
        "low": "-10",
        "high": "50",
        "inte": "false",
        "property": "payload",
        "x": 250,
        "y": 240,
        "wires": [["14bfebf6f842cd86"]]
    },
    {
        "id": "c1a7927f9c2e08b2",
        "type": "join",
        "z": "e8560f358cae048b",
        "name": "",
        "mode": "custom",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "1",
        "count": "3",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 570,
        "y": 200,
        "wires": [["6eae080fe2ef7b04"]]
    },
    {
        "id": "ea9045affbb97a51",
        "type": "debug",
        "z": "e8560f358cae048b",
        "name": "combine",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 740,
        "y": 100,
        "wires": []
    },
    {
        "id": "460bac982611fbe0",
        "type": "change",
        "z": "e8560f358cae048b",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "smoke",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 400,
        "y": 160,
        "wires": [["c1a7927f9c2e08b2"]]
    },
    {
        "id": "efbc055c842936f4",
        "type": "change",
        "z": "e8560f358cae048b",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "CO",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 400,
        "y": 200,
        "wires": [["c1a7927f9c2e08b2"]]
    },
    {
        "id": "14bfebf6f842cd86",
        "type": "change",
        "z": "e8560f358cae048b",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperture",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 400,
        "y": 240,
        "wires": [["c1a7927f9c2e08b2"]]
    },
    {
        "id": "379dbde4a2782226",
        "type": "inject",
        "z": "e8560f358cae048b",
        "d": true,
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 90,
        "y": 200,
        "wires": [["6ce83436cef07a13", "7a8faf3792d53b4e", "7e33b60b7a665815"]]
    },
    {
        "id": "a79ccc4d0952d01c",
        "type": "link out",
        "z": "e8560f358cae048b",
        "name": "link out 1",
        "mode": "link",
        "links": [
            "0d4b89c521373893",
            "5464f337da3258e4",
            "be18d055f36a6adf",
            "c5d9f970a3cd4527",
            "4d05e4c4fe4433a0"
        ],
        "x": 1315,
        "y": 220,
        "wires": []
    },
    {
        "id": "be18d055f36a6adf",
        "type": "link in",
        "z": "e8560f358cae048b",
        "name": "link in 1",
        "links": ["a79ccc4d0952d01c"],
        "x": 265,
        "y": 460,
        "wires": [["c16f0753630f1a4d"]]
    },
    {
        "id": "c16f0753630f1a4d",
        "type": "function",
        "z": "e8560f358cae048b",
        "name": "function 2",
        "func": "if(msg.payload.smoke===0){\n    msg.payload.color =\"#008000\"; //\"green\";\n}else{\n    msg.payload.color = \"#b22222\"; // \"firebrick\";\n}\nmsg.topic = \"e1@cx_color\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 370,
        "y": 460,
        "wires": [["e0cfad155310c236"]]
    },
    {
        "id": "ede363f70475f87f",
        "type": "debug",
        "z": "e8560f358cae048b",
        "name": "debug 9",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 660,
        "y": 460,
        "wires": []
    },
    {
        "id": "c5d9f970a3cd4527",
        "type": "link in",
        "z": "e8560f358cae048b",
        "name": "link in 2",
        "links": ["a79ccc4d0952d01c"],
        "x": 265,
        "y": 520,
        "wires": [["f07a896dabaaa12d"]]
    },
    {
        "id": "f07a896dabaaa12d",
        "type": "function",
        "z": "e8560f358cae048b",
        "name": "溫度",
        "func": "msg.payload = msg.payload.temperture;\nmsg.topic = \"temperture\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 520,
        "wires": [["677c5a163af1e20e"]]
    },
    {
        "id": "4be9ebd6f293c3e4",
        "type": "debug",
        "z": "e8560f358cae048b",
        "name": "debug 10",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 650,
        "y": 520,
        "wires": []
    },
    {
        "id": "677c5a163af1e20e",
        "type": "ui_chart",
        "z": "e8560f358cae048b",
        "name": "",
        "group": "70cfa938d1a6f3e9",
        "order": 4,
        "width": 11,
        "height": 5,
        "label": "溫度",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "-10",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 500,
        "y": 520,
        "wires": [["4be9ebd6f293c3e4"]]
    },
    {
        "id": "5464f337da3258e4",
        "type": "link in",
        "z": "e8560f358cae048b",
        "name": "link in 3",
        "links": ["a79ccc4d0952d01c"],
        "x": 265,
        "y": 580,
        "wires": [["e02d327b0b4301f1"]]
    },
    {
        "id": "e02d327b0b4301f1",
        "type": "function",
        "z": "e8560f358cae048b",
        "name": "CO",
        "func": "msg.payload = msg.payload.CO;\nmsg.topic = \"CO\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 580,
        "wires": [["e512ca87739ddc01"]]
    },
    {
        "id": "b5131ef7b5556fad",
        "type": "debug",
        "z": "e8560f358cae048b",
        "name": "debug 11",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 650,
        "y": 580,
        "wires": []
    },
    {
        "id": "e512ca87739ddc01",
        "type": "ui_chart",
        "z": "e8560f358cae048b",
        "name": "",
        "group": "70cfa938d1a6f3e9",
        "order": 7,
        "width": 14,
        "height": 4,
        "label": "CO(ppm)",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 510,
        "y": 580,
        "wires": [["b5131ef7b5556fad"]]
    },
    {
        "id": "9bcba2472efd6980",
        "type": "ui_text",
        "z": "e8560f358cae048b",
        "group": "70cfa938d1a6f3e9",
        "order": 5,
        "width": 3,
        "height": 2,
        "name": "",
        "label": "status",
        "format": "<font face='arial'><font size=6><font color={{msg.payload.color}}>{{msg.payload.message}}",
        "layout": "col-center",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 690,
        "y": 740,
        "wires": []
    },
    {
        "id": "0d4b89c521373893",
        "type": "link in",
        "z": "e8560f358cae048b",
        "name": "link in 4",
        "links": ["a79ccc4d0952d01c"],
        "x": 265,
        "y": 640,
        "wires": [["2b1ca02fdde12125"]]
    },
    {
        "id": "85414c586a5d57c9",
        "type": "mqtt in",
        "z": "e8560f358cae048b",
        "name": "",
        "topic": "/bedroom/condition",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "4f6c8a65bb8820c6",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 550,
        "y": 100,
        "wires": [["ea9045affbb97a51", "c1dce7859b159e57"]]
    },
    {
        "id": "c1dce7859b159e57",
        "type": "function",
        "z": "e8560f358cae048b",
        "name": "convert data",
        "func": "let { ppm, temp, battery, smoke } = msg.payload;\n\nmsg.payload = { smoke: smoke ? smoke : 0, CO: ppm ? ppm : 0, temperture: temp ? temp : 20, battery: battery ? battery: 0 };\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 750,
        "y": 160,
        "wires": [["6eae080fe2ef7b04"]]
    },
    {
        "id": "33a0094d6ccb0164",
        "type": "link out",
        "z": "e8560f358cae048b",
        "name": "bedroom status",
        "mode": "link",
        "links": ["c97ad871543274fa", "478292a4ebaca8d2"],
        "x": 655,
        "y": 700,
        "wires": []
    },
    {
        "id": "814faab247c65d5c",
        "type": "finite-state-machine",
        "z": "e8560f358cae048b",
        "name": "",
        "fsmDefinition": "{\"state\":{\"status\":\"Normal\",\"data\":{\"x\":5}},\"transitions\":{\"Normal\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Normal\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Fire\":{\"temperture\":\"Fire\",\"CO\":\"Fire\",\"smoke\":\"Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Fire\",\"expire\":\"Fire\",\"reset\":\"Normal\"},\"CO too High\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"CO too High\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Smoke Detected\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Smoke Detected\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Potential Fire\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Potential Fire\",\"expire\":\"Normal\",\"reset\":\"Normal\"}}}",
        "sendInitialState": true,
        "sendStateWithoutChange": true,
        "showTransitionErrors": true,
        "x": 310,
        "y": 740,
        "wires": [["9c656d3cd2d9fa07", "2c598d101a865fca"]]
    },
    {
        "id": "2b1ca02fdde12125",
        "type": "function",
        "z": "e8560f358cae048b",
        "name": "check transition to FSM",
        "func": "const TEMP_ERROR_LIMIT = 40; // in C\nconst CO_ERROR_LIMIT = 20; // in ppm\n\nconst { smoke, temperture, CO } = msg.payload;\nmsg.topic = \"\"\nmsg.data = {smoke, temperture, CO}\nmsg.control = {}\n\nif (temperture >= TEMP_ERROR_LIMIT) {\n    msg.topic += \"temperture\";\n}\nif (CO >= CO_ERROR_LIMIT) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"CO\";\n}\nif (smoke === 1) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"smoke\";\n} \nif (msg.topic===\"\"){\n    msg.topic = \"normal\";\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 430,
        "y": 640,
        "wires": [["814faab247c65d5c", "6994c0a484d14649"]]
    },
    {
        "id": "e4f7d576a1ed45ac",
        "type": "debug",
        "z": "e8560f358cae048b",
        "name": "state",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 690,
        "y": 780,
        "wires": []
    },
    {
        "id": "6994c0a484d14649",
        "type": "debug",
        "z": "e8560f358cae048b",
        "name": "trasition",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 740,
        "y": 640,
        "wires": []
    },
    {
        "id": "79a06b2fbe05deb9",
        "type": "inject",
        "z": "e8560f358cae048b",
        "name": "reset",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "reset",
        "payload": "",
        "payloadType": "date",
        "x": 90,
        "y": 740,
        "wires": [["814faab247c65d5c"]]
    },
    {
        "id": "9c656d3cd2d9fa07",
        "type": "function",
        "z": "e8560f358cae048b",
        "name": "function 3",
        "func": "msg.state_color = {\n    \"Normal\": \"green\",\n    \"Fire\": \"red\",\n    \"CO too High\": \"orange\",\n    \"Smoke Detected\": \"orange\",\n    \"Potential Fire\": \"orange\"\n}\nmsg.payload = {\n    place: \"bedroom\",\n    message: msg.payload.status,\n    color: msg.state_color[msg.payload.status]\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 740,
        "wires": [
            [
                "e4f7d576a1ed45ac",
                "9bcba2472efd6980",
                "33a0094d6ccb0164",
                "da2a2e1b1e44c512"
            ]
        ]
    },
    {
        "id": "2c598d101a865fca",
        "type": "debug",
        "z": "e8560f358cae048b",
        "name": "debug 14",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 500,
        "y": 780,
        "wires": []
    },
    {
        "id": "fa3db0c267a1be77",
        "type": "line-notify",
        "z": "e8560f358cae048b",
        "name": "test YCK",
        "message": "",
        "contentType": "message",
        "imageThumbnail": "",
        "imageUrl": "",
        "sticker": "default",
        "stickerPackageId": "1",
        "stickerId": "1",
        "silent": false,
        "creds": "63115de6b1972cd9",
        "x": 980,
        "y": 920,
        "wires": [[]]
    },
    {
        "id": "45071ec317cfdd3f",
        "type": "inject",
        "z": "e8560f358cae048b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 270,
        "y": 920,
        "wires": [["da2a2e1b1e44c512"]]
    },
    {
        "id": "da2a2e1b1e44c512",
        "type": "rbe",
        "z": "e8560f358cae048b",
        "name": "block the same value",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": true,
        "property": "payload",
        "topi": "topic",
        "x": 600,
        "y": 920,
        "wires": [["fef22398b5dcad8b"]]
    },
    {
        "id": "fef22398b5dcad8b",
        "type": "function",
        "z": "e8560f358cae048b",
        "name": "modify message",
        "func": "const place = \"bedroom\"\nif (msg.payload.message==\"Normal\"){\n    return;\n}\nmsg.payload = \"\\n注意！\\n\" + place + \": \" + msg.payload.message\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 920,
        "wires": [["fa3db0c267a1be77"]]
    },
    {
        "id": "a8d64e997c5ff5f3",
        "type": "ui_ui_control",
        "z": "e8560f358cae048b",
        "name": "navigation",
        "events": "all",
        "x": 530,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "72e7c35c7ccfb267",
        "type": "ui_template",
        "z": "e8560f358cae048b",
        "group": "70cfa938d1a6f3e9",
        "name": "Back Home",
        "order": 2,
        "width": 2,
        "height": 1,
        "format": "<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#e67e22\"\n    ng-click=\"send({payload: 'Home'})\">\n    Back\n</md-button>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 370,
        "y": 1020,
        "wires": [["a8d64e997c5ff5f3"]]
    },
    {
        "id": "c3b401dea499b9c4",
        "type": "ui_template",
        "z": "e8560f358cae048b",
        "group": "70cfa938d1a6f3e9",
        "name": "button css",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<style>\n  * {\n      overflow: hidden;\n  }\n  .filled { \n      height: 70% !important;\n      width: 90% !important;\n      padding: 0 !important;\n      margin: 4% !important;\n  }\n  .nr-dashboard-template {\n      padding: 0;\n      margin: 0;\n  }\n  \n  .rounded {\n  border-radius: 12px 12px 12px 12px;\n}\n \n   .bigfont {\n  font-size: 18px;\n}\n\n   .smallfont {\n  font-size: 12px;\n}\n  \n</style>\n\n<script>\n$('.vibrate').on('click', function() {\n  navigator.vibrate(100);\n});\n\nfunction restore_bg(x) {\n            $(this).css(\"background-color\", x);\n    };\n\n$('.touched').on('mousedown', function() {\n    \n    var x= $(this).css(\"background-color\");\n    $(this).css(\"background-color\", \"yellow\");\n    \n    setTimeout(restore_bg.bind(this,x),100);\n    navigator.vibrate(80);\n    });\n    \n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 190,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "eba6806704a813d2",
        "type": "inject",
        "z": "e8560f358cae048b",
        "name": "normal",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":8,\"temperture\":30}",
        "payloadType": "json",
        "x": 680,
        "y": 240,
        "wires": [["db9f653c7e7f3e57"]]
    },
    {
        "id": "b84ed3270cad8afd",
        "type": "inject",
        "z": "e8560f358cae048b",
        "name": "smoke",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":1,\"CO\":8,\"temperture\":30}",
        "payloadType": "json",
        "x": 670,
        "y": 280,
        "wires": [["db9f653c7e7f3e57"]]
    },
    {
        "id": "435fb2ef34033189",
        "type": "inject",
        "z": "e8560f358cae048b",
        "name": "CO",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":30}",
        "payloadType": "json",
        "x": 670,
        "y": 320,
        "wires": [["db9f653c7e7f3e57"]]
    },
    {
        "id": "8b7be441547873a2",
        "type": "inject",
        "z": "e8560f358cae048b",
        "name": "fire",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "1",
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":45}",
        "payloadType": "json",
        "x": 670,
        "y": 360,
        "wires": [["db9f653c7e7f3e57"]]
    },
    {
        "id": "db9f653c7e7f3e57",
        "type": "delay",
        "z": "e8560f358cae048b",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 830,
        "y": 300,
        "wires": [["11dfd4aab5d12f98", "6eae080fe2ef7b04"]]
    },
    {
        "id": "83c896b0d0c3cfbd",
        "type": "link in",
        "z": "e8560f358cae048b",
        "name": "all reset",
        "links": ["1765ee585273167c"],
        "x": 135,
        "y": 780,
        "wires": [["814faab247c65d5c"]]
    },
    {
        "id": "62cd0581a72e0e23",
        "type": "function",
        "z": "e8560f358cae048b",
        "name": "reset normal",
        "func": "msg.payload = { \"smoke\": 0, \"CO\": 8, \"temperture\": 30 }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 690,
        "y": 400,
        "wires": [["db9f653c7e7f3e57"]]
    },
    {
        "id": "78b13c4581252f09",
        "type": "link in",
        "z": "e8560f358cae048b",
        "name": "reset",
        "links": ["1765ee585273167c"],
        "x": 575,
        "y": 400,
        "wires": [["62cd0581a72e0e23"]]
    },
    {
        "id": "11dfd4aab5d12f98",
        "type": "debug",
        "z": "e8560f358cae048b",
        "name": "debug 16",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1000,
        "y": 300,
        "wires": []
    },
    {
        "id": "715a245219929f02",
        "type": "mysql",
        "z": "e8560f358cae048b",
        "d": true,
        "mydb": "79a66be2696ab45c",
        "name": "",
        "x": 1470,
        "y": 320,
        "wires": [[]]
    },
    {
        "id": "7d4bc13172f71ca5",
        "type": "function",
        "z": "e8560f358cae048b",
        "name": "insert data ",
        "func": "msg.topic = \"INSERT INTO sensorData (`Place`, `Time`, `Smoke`, `CO`, `Temperture`) VALUES (:place, :time, :smoke, :CO, :temperture);\"\nreturn msg;\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1310,
        "y": 320,
        "wires": [["715a245219929f02"]]
    },
    {
        "id": "d6f20b3ea775c1fb",
        "type": "mysql",
        "z": "e8560f358cae048b",
        "d": true,
        "mydb": "79a66be2696ab45c",
        "name": "",
        "x": 430,
        "y": 1140,
        "wires": [["9d8e5770e3e1dc0e"]]
    },
    {
        "id": "9d8e5770e3e1dc0e",
        "type": "debug",
        "z": "e8560f358cae048b",
        "name": "debug 17",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 580,
        "y": 1140,
        "wires": []
    },
    {
        "id": "fa9a9af0d613f067",
        "type": "function",
        "z": "e8560f358cae048b",
        "name": "get data",
        "func": "msg.payload = {\"place\":\"bedroom\"}\nmsg.topic = \"SELECT * from sensorData WHERE Place=:place;\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 280,
        "y": 1140,
        "wires": [["d6f20b3ea775c1fb"]]
    },
    {
        "id": "5862f7017b605bd3",
        "type": "inject",
        "z": "e8560f358cae048b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 110,
        "y": 1140,
        "wires": [["fa9a9af0d613f067"]]
    },
    {
        "id": "2a268dc88de4aea2",
        "type": "ui_ui_control",
        "z": "e8560f358cae048b",
        "name": "",
        "events": "all",
        "x": 100,
        "y": 840,
        "wires": [["4469255040f9a43a"]]
    },
    {
        "id": "4469255040f9a43a",
        "type": "function",
        "z": "e8560f358cae048b",
        "name": "trigger when chage page",
        "func": "msg.topic = \"normal\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 290,
        "y": 840,
        "wires": [["814faab247c65d5c"]]
    },
    {
        "id": "e0cfad155310c236",
        "type": "ui_template",
        "z": "e8560f358cae048b",
        "group": "70cfa938d1a6f3e9",
        "name": "煙霧顯示",
        "order": 6,
        "width": 3,
        "height": 2,
        "format": "<div id=\"graphics\" ng-init=\"checkSVG()\" style=\"display: flex; justify-content:center;align-items:center\">\n    <p id=\"e1_text\">煙霧</p>\n    <svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0\" y=\"0\" height=\"34\"\n        viewBox=\"0 0 34 34\" width=\"34\" preserveAspectRatio=\"xMidYMid meet\">\n        <circle id=\"e1_circle\" cx=\"17\" cy=\"17\" style=\"fill:green;stroke-width:0px;overflow:hidden\" r=\"16\" />\n    </svg>\n    <script>\n        (function($scope) {\n                $scope.$watch('msg', function() {\n                    if (!$scope.msg) return;\n                    const color=$scope.msg.payload?.color;\n                    const topic=$scope.msg.topic;\n                    if (color === undefined || color === null ||\n                        !topic || typeof topic !== 'string' || !topic.includes('@')) return;\n                    const id = topic.split('@')[0], cxType = topic.split('@')[1];\n                    document.getElementById(id+\"_circle\").style.fill=color;\n                    document.getElementById(id+\"_text\").style.cssText = `color:${color} !important;font-weight:bold` ;\n                });\n            })(scope);\n    </script>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 520,
        "y": 460,
        "wires": [["ede363f70475f87f"]]
    },
    {
        "id": "64de28c2aa919158",
        "type": "ui_template",
        "z": "e8560f358cae048b",
        "group": "70cfa938d1a6f3e9",
        "name": "power icon",
        "order": 3,
        "width": 1,
        "height": 1,
        "format": "<div style=\"display: flex; justify-content:center;align-items:center;height: auto; width: auto\">\n    <img id=\"battery\" style=\"height: auto; width: auto;display: none\" src=\"/half-battery.png\">\n    <img id=\"charging\" style=\"height: auto; width: auto;display: block\" src=\"/low-battery.png\">\n</div>\n\n<script>\n    (function($scope) {\n        $scope.$watch('msg', function() {\n            if (!$scope.msg) return;\n            const battery=$scope.msg.payload?.battery;\n            // console.log(battery);\n            if(battery){\n                $(\"#battery\").css(\"display\",battery?\"block\":\"none\");\n                $(\"#charging\").css(\"display\",battery?\"none\":\"block\");\n            }\n        });\n    })(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 370,
        "y": 1060,
        "wires": [[]]
    },
    {
        "id": "4d05e4c4fe4433a0",
        "type": "link in",
        "z": "e8560f358cae048b",
        "name": "link in 6",
        "links": ["a79ccc4d0952d01c"],
        "x": 255,
        "y": 1060,
        "wires": [["64de28c2aa919158"]]
    },
    {
        "id": "ed13d602716311d1",
        "type": "comment",
        "z": "e8560f358cae048b",
        "name": "請改place",
        "info": "請改place",
        "x": 1100,
        "y": 160,
        "wires": []
    },
    {
        "id": "ea8adbac62680e34",
        "type": "inject",
        "z": "e8560f358cae048b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 570,
        "y": 140,
        "wires": [["c1dce7859b159e57"]]
    },
    {
        "id": "2196831a363ec1c8",
        "type": "random",
        "z": "b435fa1f0cb3b040",
        "name": "偵煙器",
        "low": "0",
        "high": "1",
        "inte": "true",
        "property": "payload",
        "x": 230,
        "y": 40,
        "wires": [["efd3278d2391033b"]]
    },
    {
        "id": "a99524d3a40e85b5",
        "type": "random",
        "z": "b435fa1f0cb3b040",
        "name": "CO(ppm)",
        "low": "0",
        "high": 10,
        "inte": "false",
        "property": "payload",
        "x": 240,
        "y": 80,
        "wires": [["8f9972a466097655"]]
    },
    {
        "id": "4e8fd4275910de30",
        "type": "random",
        "z": "b435fa1f0cb3b040",
        "name": "溫度",
        "low": "-10",
        "high": "50",
        "inte": "false",
        "property": "payload",
        "x": 230,
        "y": 120,
        "wires": [["052e488707865802"]]
    },
    {
        "id": "4cd2cabdd4e51777",
        "type": "join",
        "z": "b435fa1f0cb3b040",
        "name": "",
        "mode": "custom",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "1",
        "count": "3",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 550,
        "y": 80,
        "wires": [["05dd899a97fe1d04"]]
    },
    {
        "id": "f4891b1c40fe8ace",
        "type": "debug",
        "z": "b435fa1f0cb3b040",
        "name": "combine",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 400,
        "y": 220,
        "wires": []
    },
    {
        "id": "efd3278d2391033b",
        "type": "change",
        "z": "b435fa1f0cb3b040",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "smoke",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 40,
        "wires": [["4cd2cabdd4e51777"]]
    },
    {
        "id": "8f9972a466097655",
        "type": "change",
        "z": "b435fa1f0cb3b040",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "CO",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 80,
        "wires": [["4cd2cabdd4e51777"]]
    },
    {
        "id": "052e488707865802",
        "type": "change",
        "z": "b435fa1f0cb3b040",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperture",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 120,
        "wires": [["4cd2cabdd4e51777"]]
    },
    {
        "id": "01399bad7fbcbc1e",
        "type": "inject",
        "z": "b435fa1f0cb3b040",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 70,
        "y": 80,
        "wires": [["2196831a363ec1c8", "a99524d3a40e85b5", "4e8fd4275910de30"]]
    },
    {
        "id": "b9d9c26a4f68fa1f",
        "type": "link out",
        "z": "b435fa1f0cb3b040",
        "name": "link out 1",
        "mode": "link",
        "links": [
            "2c8f21c60f60b45c",
            "fb3ec2a7b1adba23",
            "c91ef7a14081f76a",
            "365b2c5ef9ffe010",
            "ad87beb3edecc184"
        ],
        "x": 955,
        "y": 200,
        "wires": []
    },
    {
        "id": "2c8f21c60f60b45c",
        "type": "link in",
        "z": "b435fa1f0cb3b040",
        "name": "link in 1",
        "links": ["b9d9c26a4f68fa1f"],
        "x": 255,
        "y": 440,
        "wires": [["8bb8760fa5cc3c15"]]
    },
    {
        "id": "8bb8760fa5cc3c15",
        "type": "function",
        "z": "b435fa1f0cb3b040",
        "name": "function 2",
        "func": "if(msg.payload.smoke===0){\n    msg.payload.color =\"#008000\"; //\"green\";\n}else{\n    msg.payload.color = \"#b22222\"; // \"firebrick\";\n}\nmsg.topic = \"e1@cx_color\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 440,
        "wires": [["0362e403b7ac805c"]]
    },
    {
        "id": "0681c20b7ec2f13c",
        "type": "debug",
        "z": "b435fa1f0cb3b040",
        "name": "debug 9",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 440,
        "wires": []
    },
    {
        "id": "fb3ec2a7b1adba23",
        "type": "link in",
        "z": "b435fa1f0cb3b040",
        "name": "link in 2",
        "links": ["b9d9c26a4f68fa1f"],
        "x": 255,
        "y": 500,
        "wires": [["fcd3fb07ec23022a"]]
    },
    {
        "id": "fcd3fb07ec23022a",
        "type": "function",
        "z": "b435fa1f0cb3b040",
        "name": "溫度",
        "func": "msg.payload = msg.payload.temperture;\nmsg.topic = \"temperture\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 500,
        "wires": [["6f6a2f835e4303ce"]]
    },
    {
        "id": "388df52bad9fd02f",
        "type": "debug",
        "z": "b435fa1f0cb3b040",
        "name": "debug 10",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 500,
        "wires": []
    },
    {
        "id": "6f6a2f835e4303ce",
        "type": "ui_chart",
        "z": "b435fa1f0cb3b040",
        "name": "",
        "group": "b973fd68fe795a1c",
        "order": 4,
        "width": 11,
        "height": 5,
        "label": "溫度",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "-10",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 490,
        "y": 500,
        "wires": [["388df52bad9fd02f"]]
    },
    {
        "id": "c91ef7a14081f76a",
        "type": "link in",
        "z": "b435fa1f0cb3b040",
        "name": "link in 3",
        "links": ["b9d9c26a4f68fa1f"],
        "x": 255,
        "y": 560,
        "wires": [["e4c84f2551ce553a"]]
    },
    {
        "id": "e4c84f2551ce553a",
        "type": "function",
        "z": "b435fa1f0cb3b040",
        "name": "CO",
        "func": "msg.payload = msg.payload.CO;\nmsg.topic = \"CO\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 560,
        "wires": [["d0941d106b652e26"]]
    },
    {
        "id": "824a622f2545e076",
        "type": "debug",
        "z": "b435fa1f0cb3b040",
        "name": "debug 11",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 560,
        "wires": []
    },
    {
        "id": "d0941d106b652e26",
        "type": "ui_chart",
        "z": "b435fa1f0cb3b040",
        "name": "",
        "group": "b973fd68fe795a1c",
        "order": 7,
        "width": 14,
        "height": 4,
        "label": "CO(ppm)",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 500,
        "y": 560,
        "wires": [["824a622f2545e076"]]
    },
    {
        "id": "5bd723701ecef91b",
        "type": "ui_text",
        "z": "b435fa1f0cb3b040",
        "group": "b973fd68fe795a1c",
        "order": 5,
        "width": 3,
        "height": 2,
        "name": "",
        "label": "status",
        "format": "<font face='arial'><font size=6><font color={{msg.payload.color}}>{{msg.payload.message}}",
        "layout": "col-center",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 690,
        "y": 740,
        "wires": []
    },
    {
        "id": "365b2c5ef9ffe010",
        "type": "link in",
        "z": "b435fa1f0cb3b040",
        "name": "link in 4",
        "links": ["b9d9c26a4f68fa1f"],
        "x": 255,
        "y": 620,
        "wires": [["6c5486538cb735ef"]]
    },
    {
        "id": "e03cc1879a05467f",
        "type": "mqtt in",
        "z": "b435fa1f0cb3b040",
        "name": "",
        "topic": "/BedroomB/condition",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "4f6c8a65bb8820c6",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 170,
        "y": 180,
        "wires": [["f4891b1c40fe8ace", "cc48f603b62cb6e1"]]
    },
    {
        "id": "cc48f603b62cb6e1",
        "type": "function",
        "z": "b435fa1f0cb3b040",
        "name": "convert data",
        "func": "let { ppm, temp, battery, smoke } = msg.payload;\nmsg.payload = { smoke: smoke ? smoke : 0, CO: ppm ? ppm : 0, temperture: temp ? temp : 20, battery: battery ? battery : 0 };\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 180,
        "wires": [["05dd899a97fe1d04"]]
    },
    {
        "id": "e862d0dadea0ac5b",
        "type": "link out",
        "z": "b435fa1f0cb3b040",
        "name": "living room status",
        "mode": "link",
        "links": ["c97ad871543274fa", "478292a4ebaca8d2"],
        "x": 655,
        "y": 700,
        "wires": []
    },
    {
        "id": "2f635d26fb72cf66",
        "type": "finite-state-machine",
        "z": "b435fa1f0cb3b040",
        "name": "",
        "fsmDefinition": "{\"state\":{\"status\":\"Normal\",\"data\":{\"x\":5}},\"transitions\":{\"Normal\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Normal\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Fire\":{\"temperture\":\"Fire\",\"CO\":\"Fire\",\"smoke\":\"Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Fire\",\"expire\":\"Fire\",\"reset\":\"Normal\"},\"CO too High\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"CO too High\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Smoke Detected\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Smoke Detected\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Potential Fire\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Potential Fire\",\"expire\":\"Normal\",\"reset\":\"Normal\"}}}",
        "sendInitialState": true,
        "sendStateWithoutChange": true,
        "showTransitionErrors": true,
        "x": 310,
        "y": 740,
        "wires": [["48e31f519a63034e", "6e5489be7be9a7da"]]
    },
    {
        "id": "6c5486538cb735ef",
        "type": "function",
        "z": "b435fa1f0cb3b040",
        "name": "check transition to FSM",
        "func": "const TEMP_ERROR_LIMIT = 40; // in C\nconst CO_ERROR_LIMIT = 15; // in ppm\n\nconst { smoke, temperture, CO } = msg.payload;\nmsg.topic = \"\"\nmsg.data = {smoke, temperture, CO}\nmsg.control = {}\n\nif (temperture >= TEMP_ERROR_LIMIT) {\n    msg.topic += \"temperture\";\n}\nif (CO >= CO_ERROR_LIMIT) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"CO\";\n}\nif (smoke === 1) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"smoke\";\n} \nif (msg.topic===\"\"){\n    msg.topic = \"normal\";\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 620,
        "wires": [["2f635d26fb72cf66", "6a929ec249a8c3f5"]]
    },
    {
        "id": "66a962fefd5f1adc",
        "type": "debug",
        "z": "b435fa1f0cb3b040",
        "name": "state",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 820,
        "wires": []
    },
    {
        "id": "6a929ec249a8c3f5",
        "type": "debug",
        "z": "b435fa1f0cb3b040",
        "name": "trasition",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 780,
        "y": 620,
        "wires": []
    },
    {
        "id": "22f28bcba88c1e6b",
        "type": "inject",
        "z": "b435fa1f0cb3b040",
        "name": "reset",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "reset",
        "payload": "",
        "payloadType": "date",
        "x": 90,
        "y": 740,
        "wires": [["2f635d26fb72cf66"]]
    },
    {
        "id": "48e31f519a63034e",
        "type": "function",
        "z": "b435fa1f0cb3b040",
        "name": "function 3",
        "func": "msg.state_color = {\n    \"Normal\": \"green\",\n    \"Fire\": \"red\",\n    \"CO too High\": \"orange\",\n    \"Smoke Detected\": \"orange\",\n    \"Potential Fire\": \"orange\"\n}\nmsg.payload = {\n    place: \"BedroomB\",\n    message: msg.payload.status,\n    color: msg.state_color[msg.payload.status]\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 740,
        "wires": [
            [
                "66a962fefd5f1adc",
                "5bd723701ecef91b",
                "e862d0dadea0ac5b",
                "344cc302fe6d0e31"
            ]
        ]
    },
    {
        "id": "6e5489be7be9a7da",
        "type": "debug",
        "z": "b435fa1f0cb3b040",
        "name": "debug 14",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 460,
        "y": 820,
        "wires": []
    },
    {
        "id": "4df94b68423da834",
        "type": "line-notify",
        "z": "b435fa1f0cb3b040",
        "name": "test YCK",
        "message": "",
        "contentType": "message",
        "imageThumbnail": "",
        "imageUrl": "",
        "sticker": "default",
        "stickerPackageId": "1",
        "stickerId": "1",
        "silent": false,
        "creds": "63115de6b1972cd9",
        "x": 980,
        "y": 920,
        "wires": [[]]
    },
    {
        "id": "2fadb96f33c45e52",
        "type": "inject",
        "z": "b435fa1f0cb3b040",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 270,
        "y": 920,
        "wires": [["344cc302fe6d0e31"]]
    },
    {
        "id": "344cc302fe6d0e31",
        "type": "rbe",
        "z": "b435fa1f0cb3b040",
        "name": "block the same value",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": true,
        "property": "payload",
        "topi": "topic",
        "x": 600,
        "y": 920,
        "wires": [["778fc063e30bf017"]]
    },
    {
        "id": "778fc063e30bf017",
        "type": "function",
        "z": "b435fa1f0cb3b040",
        "name": "modify message",
        "func": "const place = \"BedroomB\"\nif (msg.payload.message==\"Normal\"){\n    return;\n}\nmsg.payload = \"\\n注意！\\n\" + place + \": \" + msg.payload.message\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 920,
        "wires": [["4df94b68423da834"]]
    },
    {
        "id": "beae71ef1e39d287",
        "type": "ui_ui_control",
        "z": "b435fa1f0cb3b040",
        "name": "navigation",
        "events": "all",
        "x": 530,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "18a8c523cd2c4d80",
        "type": "ui_template",
        "z": "b435fa1f0cb3b040",
        "group": "b973fd68fe795a1c",
        "name": "Back Home",
        "order": 2,
        "width": 2,
        "height": 1,
        "format": "<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#e67e22\"\n    ng-click=\"send({payload: 'Home'})\">\n    Back\n</md-button>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 370,
        "y": 1020,
        "wires": [["beae71ef1e39d287"]]
    },
    {
        "id": "153213051eb73f6b",
        "type": "ui_template",
        "z": "b435fa1f0cb3b040",
        "group": "b973fd68fe795a1c",
        "name": "button css",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<style>\n  * {\n      overflow: hidden;\n  }\n  .filled { \n      height: 90% !important;\n      width: 90% !important;\n      padding: 0 !important;\n      margin: 4% !important;\n  }\n  .nr-dashboard-template {\n      padding: 0;\n      margin: 0;\n  }\n  \n  .rounded {\n  border-radius: 12px 12px 12px 12px;\n}\n \n   .bigfont {\n  font-size: 18px;\n}\n\n   .smallfont {\n  font-size: 12px;\n}\n  \n</style>\n\n<script>\n$('.vibrate').on('click', function() {\n  navigator.vibrate(100);\n});\n\nfunction restore_bg(x) {\n            $(this).css(\"background-color\", x);\n    };\n\n$('.touched').on('mousedown', function() {\n    \n    var x= $(this).css(\"background-color\");\n    $(this).css(\"background-color\", \"yellow\");\n    \n    setTimeout(restore_bg.bind(this,x),100);\n    navigator.vibrate(80);\n    });\n    \n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 190,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "efcc603f89ab8578",
        "type": "inject",
        "z": "b435fa1f0cb3b040",
        "name": "normal",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":8,\"temperture\":30}",
        "payloadType": "json",
        "x": 200,
        "y": 220,
        "wires": [["0de9d9d94ad6d105"]]
    },
    {
        "id": "0d7186c291c9df3e",
        "type": "inject",
        "z": "b435fa1f0cb3b040",
        "name": "smoke",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":1,\"CO\":8,\"temperture\":30}",
        "payloadType": "json",
        "x": 190,
        "y": 260,
        "wires": [["0de9d9d94ad6d105"]]
    },
    {
        "id": "276bfc465b2f48f3",
        "type": "inject",
        "z": "b435fa1f0cb3b040",
        "name": "CO",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":30}",
        "payloadType": "json",
        "x": 190,
        "y": 300,
        "wires": [["0de9d9d94ad6d105"]]
    },
    {
        "id": "86d1dc3205c1ec9c",
        "type": "inject",
        "z": "b435fa1f0cb3b040",
        "name": "fire",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":45}",
        "payloadType": "json",
        "x": 190,
        "y": 340,
        "wires": [["0de9d9d94ad6d105"]]
    },
    {
        "id": "0de9d9d94ad6d105",
        "type": "delay",
        "z": "b435fa1f0cb3b040",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 410,
        "y": 280,
        "wires": [["05dd899a97fe1d04"]]
    },
    {
        "id": "69c5693719c5afac",
        "type": "link in",
        "z": "b435fa1f0cb3b040",
        "name": "all reset",
        "links": ["1765ee585273167c"],
        "x": 135,
        "y": 800,
        "wires": [["2f635d26fb72cf66"]]
    },
    {
        "id": "ef3bdeb37b590597",
        "type": "link in",
        "z": "b435fa1f0cb3b040",
        "name": "reset",
        "links": ["1765ee585273167c"],
        "x": 95,
        "y": 380,
        "wires": [["fd3fd1ed33c25847"]]
    },
    {
        "id": "fd3fd1ed33c25847",
        "type": "function",
        "z": "b435fa1f0cb3b040",
        "name": "reset normal",
        "func": "msg.payload = { \"smoke\": 0, \"CO\": 8, \"temperture\": 30 }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 210,
        "y": 380,
        "wires": [["0de9d9d94ad6d105"]]
    },
    {
        "id": "42b91a8d3ef8e505",
        "type": "ui_ui_control",
        "z": "b435fa1f0cb3b040",
        "name": "",
        "events": "all",
        "x": 80,
        "y": 840,
        "wires": [["45a8634c99467356"]]
    },
    {
        "id": "45a8634c99467356",
        "type": "function",
        "z": "b435fa1f0cb3b040",
        "name": "trigger when chage page",
        "func": "msg.topic = \"normal\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 270,
        "y": 840,
        "wires": [["2f635d26fb72cf66"]]
    },
    {
        "id": "0362e403b7ac805c",
        "type": "ui_template",
        "z": "b435fa1f0cb3b040",
        "group": "b973fd68fe795a1c",
        "name": "煙霧顯示",
        "order": 6,
        "width": 3,
        "height": 2,
        "format": "<div id=\"graphics\" ng-init=\"checkSVG()\" style=\"display: flex; justify-content:center;align-items:center\">\n    <p id=\"e1_text\">煙霧</p>\n    <svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0\" y=\"0\" height=\"34\"\n        viewBox=\"0 0 34 34\" width=\"34\" preserveAspectRatio=\"xMidYMid meet\">\n        <circle id=\"e1_circle\" cx=\"17\" cy=\"17\" style=\"fill:green;stroke-width:0px;overflow:hidden\" r=\"16\" />\n    </svg>\n    <script>\n        (function($scope) {\n                $scope.$watch('msg', function() {\n                    if (!$scope.msg) return;\n                    const color=$scope.msg.payload?.color;\n                    const topic=$scope.msg.topic;\n                    if (color === undefined || color === null ||\n                        !topic || typeof topic !== 'string' || !topic.includes('@')) return;\n                    const id = topic.split('@')[0], cxType = topic.split('@')[1];\n                    document.getElementById(id+\"_circle\").style.fill=color;\n                    document.getElementById(id+\"_text\").style.cssText = `color:${color} !important;font-weight:bold` ;\n                });\n            })(scope);\n    </script>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 500,
        "y": 440,
        "wires": [["0681c20b7ec2f13c"]]
    },
    {
        "id": "0484653ef739e955",
        "type": "ui_template",
        "z": "b435fa1f0cb3b040",
        "group": "b973fd68fe795a1c",
        "name": "power icon",
        "order": 3,
        "width": 1,
        "height": 1,
        "format": "<div style=\"display: flex; justify-content:center;align-items:center;height: auto; width: auto\">\n    <img id=\"battery\" style=\"height: auto; width: auto;display: none\" src=\"/half-battery.png\">\n    <img id=\"charging\" style=\"height: auto; width: auto;display: block\" src=\"/low-battery.png\">\n</div>\n\n<script>\n    (function($scope) {\n        $scope.$watch('msg', function() {\n            if (!$scope.msg) return;\n            const battery=$scope.msg.payload?.battery;\n            // console.log(battery);\n            if(battery){\n                $(\"#battery\").css(\"display\",battery?\"block\":\"none\");\n                $(\"#charging\").css(\"display\",battery?\"none\":\"block\");\n            }\n        });\n    })(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 510,
        "y": 400,
        "wires": [[]]
    },
    {
        "id": "ad87beb3edecc184",
        "type": "link in",
        "z": "b435fa1f0cb3b040",
        "name": "link in 7",
        "links": ["b9d9c26a4f68fa1f"],
        "x": 365,
        "y": 400,
        "wires": [["0484653ef739e955"]]
    },
    {
        "id": "05dd899a97fe1d04",
        "type": "function",
        "z": "b435fa1f0cb3b040",
        "name": "add node information",
        "func": "msg.payload.place = \"livingroom\";\nmsg.payload.time = Date.now();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 740,
        "y": 200,
        "wires": [["b9d9c26a4f68fa1f"]]
    },
    {
        "id": "8dbbb7f92673413d",
        "type": "random",
        "z": "92d2ee6e5b09e9e8",
        "name": "偵煙器",
        "low": "0",
        "high": "1",
        "inte": "true",
        "property": "payload",
        "x": 250,
        "y": 160,
        "wires": [["3b4681ef0cea2594"]]
    },
    {
        "id": "87772baa33e6dc60",
        "type": "random",
        "z": "92d2ee6e5b09e9e8",
        "name": "CO(ppm)",
        "low": "0",
        "high": 10,
        "inte": "false",
        "property": "payload",
        "x": 260,
        "y": 200,
        "wires": [["86054f591bdbb15d"]]
    },
    {
        "id": "89f4f546dd0675bf",
        "type": "random",
        "z": "92d2ee6e5b09e9e8",
        "name": "溫度",
        "low": "-10",
        "high": "50",
        "inte": "false",
        "property": "payload",
        "x": 250,
        "y": 240,
        "wires": [["fc37d8dfcdcb4576"]]
    },
    {
        "id": "26e5791d636fe44a",
        "type": "join",
        "z": "92d2ee6e5b09e9e8",
        "name": "",
        "mode": "custom",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "1",
        "count": "3",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 570,
        "y": 200,
        "wires": [["7ae1fc736bc32c28"]]
    },
    {
        "id": "40688dd92c4017e8",
        "type": "debug",
        "z": "92d2ee6e5b09e9e8",
        "name": "combine",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 760,
        "y": 100,
        "wires": []
    },
    {
        "id": "3b4681ef0cea2594",
        "type": "change",
        "z": "92d2ee6e5b09e9e8",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "smoke",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 400,
        "y": 160,
        "wires": [["26e5791d636fe44a"]]
    },
    {
        "id": "86054f591bdbb15d",
        "type": "change",
        "z": "92d2ee6e5b09e9e8",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "CO",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 400,
        "y": 200,
        "wires": [["26e5791d636fe44a"]]
    },
    {
        "id": "fc37d8dfcdcb4576",
        "type": "change",
        "z": "92d2ee6e5b09e9e8",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperture",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 400,
        "y": 240,
        "wires": [["26e5791d636fe44a"]]
    },
    {
        "id": "a7fc4f18fcea3d98",
        "type": "inject",
        "z": "92d2ee6e5b09e9e8",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 90,
        "y": 200,
        "wires": [["8dbbb7f92673413d", "87772baa33e6dc60", "89f4f546dd0675bf"]]
    },
    {
        "id": "7ae1fc736bc32c28",
        "type": "link out",
        "z": "92d2ee6e5b09e9e8",
        "name": "link out 1",
        "mode": "link",
        "links": [
            "198c2b0e0223ebc1",
            "d2b2919a13dc4b69",
            "38c94e8d39db0471",
            "8c681257bd8ba69b",
            "bbfae736aae5dded"
        ],
        "x": 905,
        "y": 200,
        "wires": []
    },
    {
        "id": "198c2b0e0223ebc1",
        "type": "link in",
        "z": "92d2ee6e5b09e9e8",
        "name": "link in 1",
        "links": ["7ae1fc736bc32c28"],
        "x": 255,
        "y": 440,
        "wires": [["b3d650b6f4060ee5"]]
    },
    {
        "id": "b3d650b6f4060ee5",
        "type": "function",
        "z": "92d2ee6e5b09e9e8",
        "name": "function 2",
        "func": "if(msg.payload.smoke===0){\n    msg.payload.color =\"#008000\"; //\"green\";\n}else{\n    msg.payload.color = \"#b22222\"; // \"firebrick\";\n}\nmsg.topic = \"e1@cx_color\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 440,
        "wires": [["44a2186b755d4740"]]
    },
    {
        "id": "d8516630fb53fbea",
        "type": "debug",
        "z": "92d2ee6e5b09e9e8",
        "name": "debug 9",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 440,
        "wires": []
    },
    {
        "id": "d2b2919a13dc4b69",
        "type": "link in",
        "z": "92d2ee6e5b09e9e8",
        "name": "link in 2",
        "links": ["7ae1fc736bc32c28"],
        "x": 255,
        "y": 500,
        "wires": [["79f327def379de20"]]
    },
    {
        "id": "79f327def379de20",
        "type": "function",
        "z": "92d2ee6e5b09e9e8",
        "name": "溫度",
        "func": "msg.payload = msg.payload.temperture;\nmsg.topic = \"temperture\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 500,
        "wires": [["4bbfa82a03eb4877"]]
    },
    {
        "id": "b2603860b7efa5db",
        "type": "debug",
        "z": "92d2ee6e5b09e9e8",
        "name": "debug 10",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 500,
        "wires": []
    },
    {
        "id": "4bbfa82a03eb4877",
        "type": "ui_chart",
        "z": "92d2ee6e5b09e9e8",
        "name": "",
        "group": "bf27c1590187175e",
        "order": 4,
        "width": 11,
        "height": 5,
        "label": "溫度",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "-10",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 490,
        "y": 500,
        "wires": [["b2603860b7efa5db"]]
    },
    {
        "id": "38c94e8d39db0471",
        "type": "link in",
        "z": "92d2ee6e5b09e9e8",
        "name": "link in 3",
        "links": ["7ae1fc736bc32c28"],
        "x": 255,
        "y": 560,
        "wires": [["15afbac1f82ac29a"]]
    },
    {
        "id": "15afbac1f82ac29a",
        "type": "function",
        "z": "92d2ee6e5b09e9e8",
        "name": "CO",
        "func": "msg.payload = msg.payload.CO;\nmsg.topic = \"CO\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 560,
        "wires": [["c659c63f092a7934"]]
    },
    {
        "id": "7028438eb61f3933",
        "type": "debug",
        "z": "92d2ee6e5b09e9e8",
        "name": "debug 11",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 560,
        "wires": []
    },
    {
        "id": "c659c63f092a7934",
        "type": "ui_chart",
        "z": "92d2ee6e5b09e9e8",
        "name": "",
        "group": "bf27c1590187175e",
        "order": 7,
        "width": 14,
        "height": 4,
        "label": "CO(ppm)",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 500,
        "y": 560,
        "wires": [["7028438eb61f3933"]]
    },
    {
        "id": "b863a5a654d1f18d",
        "type": "ui_text",
        "z": "92d2ee6e5b09e9e8",
        "group": "bf27c1590187175e",
        "order": 5,
        "width": 3,
        "height": 2,
        "name": "",
        "label": "status",
        "format": "<font face='arial'><font size=6><font color={{msg.payload.color}}>{{msg.payload.message}}",
        "layout": "col-center",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 690,
        "y": 740,
        "wires": []
    },
    {
        "id": "8c681257bd8ba69b",
        "type": "link in",
        "z": "92d2ee6e5b09e9e8",
        "name": "link in 4",
        "links": ["7ae1fc736bc32c28"],
        "x": 255,
        "y": 620,
        "wires": [["acafd638e3c137a3"]]
    },
    {
        "id": "e38587ba54f98248",
        "type": "mqtt in",
        "z": "92d2ee6e5b09e9e8",
        "name": "",
        "topic": "/kitchen/condition",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "4f6c8a65bb8820c6",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 580,
        "y": 100,
        "wires": [["40688dd92c4017e8", "8084981ab24c8e70"]]
    },
    {
        "id": "8084981ab24c8e70",
        "type": "function",
        "z": "92d2ee6e5b09e9e8",
        "name": "convert data",
        "func": "let { ppm, temp, battery, smoke } = msg.payload;\nmsg.payload = { smoke: smoke ? smoke : 0, CO: ppm ? ppm : 0, temperture: temp ? temp : 20, battery: battery ? battery : 0 };\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 750,
        "y": 160,
        "wires": [["7ae1fc736bc32c28"]]
    },
    {
        "id": "07039cea834378fa",
        "type": "link out",
        "z": "92d2ee6e5b09e9e8",
        "name": "bedroom status",
        "mode": "link",
        "links": ["c97ad871543274fa", "478292a4ebaca8d2"],
        "x": 655,
        "y": 700,
        "wires": []
    },
    {
        "id": "66e55b82adb6b3a1",
        "type": "finite-state-machine",
        "z": "92d2ee6e5b09e9e8",
        "name": "",
        "fsmDefinition": "{\"state\":{\"status\":\"Normal\",\"data\":{\"x\":5}},\"transitions\":{\"Normal\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Normal\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Fire\":{\"temperture\":\"Fire\",\"CO\":\"Fire\",\"smoke\":\"Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Fire\",\"expire\":\"Fire\",\"reset\":\"Normal\"},\"CO too High\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"CO too High\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Smoke Detected\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Smoke Detected\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Potential Fire\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Potential Fire\",\"expire\":\"Normal\",\"reset\":\"Normal\"}}}",
        "sendInitialState": true,
        "sendStateWithoutChange": true,
        "showTransitionErrors": true,
        "x": 310,
        "y": 740,
        "wires": [["4cac659f45b18ef6", "38febb98e659dcda"]]
    },
    {
        "id": "acafd638e3c137a3",
        "type": "function",
        "z": "92d2ee6e5b09e9e8",
        "name": "check transition to FSM",
        "func": "const TEMP_ERROR_LIMIT = 40; // in C\nconst CO_ERROR_LIMIT = 15; // in ppm\n\nconst { smoke, temperture, CO } = msg.payload;\nmsg.topic = \"\"\nmsg.data = {smoke, temperture, CO}\nmsg.control = {}\n\nif (temperture >= TEMP_ERROR_LIMIT) {\n    msg.topic += \"temperture\";\n}\nif (CO >= CO_ERROR_LIMIT) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"CO\";\n}\nif (smoke === 1) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"smoke\";\n} \nif (msg.topic===\"\"){\n    msg.topic = \"normal\";\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 620,
        "wires": [["66e55b82adb6b3a1", "6deaa2a19fe80091"]]
    },
    {
        "id": "17832abad4d2a288",
        "type": "debug",
        "z": "92d2ee6e5b09e9e8",
        "name": "state",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 820,
        "wires": []
    },
    {
        "id": "6deaa2a19fe80091",
        "type": "debug",
        "z": "92d2ee6e5b09e9e8",
        "name": "trasition",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 720,
        "y": 620,
        "wires": []
    },
    {
        "id": "5f481ca36235fd4a",
        "type": "inject",
        "z": "92d2ee6e5b09e9e8",
        "name": "reset",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "reset",
        "payload": "",
        "payloadType": "date",
        "x": 90,
        "y": 740,
        "wires": [["66e55b82adb6b3a1"]]
    },
    {
        "id": "4cac659f45b18ef6",
        "type": "function",
        "z": "92d2ee6e5b09e9e8",
        "name": "function 3",
        "func": "msg.state_color = {\n    \"Normal\": \"green\",\n    \"Fire\": \"red\",\n    \"CO too High\": \"orange\",\n    \"Smoke Detected\": \"orange\",\n    \"Potential Fire\": \"orange\"\n}\nmsg.payload = {\n    place: \"kitchen\",\n    message: msg.payload.status,\n    color: msg.state_color[msg.payload.status]\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 740,
        "wires": [
            [
                "17832abad4d2a288",
                "b863a5a654d1f18d",
                "07039cea834378fa",
                "41ef74877c203299"
            ]
        ]
    },
    {
        "id": "38febb98e659dcda",
        "type": "debug",
        "z": "92d2ee6e5b09e9e8",
        "name": "debug 14",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 460,
        "y": 820,
        "wires": []
    },
    {
        "id": "b554f62aa0e259c8",
        "type": "line-notify",
        "z": "92d2ee6e5b09e9e8",
        "name": "test YCK",
        "message": "",
        "contentType": "message",
        "imageThumbnail": "",
        "imageUrl": "",
        "sticker": "default",
        "stickerPackageId": "1",
        "stickerId": "1",
        "silent": false,
        "creds": "63115de6b1972cd9",
        "x": 980,
        "y": 920,
        "wires": [[]]
    },
    {
        "id": "cb372ad0d58a49a7",
        "type": "inject",
        "z": "92d2ee6e5b09e9e8",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 270,
        "y": 920,
        "wires": [["41ef74877c203299"]]
    },
    {
        "id": "41ef74877c203299",
        "type": "rbe",
        "z": "92d2ee6e5b09e9e8",
        "name": "block the same value",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": true,
        "property": "payload",
        "topi": "topic",
        "x": 600,
        "y": 920,
        "wires": [["299327b87a8cc242"]]
    },
    {
        "id": "299327b87a8cc242",
        "type": "function",
        "z": "92d2ee6e5b09e9e8",
        "name": "modify message",
        "func": "// TODO: after added as new node please moodify place name\nconst place = \"kitchen\" \nif (msg.payload.message==\"Normal\"){\n    return;\n}\nmsg.payload = \"\\n注意！\\n\" + place + \": \" + msg.payload.message\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 920,
        "wires": [["b554f62aa0e259c8"]]
    },
    {
        "id": "e155e732e2afd82f",
        "type": "ui_ui_control",
        "z": "92d2ee6e5b09e9e8",
        "name": "navigation",
        "events": "all",
        "x": 530,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "481b55fff45a216e",
        "type": "ui_template",
        "z": "92d2ee6e5b09e9e8",
        "group": "bf27c1590187175e",
        "name": "Back Home",
        "order": 2,
        "width": 2,
        "height": 1,
        "format": "<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#e67e22\"\n    ng-click=\"send({payload: 'Home'})\">\n    Back\n</md-button>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 370,
        "y": 1020,
        "wires": [["e155e732e2afd82f"]]
    },
    {
        "id": "22e1c258e9c512b5",
        "type": "ui_template",
        "z": "92d2ee6e5b09e9e8",
        "group": "bf27c1590187175e",
        "name": "button css",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<style>\n  * {\n      overflow: hidden;\n  }\n  .filled { \n      height: 70% !important;\n      width: 90% !important;\n      padding: 0 !important;\n      margin: 4% !important;\n  }\n  .nr-dashboard-template {\n      padding: 0;\n      margin: 0;\n  }\n  \n  .rounded {\n  border-radius: 12px 12px 12px 12px;\n}\n \n   .bigfont {\n  font-size: 18px;\n}\n\n   .smallfont {\n  font-size: 12px;\n}\n  \n</style>\n\n<script>\n$('.vibrate').on('click', function() {\n  navigator.vibrate(100);\n});\n\nfunction restore_bg(x) {\n            $(this).css(\"background-color\", x);\n    };\n\n$('.touched').on('mousedown', function() {\n    \n    var x= $(this).css(\"background-color\");\n    $(this).css(\"background-color\", \"yellow\");\n    \n    setTimeout(restore_bg.bind(this,x),100);\n    navigator.vibrate(80);\n    });\n    \n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 190,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "6d91c156f8af9d36",
        "type": "inject",
        "z": "92d2ee6e5b09e9e8",
        "name": "normal",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":8,\"temperture\":30}",
        "payloadType": "json",
        "x": 680,
        "y": 240,
        "wires": [["13f723422dfed87f"]]
    },
    {
        "id": "1342752463ec3e5a",
        "type": "inject",
        "z": "92d2ee6e5b09e9e8",
        "name": "smoke",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":1,\"CO\":8,\"temperture\":30}",
        "payloadType": "json",
        "x": 670,
        "y": 280,
        "wires": [["13f723422dfed87f"]]
    },
    {
        "id": "00cebf40cfa47a07",
        "type": "inject",
        "z": "92d2ee6e5b09e9e8",
        "name": "CO",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":30}",
        "payloadType": "json",
        "x": 670,
        "y": 320,
        "wires": [["13f723422dfed87f"]]
    },
    {
        "id": "df2789c6d1fb11e5",
        "type": "inject",
        "z": "92d2ee6e5b09e9e8",
        "name": "fire",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":45}",
        "payloadType": "json",
        "x": 670,
        "y": 360,
        "wires": [["13f723422dfed87f"]]
    },
    {
        "id": "13f723422dfed87f",
        "type": "delay",
        "z": "92d2ee6e5b09e9e8",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 830,
        "y": 300,
        "wires": [["7ae1fc736bc32c28"]]
    },
    {
        "id": "d6ac4f62ad49c8d6",
        "type": "link in",
        "z": "92d2ee6e5b09e9e8",
        "name": "all reset",
        "links": ["1765ee585273167c"],
        "x": 85,
        "y": 800,
        "wires": [["66e55b82adb6b3a1"]]
    },
    {
        "id": "11b7216be9bf733f",
        "type": "link in",
        "z": "92d2ee6e5b09e9e8",
        "name": "reset",
        "links": ["1765ee585273167c"],
        "x": 585,
        "y": 400,
        "wires": [["7dd871c208aab74e"]]
    },
    {
        "id": "7dd871c208aab74e",
        "type": "function",
        "z": "92d2ee6e5b09e9e8",
        "name": "reset normal",
        "func": "msg.payload = { \"smoke\": 0, \"CO\": 8, \"temperture\": 30 }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 700,
        "y": 400,
        "wires": [["13f723422dfed87f"]]
    },
    {
        "id": "05166cbe3800c239",
        "type": "ui_ui_control",
        "z": "92d2ee6e5b09e9e8",
        "name": "",
        "events": "all",
        "x": 60,
        "y": 860,
        "wires": [["754693484dbb3241"]]
    },
    {
        "id": "754693484dbb3241",
        "type": "function",
        "z": "92d2ee6e5b09e9e8",
        "name": "trigger when chage page",
        "func": "msg.topic = \"normal\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 230,
        "y": 860,
        "wires": [["66e55b82adb6b3a1"]]
    },
    {
        "id": "44a2186b755d4740",
        "type": "ui_template",
        "z": "92d2ee6e5b09e9e8",
        "group": "bf27c1590187175e",
        "name": "煙霧顯示",
        "order": 6,
        "width": 3,
        "height": 2,
        "format": "<div id=\"graphics\" ng-init=\"checkSVG()\" style=\"display: flex; justify-content:center;align-items:center\">\n    <p id=\"e1_text\">煙霧</p>\n    <svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0\" y=\"0\" height=\"34\"\n        viewBox=\"0 0 34 34\" width=\"34\" preserveAspectRatio=\"xMidYMid meet\">\n        <circle id=\"e1_circle\" cx=\"17\" cy=\"17\" style=\"fill:green;stroke-width:0px;overflow:hidden\" r=\"16\" />\n    </svg>\n    <script>\n        (function($scope) {\n                $scope.$watch('msg', function() {\n                    if (!$scope.msg) return;\n                    const color=$scope.msg.payload?.color;\n                    const topic=$scope.msg.topic;\n                    if (color === undefined || color === null ||\n                        !topic || typeof topic !== 'string' || !topic.includes('@')) return;\n                    const id = topic.split('@')[0], cxType = topic.split('@')[1];\n                    document.getElementById(id+\"_circle\").style.fill=color;\n                    document.getElementById(id+\"_text\").style.cssText = `color:${color} !important;font-weight:bold` ;\n                });\n            })(scope);\n    </script>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 500,
        "y": 440,
        "wires": [["d8516630fb53fbea"]]
    },
    {
        "id": "216dcd8b7054618c",
        "type": "ui_template",
        "z": "92d2ee6e5b09e9e8",
        "group": "bf27c1590187175e",
        "name": "power icon",
        "order": 3,
        "width": 1,
        "height": 1,
        "format": "<div style=\"display: flex; justify-content:center;align-items:center;height: auto; width: auto\">\n    <img id=\"battery\" style=\"height: auto; width: auto;display: none\" src=\"/half-battery.png\">\n    <img id=\"charging\" style=\"height: auto; width: auto;display: block\" src=\"/low-battery.png\">\n</div>\n\n<script>\n    (function($scope) {\n        $scope.$watch('msg', function() {\n            if (!$scope.msg) return;\n            const battery=$scope.msg.payload?.battery;\n            // console.log(battery);\n            if(battery){\n                $(\"#battery\").css(\"display\",battery?\"block\":\"none\");\n                $(\"#charging\").css(\"display\",battery?\"none\":\"block\");\n            }\n        });\n    })(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 370,
        "y": 1060,
        "wires": [[]]
    },
    {
        "id": "bbfae736aae5dded",
        "type": "link in",
        "z": "92d2ee6e5b09e9e8",
        "name": "link in 8",
        "links": ["7ae1fc736bc32c28"],
        "x": 265,
        "y": 1060,
        "wires": [["216dcd8b7054618c"]]
    },
    {
        "id": "3234f3ae83c3cacf",
        "type": "random",
        "z": "5d81d50e014fd538",
        "name": "偵煙器",
        "low": "0",
        "high": "1",
        "inte": "true",
        "property": "payload",
        "x": 250,
        "y": 160,
        "wires": [["b4f9c4246eccb5a9"]]
    },
    {
        "id": "d0ad1570f38be01e",
        "type": "random",
        "z": "5d81d50e014fd538",
        "name": "CO(ppm)",
        "low": "0",
        "high": 10,
        "inte": "false",
        "property": "payload",
        "x": 260,
        "y": 200,
        "wires": [["ba64229fc4f92904"]]
    },
    {
        "id": "a4a16afb7ad19c51",
        "type": "random",
        "z": "5d81d50e014fd538",
        "name": "溫度",
        "low": "-10",
        "high": "50",
        "inte": "false",
        "property": "payload",
        "x": 250,
        "y": 240,
        "wires": [["183c255fc08f5236"]]
    },
    {
        "id": "c65ecd67a1c99ccf",
        "type": "join",
        "z": "5d81d50e014fd538",
        "name": "",
        "mode": "custom",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "1",
        "count": "3",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 570,
        "y": 200,
        "wires": [["8bb1f3c98c9cf7b5"]]
    },
    {
        "id": "ad0d828f2d1c576a",
        "type": "debug",
        "z": "5d81d50e014fd538",
        "name": "combine",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 760,
        "y": 100,
        "wires": []
    },
    {
        "id": "b4f9c4246eccb5a9",
        "type": "change",
        "z": "5d81d50e014fd538",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "smoke",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 400,
        "y": 160,
        "wires": [["c65ecd67a1c99ccf"]]
    },
    {
        "id": "ba64229fc4f92904",
        "type": "change",
        "z": "5d81d50e014fd538",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "CO",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 400,
        "y": 200,
        "wires": [["c65ecd67a1c99ccf"]]
    },
    {
        "id": "183c255fc08f5236",
        "type": "change",
        "z": "5d81d50e014fd538",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperture",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 400,
        "y": 240,
        "wires": [["c65ecd67a1c99ccf"]]
    },
    {
        "id": "fd897d208ec3612a",
        "type": "inject",
        "z": "5d81d50e014fd538",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 90,
        "y": 200,
        "wires": [["3234f3ae83c3cacf", "d0ad1570f38be01e", "a4a16afb7ad19c51"]]
    },
    {
        "id": "8bb1f3c98c9cf7b5",
        "type": "link out",
        "z": "5d81d50e014fd538",
        "name": "link out 1",
        "mode": "link",
        "links": [
            "5a9f14115eacfb7c",
            "b11f9de0718e0975",
            "6059d06d4e0e6155",
            "f67ce607a9e0c874",
            "5a3981e30582596e"
        ],
        "x": 905,
        "y": 200,
        "wires": []
    },
    {
        "id": "5a9f14115eacfb7c",
        "type": "link in",
        "z": "5d81d50e014fd538",
        "name": "link in 1",
        "links": ["8bb1f3c98c9cf7b5"],
        "x": 255,
        "y": 480,
        "wires": [["6f855d0e7b4856f6"]]
    },
    {
        "id": "6f855d0e7b4856f6",
        "type": "function",
        "z": "5d81d50e014fd538",
        "name": "function 2",
        "func": "if(msg.payload.smoke===0){\n    msg.payload.color =\"#008000\"; //\"green\";\n}else{\n    msg.payload.color = \"#b22222\"; // \"firebrick\";\n}\nmsg.topic = \"e1@cx_color\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 480,
        "wires": [["151dc2ed8b35453e"]]
    },
    {
        "id": "151dc2ed8b35453e",
        "type": "ui_template",
        "z": "5d81d50e014fd538",
        "group": "d5323f44ca2adf10",
        "name": "煙霧顯示",
        "order": 6,
        "width": 3,
        "height": 2,
        "format": "<div id=\"graphics\" ng-init=\"checkSVG()\" style=\"display: flex; justify-content:center;align-items:center\">\n    <p id=\"e1_text\">煙霧</p>\n    <svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0\" y=\"0\" height=\"34\"\n        viewBox=\"0 0 34 34\" width=\"34\" preserveAspectRatio=\"xMidYMid meet\">\n        <circle id=\"e1_circle\" cx=\"17\" cy=\"17\" style=\"fill:green;stroke-width:0px;overflow:hidden\" r=\"16\" />\n    </svg>\n    <script>\n        (function($scope) {\n                $scope.$watch('msg', function() {\n                    if (!$scope.msg) return;\n                    const color=$scope.msg.payload?.color;\n                    const topic=$scope.msg.topic;\n                    if (color === undefined || color === null ||\n                        !topic || typeof topic !== 'string' || !topic.includes('@')) return;\n                    const id = topic.split('@')[0], cxType = topic.split('@')[1];\n                    document.getElementById(id+\"_circle\").style.fill=color;\n                    document.getElementById(id+\"_text\").style.cssText = `color:${color} !important;font-weight:bold` ;\n                });\n            })(scope);\n    </script>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 500,
        "y": 480,
        "wires": [["3a528938f6ccd11c"]]
    },
    {
        "id": "3a528938f6ccd11c",
        "type": "debug",
        "z": "5d81d50e014fd538",
        "name": "debug 9",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 480,
        "wires": []
    },
    {
        "id": "b11f9de0718e0975",
        "type": "link in",
        "z": "5d81d50e014fd538",
        "name": "link in 2",
        "links": ["8bb1f3c98c9cf7b5"],
        "x": 255,
        "y": 540,
        "wires": [["13fe047bf111013c"]]
    },
    {
        "id": "13fe047bf111013c",
        "type": "function",
        "z": "5d81d50e014fd538",
        "name": "溫度",
        "func": "msg.payload = msg.payload.temperture;\nmsg.topic = \"temperture\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 540,
        "wires": [["07487cf546cb84f5"]]
    },
    {
        "id": "a39d6d71329df9c6",
        "type": "debug",
        "z": "5d81d50e014fd538",
        "name": "debug 10",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 540,
        "wires": []
    },
    {
        "id": "07487cf546cb84f5",
        "type": "ui_chart",
        "z": "5d81d50e014fd538",
        "name": "",
        "group": "d5323f44ca2adf10",
        "order": 4,
        "width": 11,
        "height": 5,
        "label": "溫度",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "-10",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 490,
        "y": 540,
        "wires": [["a39d6d71329df9c6"]]
    },
    {
        "id": "6059d06d4e0e6155",
        "type": "link in",
        "z": "5d81d50e014fd538",
        "name": "link in 3",
        "links": ["8bb1f3c98c9cf7b5"],
        "x": 255,
        "y": 600,
        "wires": [["e74cd7d63c3bf415"]]
    },
    {
        "id": "e74cd7d63c3bf415",
        "type": "function",
        "z": "5d81d50e014fd538",
        "name": "CO",
        "func": "msg.payload = msg.payload.CO;\nmsg.topic = \"CO\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 600,
        "wires": [["fdb2fa0036b2567c"]]
    },
    {
        "id": "a0b6178a7d912927",
        "type": "debug",
        "z": "5d81d50e014fd538",
        "name": "debug 11",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 600,
        "wires": []
    },
    {
        "id": "fdb2fa0036b2567c",
        "type": "ui_chart",
        "z": "5d81d50e014fd538",
        "name": "",
        "group": "d5323f44ca2adf10",
        "order": 7,
        "width": 14,
        "height": 4,
        "label": "CO(ppm)",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 500,
        "y": 600,
        "wires": [["a0b6178a7d912927"]]
    },
    {
        "id": "9e0cbe124332ed39",
        "type": "ui_text",
        "z": "5d81d50e014fd538",
        "group": "d5323f44ca2adf10",
        "order": 5,
        "width": 3,
        "height": 2,
        "name": "",
        "label": "status",
        "format": "<font face='arial'><font size=6><font color={{msg.payload.color}}>{{msg.payload.message}}",
        "layout": "col-center",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 690,
        "y": 740,
        "wires": []
    },
    {
        "id": "f67ce607a9e0c874",
        "type": "link in",
        "z": "5d81d50e014fd538",
        "name": "link in 4",
        "links": ["8bb1f3c98c9cf7b5"],
        "x": 255,
        "y": 660,
        "wires": [["ce5e7ec222ce37c4"]]
    },
    {
        "id": "91182cd1ee6bb072",
        "type": "mqtt in",
        "z": "5d81d50e014fd538",
        "name": "",
        "topic": "/meetingroom/condition",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "4f6c8a65bb8820c6",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 580,
        "y": 100,
        "wires": [["ad0d828f2d1c576a", "0440f91ba7dbb3c5"]]
    },
    {
        "id": "0440f91ba7dbb3c5",
        "type": "function",
        "z": "5d81d50e014fd538",
        "name": "convert data",
        "func": "let { ppm, temp, battery, smoke } = msg.payload;\nmsg.payload = { smoke: smoke ? smoke : 0, CO: ppm ? ppm : 0, temperture: temp ? temp : 20, battery: battery ? battery : 0 };\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 750,
        "y": 160,
        "wires": [["8bb1f3c98c9cf7b5"]]
    },
    {
        "id": "28f138029255fbe1",
        "type": "link out",
        "z": "5d81d50e014fd538",
        "name": "master room status",
        "mode": "link",
        "links": ["c97ad871543274fa", "478292a4ebaca8d2"],
        "x": 655,
        "y": 700,
        "wires": []
    },
    {
        "id": "e2ca030976587723",
        "type": "finite-state-machine",
        "z": "5d81d50e014fd538",
        "name": "",
        "fsmDefinition": "{\"state\":{\"status\":\"Normal\",\"data\":{\"x\":5}},\"transitions\":{\"Normal\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Normal\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Fire\":{\"temperture\":\"Fire\",\"CO\":\"Fire\",\"smoke\":\"Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Fire\",\"expire\":\"Fire\",\"reset\":\"Normal\"},\"CO too High\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"CO too High\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Smoke Detected\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Smoke Detected\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Potential Fire\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Potential Fire\",\"expire\":\"Normal\",\"reset\":\"Normal\"}}}",
        "sendInitialState": true,
        "sendStateWithoutChange": true,
        "showTransitionErrors": true,
        "x": 310,
        "y": 740,
        "wires": [["0de9fb5ad7536385", "f747314afabc75a1"]]
    },
    {
        "id": "ce5e7ec222ce37c4",
        "type": "function",
        "z": "5d81d50e014fd538",
        "name": "check transition to FSM",
        "func": "const TEMP_ERROR_LIMIT = 40; // in C\nconst CO_ERROR_LIMIT = 15; // in ppm\n\nconst { smoke, temperture, CO } = msg.payload;\nmsg.topic = \"\"\nmsg.data = {smoke, temperture, CO}\nmsg.control = {}\n\nif (temperture >= TEMP_ERROR_LIMIT) {\n    msg.topic += \"temperture\";\n}\nif (CO >= CO_ERROR_LIMIT) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"CO\";\n}\nif (smoke === 1) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"smoke\";\n} \nif (msg.topic===\"\"){\n    msg.topic = \"normal\";\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 660,
        "wires": [["e2ca030976587723", "c230980c36ab2fc0"]]
    },
    {
        "id": "09c9ae8808dfa4d8",
        "type": "debug",
        "z": "5d81d50e014fd538",
        "name": "state",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 820,
        "wires": []
    },
    {
        "id": "c230980c36ab2fc0",
        "type": "debug",
        "z": "5d81d50e014fd538",
        "name": "trasition",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 740,
        "y": 660,
        "wires": []
    },
    {
        "id": "a38a242826c87063",
        "type": "inject",
        "z": "5d81d50e014fd538",
        "name": "reset",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "reset",
        "payload": "",
        "payloadType": "date",
        "x": 90,
        "y": 740,
        "wires": [["e2ca030976587723"]]
    },
    {
        "id": "0de9fb5ad7536385",
        "type": "function",
        "z": "5d81d50e014fd538",
        "name": "function 3",
        "func": "msg.state_color = {\n    \"Normal\": \"green\",\n    \"Fire\": \"red\",\n    \"CO too High\": \"orange\",\n    \"Smoke Detected\": \"orange\",\n    \"Potential Fire\": \"orange\"\n}\nmsg.payload = {\n    place: \"meetingroom\",\n    message: msg.payload.status,\n    color: msg.state_color[msg.payload.status]\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 740,
        "wires": [
            [
                "09c9ae8808dfa4d8",
                "9e0cbe124332ed39",
                "28f138029255fbe1",
                "854d5a5289f818a4"
            ]
        ]
    },
    {
        "id": "f747314afabc75a1",
        "type": "debug",
        "z": "5d81d50e014fd538",
        "name": "debug 14",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 460,
        "y": 820,
        "wires": []
    },
    {
        "id": "8d82b3a2c811b0c4",
        "type": "line-notify",
        "z": "5d81d50e014fd538",
        "name": "test YCK",
        "message": "",
        "contentType": "message",
        "imageThumbnail": "",
        "imageUrl": "",
        "sticker": "default",
        "stickerPackageId": "1",
        "stickerId": "1",
        "silent": false,
        "creds": "63115de6b1972cd9",
        "x": 980,
        "y": 920,
        "wires": [[]]
    },
    {
        "id": "b72fd14bdf217421",
        "type": "inject",
        "z": "5d81d50e014fd538",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 270,
        "y": 920,
        "wires": [["854d5a5289f818a4"]]
    },
    {
        "id": "854d5a5289f818a4",
        "type": "rbe",
        "z": "5d81d50e014fd538",
        "name": "block the same value",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": true,
        "property": "payload",
        "topi": "topic",
        "x": 600,
        "y": 920,
        "wires": [["7434a63943691d7e"]]
    },
    {
        "id": "7434a63943691d7e",
        "type": "function",
        "z": "5d81d50e014fd538",
        "name": "modify message",
        "func": "// TODO: after added as new node please moodify place name\nconst place = \"meeting room\" \nif (msg.payload.message==\"Normal\"){\n    return;\n}\nmsg.payload = \"\\n注意！\\n\" + place + \": \" + msg.payload.message\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 920,
        "wires": [["8d82b3a2c811b0c4"]]
    },
    {
        "id": "402ab7034114c882",
        "type": "ui_ui_control",
        "z": "5d81d50e014fd538",
        "name": "navigation",
        "events": "all",
        "x": 530,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "70d118719082a0ec",
        "type": "ui_template",
        "z": "5d81d50e014fd538",
        "group": "d5323f44ca2adf10",
        "name": "Back Home",
        "order": 2,
        "width": 2,
        "height": 1,
        "format": "<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#e67e22\"\n    ng-click=\"send({payload: 'Home'})\">\n    Back\n</md-button>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 370,
        "y": 1020,
        "wires": [["402ab7034114c882"]]
    },
    {
        "id": "60e550dd6aa84afd",
        "type": "ui_template",
        "z": "5d81d50e014fd538",
        "group": "d5323f44ca2adf10",
        "name": "button css",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<style>\n  * {\n      overflow: hidden;\n  }\n  .filled { \n      height: 70% !important;\n      width: 90% !important;\n      padding: 0 !important;\n      margin: 4% !important;\n  }\n  .nr-dashboard-template {\n      padding: 0;\n      margin: 0;\n  }\n  \n  .rounded {\n  border-radius: 12px 12px 12px 12px;\n}\n \n   .bigfont {\n  font-size: 18px;\n}\n\n   .smallfont {\n  font-size: 12px;\n}\n  \n</style>\n\n<script>\n$('.vibrate').on('click', function() {\n  navigator.vibrate(100);\n});\n\nfunction restore_bg(x) {\n            $(this).css(\"background-color\", x);\n    };\n\n$('.touched').on('mousedown', function() {\n    \n    var x= $(this).css(\"background-color\");\n    $(this).css(\"background-color\", \"yellow\");\n    \n    setTimeout(restore_bg.bind(this,x),100);\n    navigator.vibrate(80);\n    });\n    \n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 190,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "a87277605f306d49",
        "type": "ui_template",
        "z": "5d81d50e014fd538",
        "group": "d5323f44ca2adf10",
        "name": "power icon",
        "order": 3,
        "width": 1,
        "height": 1,
        "format": "<div style=\"display: flex; justify-content:center;align-items:center;height: auto; width: auto\">\n    <img id=\"battery\" style=\"height: auto; width: auto;display: none\" src=\"/half-battery.png\">\n    <img id=\"charging\" style=\"height: auto; width: auto;display: block\" src=\"/low-battery.png\">\n</div>\n\n<script>\n    (function($scope) {\n        $scope.$watch('msg', function() {\n            if (!$scope.msg) return;\n            const battery=$scope.msg.payload?.battery;\n            // console.log(battery);\n            if(battery){\n                $(\"#battery\").css(\"display\",battery?\"block\":\"none\");\n                $(\"#charging\").css(\"display\",battery?\"none\":\"block\");\n            }\n        });\n    })(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 370,
        "y": 1060,
        "wires": [[]]
    },
    {
        "id": "65dc4aeba2638535",
        "type": "inject",
        "z": "5d81d50e014fd538",
        "name": "normal",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":8,\"temperture\":30, \"battery\":1}",
        "payloadType": "json",
        "x": 680,
        "y": 240,
        "wires": [["1bcefb649c0c7372"]]
    },
    {
        "id": "005486673e970eb7",
        "type": "inject",
        "z": "5d81d50e014fd538",
        "name": "smoke",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":1,\"CO\":8,\"temperture\":30}",
        "payloadType": "json",
        "x": 670,
        "y": 280,
        "wires": [["1bcefb649c0c7372"]]
    },
    {
        "id": "fefac534eb4ecdc2",
        "type": "inject",
        "z": "5d81d50e014fd538",
        "name": "CO",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":30}",
        "payloadType": "json",
        "x": 670,
        "y": 320,
        "wires": [["1bcefb649c0c7372"]]
    },
    {
        "id": "30e996c65594cf24",
        "type": "inject",
        "z": "5d81d50e014fd538",
        "name": "fire",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":45}",
        "payloadType": "json",
        "x": 670,
        "y": 360,
        "wires": [["1bcefb649c0c7372"]]
    },
    {
        "id": "1bcefb649c0c7372",
        "type": "delay",
        "z": "5d81d50e014fd538",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 830,
        "y": 300,
        "wires": [["8bb1f3c98c9cf7b5"]]
    },
    {
        "id": "838f2d8bc711e907",
        "type": "link in",
        "z": "5d81d50e014fd538",
        "name": "all reset",
        "links": ["1765ee585273167c"],
        "x": 85,
        "y": 800,
        "wires": [["e2ca030976587723"]]
    },
    {
        "id": "09bf2fe2757421fd",
        "type": "link in",
        "z": "5d81d50e014fd538",
        "name": "reset",
        "links": ["1765ee585273167c"],
        "x": 575,
        "y": 400,
        "wires": [["87508b85f1b19074"]]
    },
    {
        "id": "87508b85f1b19074",
        "type": "function",
        "z": "5d81d50e014fd538",
        "name": "reset normal",
        "func": "msg.payload = { \"smoke\": 0, \"CO\": 8, \"temperture\": 30 }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 690,
        "y": 400,
        "wires": [["1bcefb649c0c7372"]]
    },
    {
        "id": "d183aef200a3e33a",
        "type": "ui_ui_control",
        "z": "5d81d50e014fd538",
        "name": "",
        "events": "all",
        "x": 60,
        "y": 840,
        "wires": [["4f222b7ac59e9d0f"]]
    },
    {
        "id": "4f222b7ac59e9d0f",
        "type": "function",
        "z": "5d81d50e014fd538",
        "name": "trigger when chage page",
        "func": "msg.topic = \"normal\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 250,
        "y": 840,
        "wires": [["e2ca030976587723"]]
    },
    {
        "id": "5a3981e30582596e",
        "type": "link in",
        "z": "5d81d50e014fd538",
        "name": "link in 5",
        "links": ["8bb1f3c98c9cf7b5"],
        "x": 235,
        "y": 1060,
        "wires": [["a87277605f306d49"]]
    },
    {
        "id": "d088de2d483ae2d7",
        "type": "comment",
        "z": "5d81d50e014fd538",
        "name": "改place",
        "info": "改place",
        "x": 843.3333129882812,
        "y": 881.3333740234375,
        "wires": []
    },
    {
        "id": "77699d5f79855220",
        "type": "comment",
        "z": "5d81d50e014fd538",
        "name": "改place",
        "info": "改place",
        "x": 502.33331298828125,
        "y": 707.3333129882812,
        "wires": []
    },
    {
        "id": "7ad5bc104875357a",
        "type": "random",
        "z": "af0d5e987f6889af",
        "name": "偵煙器",
        "low": "0",
        "high": "1",
        "inte": "true",
        "property": "payload",
        "x": 230,
        "y": 40,
        "wires": [["753f9118dc0e10df"]]
    },
    {
        "id": "f68dfacce9aa650b",
        "type": "random",
        "z": "af0d5e987f6889af",
        "name": "CO(ppm)",
        "low": "0",
        "high": 10,
        "inte": "false",
        "property": "payload",
        "x": 240,
        "y": 80,
        "wires": [["684ba30aa9ef9db3"]]
    },
    {
        "id": "3755587bedcb997b",
        "type": "random",
        "z": "af0d5e987f6889af",
        "name": "溫度",
        "low": "-10",
        "high": "50",
        "inte": "false",
        "property": "payload",
        "x": 230,
        "y": 120,
        "wires": [["816aa5d15c3238d4"]]
    },
    {
        "id": "1d777a58b27d011c",
        "type": "join",
        "z": "af0d5e987f6889af",
        "name": "",
        "mode": "custom",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "1",
        "count": "3",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 550,
        "y": 80,
        "wires": [["bba7b86cf77148da"]]
    },
    {
        "id": "f0697d9a6505bdb9",
        "type": "debug",
        "z": "af0d5e987f6889af",
        "name": "combine",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 400,
        "y": 220,
        "wires": []
    },
    {
        "id": "753f9118dc0e10df",
        "type": "change",
        "z": "af0d5e987f6889af",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "smoke",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 40,
        "wires": [["1d777a58b27d011c"]]
    },
    {
        "id": "684ba30aa9ef9db3",
        "type": "change",
        "z": "af0d5e987f6889af",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "CO",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 80,
        "wires": [["1d777a58b27d011c"]]
    },
    {
        "id": "816aa5d15c3238d4",
        "type": "change",
        "z": "af0d5e987f6889af",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperture",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 120,
        "wires": [["1d777a58b27d011c"]]
    },
    {
        "id": "eb290ed8f1801f70",
        "type": "inject",
        "z": "af0d5e987f6889af",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 70,
        "y": 80,
        "wires": [["7ad5bc104875357a", "f68dfacce9aa650b", "3755587bedcb997b"]]
    },
    {
        "id": "7b99a32970e2fa4d",
        "type": "link out",
        "z": "af0d5e987f6889af",
        "name": "link out 1",
        "mode": "link",
        "links": [
            "7858d84bdfdc915f",
            "4d29ac21dbc90d6d",
            "8df9143370e9b3d5",
            "98af167cbba97967",
            "037f8c248975eb6b"
        ],
        "x": 895,
        "y": 200,
        "wires": []
    },
    {
        "id": "7858d84bdfdc915f",
        "type": "link in",
        "z": "af0d5e987f6889af",
        "name": "link in 1",
        "links": ["7b99a32970e2fa4d"],
        "x": 255,
        "y": 440,
        "wires": [["73488849b76f9068"]]
    },
    {
        "id": "73488849b76f9068",
        "type": "function",
        "z": "af0d5e987f6889af",
        "name": "function 2",
        "func": "if(msg.payload.smoke===0){\n    msg.payload.color =\"#008000\"; //\"green\";\n}else{\n    msg.payload.color = \"#b22222\"; // \"firebrick\";\n}\nmsg.topic = \"e1@cx_color\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 440,
        "wires": [["db2d273998337aed"]]
    },
    {
        "id": "a2ea3ad7856c94f5",
        "type": "debug",
        "z": "af0d5e987f6889af",
        "name": "debug 9",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 440,
        "wires": []
    },
    {
        "id": "4d29ac21dbc90d6d",
        "type": "link in",
        "z": "af0d5e987f6889af",
        "name": "link in 2",
        "links": ["7b99a32970e2fa4d"],
        "x": 255,
        "y": 500,
        "wires": [["36dcfe8ba9e3e4c2"]]
    },
    {
        "id": "36dcfe8ba9e3e4c2",
        "type": "function",
        "z": "af0d5e987f6889af",
        "name": "溫度",
        "func": "msg.payload = msg.payload.temperture;\nmsg.topic = \"temperture\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 500,
        "wires": [["5901ec9d0eefd967"]]
    },
    {
        "id": "e42a943a494e600c",
        "type": "debug",
        "z": "af0d5e987f6889af",
        "name": "debug 10",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 500,
        "wires": []
    },
    {
        "id": "5901ec9d0eefd967",
        "type": "ui_chart",
        "z": "af0d5e987f6889af",
        "name": "",
        "group": "21b841d6128a5cde",
        "order": 4,
        "width": 11,
        "height": 5,
        "label": "溫度",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "-10",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 490,
        "y": 500,
        "wires": [["e42a943a494e600c"]]
    },
    {
        "id": "8df9143370e9b3d5",
        "type": "link in",
        "z": "af0d5e987f6889af",
        "name": "link in 3",
        "links": ["7b99a32970e2fa4d"],
        "x": 255,
        "y": 560,
        "wires": [["761fd54d5ad35f9b"]]
    },
    {
        "id": "761fd54d5ad35f9b",
        "type": "function",
        "z": "af0d5e987f6889af",
        "name": "CO",
        "func": "msg.payload = msg.payload.CO;\nmsg.topic = \"CO\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 560,
        "wires": [["0736e7552e2b4c84"]]
    },
    {
        "id": "c0e898b552de6e73",
        "type": "debug",
        "z": "af0d5e987f6889af",
        "name": "debug 11",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 560,
        "wires": []
    },
    {
        "id": "0736e7552e2b4c84",
        "type": "ui_chart",
        "z": "af0d5e987f6889af",
        "name": "",
        "group": "21b841d6128a5cde",
        "order": 7,
        "width": 14,
        "height": 4,
        "label": "CO(ppm)",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 500,
        "y": 560,
        "wires": [["c0e898b552de6e73"]]
    },
    {
        "id": "16a8a04a043e3c53",
        "type": "ui_text",
        "z": "af0d5e987f6889af",
        "group": "21b841d6128a5cde",
        "order": 5,
        "width": 3,
        "height": 2,
        "name": "",
        "label": "status",
        "format": "<font face='arial'><font size=6><font color={{msg.payload.color}}>{{msg.payload.message}}",
        "layout": "col-center",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 690,
        "y": 740,
        "wires": []
    },
    {
        "id": "98af167cbba97967",
        "type": "link in",
        "z": "af0d5e987f6889af",
        "name": "link in 4",
        "links": ["7b99a32970e2fa4d"],
        "x": 255,
        "y": 620,
        "wires": [["a61ce86ea04c6cf8"]]
    },
    {
        "id": "20526faa638c2978",
        "type": "mqtt in",
        "z": "af0d5e987f6889af",
        "name": "",
        "topic": "/BedroomC/condition",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "4f6c8a65bb8820c6",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 180,
        "y": 180,
        "wires": [["f0697d9a6505bdb9", "8a342fc3a7117891"]]
    },
    {
        "id": "8a342fc3a7117891",
        "type": "function",
        "z": "af0d5e987f6889af",
        "name": "convert data",
        "func": "let { ppm, temp, battery, smoke } = msg.payload;\n\nmsg.payload = { smoke: smoke ? smoke : 0, CO: ppm ? ppm : 0, temperture: temp ? temp : 20, battery: battery ? battery : 0 };\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 180,
        "wires": [["bba7b86cf77148da"]]
    },
    {
        "id": "b93fadc77952d8d7",
        "type": "link out",
        "z": "af0d5e987f6889af",
        "name": "living room status",
        "mode": "link",
        "links": ["c97ad871543274fa", "478292a4ebaca8d2"],
        "x": 655,
        "y": 700,
        "wires": []
    },
    {
        "id": "af0d8f3e328c6f05",
        "type": "finite-state-machine",
        "z": "af0d5e987f6889af",
        "name": "",
        "fsmDefinition": "{\"state\":{\"status\":\"Normal\",\"data\":{\"x\":5}},\"transitions\":{\"Normal\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Normal\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Fire\":{\"temperture\":\"Fire\",\"CO\":\"Fire\",\"smoke\":\"Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Fire\",\"expire\":\"Fire\",\"reset\":\"Normal\"},\"CO too High\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"CO too High\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Smoke Detected\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Smoke Detected\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Potential Fire\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Potential Fire\",\"expire\":\"Normal\",\"reset\":\"Normal\"}}}",
        "sendInitialState": true,
        "sendStateWithoutChange": true,
        "showTransitionErrors": true,
        "x": 310,
        "y": 740,
        "wires": [["fd7a5a977a76a645", "73f11e2e2680595b"]]
    },
    {
        "id": "a61ce86ea04c6cf8",
        "type": "function",
        "z": "af0d5e987f6889af",
        "name": "check transition to FSM",
        "func": "const TEMP_ERROR_LIMIT = 40; // in C\nconst CO_ERROR_LIMIT = 15; // in ppm\n\nconst { smoke, temperture, CO } = msg.payload;\nmsg.topic = \"\"\nmsg.data = {smoke, temperture, CO}\nmsg.control = {}\n\nif (temperture >= TEMP_ERROR_LIMIT) {\n    msg.topic += \"temperture\";\n}\nif (CO >= CO_ERROR_LIMIT) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"CO\";\n}\nif (smoke === 1) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"smoke\";\n} \nif (msg.topic===\"\"){\n    msg.topic = \"normal\";\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 620,
        "wires": [["af0d8f3e328c6f05", "d0b29e371c13e3e2"]]
    },
    {
        "id": "8e666431deb12ab7",
        "type": "debug",
        "z": "af0d5e987f6889af",
        "name": "state",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 820,
        "wires": []
    },
    {
        "id": "d0b29e371c13e3e2",
        "type": "debug",
        "z": "af0d5e987f6889af",
        "name": "trasition",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 780,
        "y": 620,
        "wires": []
    },
    {
        "id": "2a93915bfc69d5eb",
        "type": "inject",
        "z": "af0d5e987f6889af",
        "name": "reset",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "reset",
        "payload": "",
        "payloadType": "date",
        "x": 90,
        "y": 740,
        "wires": [["af0d8f3e328c6f05"]]
    },
    {
        "id": "fd7a5a977a76a645",
        "type": "function",
        "z": "af0d5e987f6889af",
        "name": "function 3",
        "func": "msg.state_color = {\n    \"Normal\": \"green\",\n    \"Fire\": \"red\",\n    \"CO too High\": \"orange\",\n    \"Smoke Detected\": \"orange\",\n    \"Potential Fire\": \"orange\"\n}\nmsg.payload = {\n    place: \"BedroomC\",\n    message: msg.payload.status,\n    color: msg.state_color[msg.payload.status]\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 740,
        "wires": [
            [
                "8e666431deb12ab7",
                "16a8a04a043e3c53",
                "b93fadc77952d8d7",
                "a3aa22db2869ccfa"
            ]
        ]
    },
    {
        "id": "73f11e2e2680595b",
        "type": "debug",
        "z": "af0d5e987f6889af",
        "name": "debug 14",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 460,
        "y": 820,
        "wires": []
    },
    {
        "id": "efc8ca774ea23f6c",
        "type": "line-notify",
        "z": "af0d5e987f6889af",
        "d": true,
        "name": "test YCK",
        "message": "",
        "contentType": "message",
        "imageThumbnail": "",
        "imageUrl": "",
        "sticker": "default",
        "stickerPackageId": "1",
        "stickerId": "1",
        "silent": false,
        "creds": "63115de6b1972cd9",
        "x": 980,
        "y": 920,
        "wires": [[]]
    },
    {
        "id": "acc02e34f94b4da1",
        "type": "inject",
        "z": "af0d5e987f6889af",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 270,
        "y": 920,
        "wires": [["a3aa22db2869ccfa"]]
    },
    {
        "id": "a3aa22db2869ccfa",
        "type": "rbe",
        "z": "af0d5e987f6889af",
        "name": "block the same value",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": true,
        "property": "payload",
        "topi": "topic",
        "x": 600,
        "y": 920,
        "wires": [["2767764dad01b9e7"]]
    },
    {
        "id": "2767764dad01b9e7",
        "type": "function",
        "z": "af0d5e987f6889af",
        "name": "modify message",
        "func": "const place = \"Bedroom C\"\nif (msg.payload.message==\"Normal\"){\n    return;\n}\nmsg.payload = \"\\n注意！\\n\" + place + \": \" + msg.payload.message\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 920,
        "wires": [["efc8ca774ea23f6c"]]
    },
    {
        "id": "df7a6c147a06a943",
        "type": "ui_ui_control",
        "z": "af0d5e987f6889af",
        "name": "navigation",
        "events": "all",
        "x": 530,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "fbc5cd55b8c6c191",
        "type": "ui_template",
        "z": "af0d5e987f6889af",
        "group": "21b841d6128a5cde",
        "name": "Back Home",
        "order": 2,
        "width": 2,
        "height": 1,
        "format": "<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#e67e22\"\n    ng-click=\"send({payload: 'Home'})\">\n    Back\n</md-button>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 370,
        "y": 1020,
        "wires": [["df7a6c147a06a943"]]
    },
    {
        "id": "db8b19a7b839595c",
        "type": "ui_template",
        "z": "af0d5e987f6889af",
        "group": "21b841d6128a5cde",
        "name": "button css",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<style>\n  * {\n      overflow: hidden;\n  }\n  .filled { \n      height: 90% !important;\n      width: 90% !important;\n      padding: 0 !important;\n      margin: 4% !important;\n  }\n  .nr-dashboard-template {\n      padding: 0;\n      margin: 0;\n  }\n  \n  .rounded {\n  border-radius: 12px 12px 12px 12px;\n}\n \n   .bigfont {\n  font-size: 18px;\n}\n\n   .smallfont {\n  font-size: 12px;\n}\n  \n</style>\n\n<script>\n$('.vibrate').on('click', function() {\n  navigator.vibrate(100);\n});\n\nfunction restore_bg(x) {\n            $(this).css(\"background-color\", x);\n    };\n\n$('.touched').on('mousedown', function() {\n    \n    var x= $(this).css(\"background-color\");\n    $(this).css(\"background-color\", \"yellow\");\n    \n    setTimeout(restore_bg.bind(this,x),100);\n    navigator.vibrate(80);\n    });\n    \n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 190,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "65e2cc1548d1ab4c",
        "type": "inject",
        "z": "af0d5e987f6889af",
        "name": "normal",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":8,\"temperture\":30,\"battery\":0}",
        "payloadType": "json",
        "x": 200,
        "y": 220,
        "wires": [["cce8d3b7881aa299"]]
    },
    {
        "id": "7432aea310057731",
        "type": "inject",
        "z": "af0d5e987f6889af",
        "name": "smoke",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":1,\"CO\":8,\"temperture\":30}",
        "payloadType": "json",
        "x": 190,
        "y": 260,
        "wires": [["cce8d3b7881aa299"]]
    },
    {
        "id": "ee29ebe750dffd17",
        "type": "inject",
        "z": "af0d5e987f6889af",
        "name": "CO",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":30}",
        "payloadType": "json",
        "x": 190,
        "y": 300,
        "wires": [["cce8d3b7881aa299"]]
    },
    {
        "id": "28b693a0ca6054e4",
        "type": "inject",
        "z": "af0d5e987f6889af",
        "name": "fire",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":45}",
        "payloadType": "json",
        "x": 190,
        "y": 340,
        "wires": [["cce8d3b7881aa299"]]
    },
    {
        "id": "cce8d3b7881aa299",
        "type": "delay",
        "z": "af0d5e987f6889af",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 410,
        "y": 280,
        "wires": [["bba7b86cf77148da"]]
    },
    {
        "id": "41c65adcf5b36f54",
        "type": "link in",
        "z": "af0d5e987f6889af",
        "name": "all reset",
        "links": ["1765ee585273167c"],
        "x": 135,
        "y": 800,
        "wires": [["af0d8f3e328c6f05"]]
    },
    {
        "id": "2c123558123655a5",
        "type": "link in",
        "z": "af0d5e987f6889af",
        "name": "reset",
        "links": ["1765ee585273167c"],
        "x": 95,
        "y": 380,
        "wires": [["e8d3a23705c05537"]]
    },
    {
        "id": "e8d3a23705c05537",
        "type": "function",
        "z": "af0d5e987f6889af",
        "name": "reset normal",
        "func": "msg.payload = { \"smoke\": 0, \"CO\": 8, \"temperture\": 30 }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 210,
        "y": 380,
        "wires": [["cce8d3b7881aa299"]]
    },
    {
        "id": "9e1bca95fedffc32",
        "type": "ui_ui_control",
        "z": "af0d5e987f6889af",
        "name": "",
        "events": "all",
        "x": 80,
        "y": 840,
        "wires": [["e614961f7dc411ad"]]
    },
    {
        "id": "e614961f7dc411ad",
        "type": "function",
        "z": "af0d5e987f6889af",
        "name": "trigger when chage page",
        "func": "msg.topic = \"normal\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 270,
        "y": 840,
        "wires": [["af0d8f3e328c6f05"]]
    },
    {
        "id": "db2d273998337aed",
        "type": "ui_template",
        "z": "af0d5e987f6889af",
        "group": "21b841d6128a5cde",
        "name": "煙霧顯示",
        "order": 6,
        "width": 3,
        "height": 2,
        "format": "<div id=\"graphics\" ng-init=\"checkSVG()\" style=\"display: flex; justify-content:center;align-items:center\">\n    <p id=\"e1_text\">煙霧</p>\n    <svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0\" y=\"0\" height=\"34\"\n        viewBox=\"0 0 34 34\" width=\"34\" preserveAspectRatio=\"xMidYMid meet\">\n        <circle id=\"e1_circle\" cx=\"17\" cy=\"17\" style=\"fill:green;stroke-width:0px;overflow:hidden\" r=\"16\" />\n    </svg>\n    <script>\n        (function($scope) {\n                $scope.$watch('msg', function() {\n                    if (!$scope.msg) return;\n                    const color=$scope.msg.payload?.color;\n                    const topic=$scope.msg.topic;\n                    if (color === undefined || color === null ||\n                        !topic || typeof topic !== 'string' || !topic.includes('@')) return;\n                    const id = topic.split('@')[0], cxType = topic.split('@')[1];\n                    document.getElementById(id+\"_circle\").style.fill=color;\n                    document.getElementById(id+\"_text\").style.cssText = `color:${color} !important;font-weight:bold` ;\n                });\n            })(scope);\n    </script>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 500,
        "y": 440,
        "wires": [["a2ea3ad7856c94f5"]]
    },
    {
        "id": "433fa8bc3b49b867",
        "type": "ui_template",
        "z": "af0d5e987f6889af",
        "group": "21b841d6128a5cde",
        "name": "power icon",
        "order": 3,
        "width": 1,
        "height": 1,
        "format": "<div style=\"display: flex; justify-content:center;align-items:center;height: auto; width: auto\">\n    <img id=\"battery\" style=\"height: auto; width: auto;display: none\" src=\"/half-battery.png\">\n    <img id=\"charging\" style=\"height: auto; width: auto;display: block\" src=\"/low-battery.png\">\n</div>\n\n<script>\n    (function($scope) {\n        $scope.$watch('msg', function() {\n            if (!$scope.msg) return;\n            const battery=$scope.msg.payload?.battery;\n            // console.log(battery);\n            if(battery){\n                $(\"#battery\").css(\"display\",battery?\"block\":\"none\");\n                $(\"#charging\").css(\"display\",battery?\"none\":\"block\");\n            }\n        });\n    })(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 510,
        "y": 400,
        "wires": [[]]
    },
    {
        "id": "037f8c248975eb6b",
        "type": "link in",
        "z": "af0d5e987f6889af",
        "name": "link in 7",
        "links": ["7b99a32970e2fa4d"],
        "x": 365,
        "y": 400,
        "wires": [["433fa8bc3b49b867"]]
    },
    {
        "id": "bba7b86cf77148da",
        "type": "function",
        "z": "af0d5e987f6889af",
        "name": "add node information",
        "func": "msg.payload.place = \"BedroomC\";\nmsg.payload.time = Date.now();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 740,
        "y": 200,
        "wires": [["7b99a32970e2fa4d"]]
    },
    {
        "id": "9535ecc6f83fae33",
        "type": "comment",
        "z": "af0d5e987f6889af",
        "name": "改place",
        "info": "改place",
        "x": 510,
        "y": 700,
        "wires": []
    },
    {
        "id": "e738756a9240fb1f",
        "type": "comment",
        "z": "af0d5e987f6889af",
        "name": "改place",
        "info": "改place",
        "x": 748.3333129882812,
        "y": 166.3333282470703,
        "wires": []
    },
    {
        "id": "6076128642989264",
        "type": "comment",
        "z": "af0d5e987f6889af",
        "name": "改place",
        "info": "改place",
        "x": 97.33332824707031,
        "y": 146.3333282470703,
        "wires": []
    },
    {
        "id": "e854d7920896e190",
        "type": "comment",
        "z": "af0d5e987f6889af",
        "name": "改place",
        "info": "改place",
        "x": 842.3333129882812,
        "y": 885.3333740234375,
        "wires": []
    },
    {
        "id": "b0534d0c4f06747d",
        "type": "comment",
        "z": "af0d5e987f6889af",
        "name": "改group",
        "info": "",
        "x": 390,
        "y": 980,
        "wires": []
    },
    {
        "id": "e8856177f515b6a9",
        "type": "comment",
        "z": "af0d5e987f6889af",
        "name": "改group",
        "info": "",
        "x": 750,
        "y": 700,
        "wires": []
    },
    {
        "id": "8d1c9103cc67305f",
        "type": "comment",
        "z": "af0d5e987f6889af",
        "name": "改group",
        "info": "",
        "x": 530,
        "y": 360,
        "wires": []
    },
    {
        "id": "99803077aa07498e",
        "type": "random",
        "z": "c4f86fdc5e8c2f1f",
        "name": "偵煙器",
        "low": "0",
        "high": "1",
        "inte": "true",
        "property": "payload",
        "x": 230,
        "y": 40,
        "wires": [["cea5b92382155a06"]]
    },
    {
        "id": "42aa455d82ce05cd",
        "type": "random",
        "z": "c4f86fdc5e8c2f1f",
        "name": "CO(ppm)",
        "low": "0",
        "high": 10,
        "inte": "false",
        "property": "payload",
        "x": 240,
        "y": 80,
        "wires": [["db8107014a51e46d"]]
    },
    {
        "id": "4550d3e26ca928fc",
        "type": "random",
        "z": "c4f86fdc5e8c2f1f",
        "name": "溫度",
        "low": "-10",
        "high": "50",
        "inte": "false",
        "property": "payload",
        "x": 230,
        "y": 120,
        "wires": [["97bb45ae9583c877"]]
    },
    {
        "id": "63b21d3e1083f199",
        "type": "join",
        "z": "c4f86fdc5e8c2f1f",
        "name": "",
        "mode": "custom",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "1",
        "count": "3",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 550,
        "y": 80,
        "wires": [["636ed230f10922a2"]]
    },
    {
        "id": "7409f591a9c73fce",
        "type": "debug",
        "z": "c4f86fdc5e8c2f1f",
        "name": "combine",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 400,
        "y": 220,
        "wires": []
    },
    {
        "id": "cea5b92382155a06",
        "type": "change",
        "z": "c4f86fdc5e8c2f1f",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "smoke",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 40,
        "wires": [["63b21d3e1083f199"]]
    },
    {
        "id": "db8107014a51e46d",
        "type": "change",
        "z": "c4f86fdc5e8c2f1f",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "CO",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 80,
        "wires": [["63b21d3e1083f199"]]
    },
    {
        "id": "97bb45ae9583c877",
        "type": "change",
        "z": "c4f86fdc5e8c2f1f",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperture",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 120,
        "wires": [["63b21d3e1083f199"]]
    },
    {
        "id": "3a8386cfd0ec0db3",
        "type": "inject",
        "z": "c4f86fdc5e8c2f1f",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 70,
        "y": 80,
        "wires": [["99803077aa07498e", "42aa455d82ce05cd", "4550d3e26ca928fc"]]
    },
    {
        "id": "7d9c0a9f82b9d46d",
        "type": "link out",
        "z": "c4f86fdc5e8c2f1f",
        "name": "link out 1",
        "mode": "link",
        "links": [
            "136d964cc3ef0e7d",
            "70d67f90147713cb",
            "9ba2453a541d042a",
            "7c4f311282cd565a",
            "57aeb515404ebd88"
        ],
        "x": 895,
        "y": 200,
        "wires": []
    },
    {
        "id": "136d964cc3ef0e7d",
        "type": "link in",
        "z": "c4f86fdc5e8c2f1f",
        "name": "link in 1",
        "links": ["7d9c0a9f82b9d46d"],
        "x": 255,
        "y": 440,
        "wires": [["eda3095941d4414d"]]
    },
    {
        "id": "eda3095941d4414d",
        "type": "function",
        "z": "c4f86fdc5e8c2f1f",
        "name": "function 2",
        "func": "if(msg.payload.smoke===0){\n    msg.payload.color =\"#008000\"; //\"green\";\n}else{\n    msg.payload.color = \"#b22222\"; // \"firebrick\";\n}\nmsg.topic = \"e1@cx_color\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 440,
        "wires": [["21999be9f6d1c555"]]
    },
    {
        "id": "8abba1f061ced1bf",
        "type": "debug",
        "z": "c4f86fdc5e8c2f1f",
        "name": "debug 9",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 440,
        "wires": []
    },
    {
        "id": "70d67f90147713cb",
        "type": "link in",
        "z": "c4f86fdc5e8c2f1f",
        "name": "link in 2",
        "links": ["7d9c0a9f82b9d46d"],
        "x": 255,
        "y": 500,
        "wires": [["ae6c0829c5de365b"]]
    },
    {
        "id": "ae6c0829c5de365b",
        "type": "function",
        "z": "c4f86fdc5e8c2f1f",
        "name": "溫度",
        "func": "msg.payload = msg.payload.temperture;\nmsg.topic = \"temperture\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 500,
        "wires": [["a9ac5caec60660fe"]]
    },
    {
        "id": "f6226a10bbb678f0",
        "type": "debug",
        "z": "c4f86fdc5e8c2f1f",
        "name": "debug 10",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 500,
        "wires": []
    },
    {
        "id": "a9ac5caec60660fe",
        "type": "ui_chart",
        "z": "c4f86fdc5e8c2f1f",
        "name": "",
        "group": "dc87ea581ec639fa",
        "order": 4,
        "width": 11,
        "height": 5,
        "label": "溫度",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "-10",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 490,
        "y": 500,
        "wires": [["f6226a10bbb678f0"]]
    },
    {
        "id": "9ba2453a541d042a",
        "type": "link in",
        "z": "c4f86fdc5e8c2f1f",
        "name": "link in 3",
        "links": ["7d9c0a9f82b9d46d"],
        "x": 255,
        "y": 560,
        "wires": [["127905d73e6a68a2"]]
    },
    {
        "id": "127905d73e6a68a2",
        "type": "function",
        "z": "c4f86fdc5e8c2f1f",
        "name": "CO",
        "func": "msg.payload = msg.payload.CO;\nmsg.topic = \"CO\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 560,
        "wires": [["265c7aa21f7460a2"]]
    },
    {
        "id": "d2ae18c4204c306f",
        "type": "debug",
        "z": "c4f86fdc5e8c2f1f",
        "name": "debug 11",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 560,
        "wires": []
    },
    {
        "id": "265c7aa21f7460a2",
        "type": "ui_chart",
        "z": "c4f86fdc5e8c2f1f",
        "name": "",
        "group": "dc87ea581ec639fa",
        "order": 7,
        "width": 14,
        "height": 4,
        "label": "CO(ppm)",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 500,
        "y": 560,
        "wires": [["d2ae18c4204c306f"]]
    },
    {
        "id": "873b6e7bc80ac25b",
        "type": "ui_text",
        "z": "c4f86fdc5e8c2f1f",
        "group": "dc87ea581ec639fa",
        "order": 5,
        "width": 3,
        "height": 2,
        "name": "",
        "label": "status",
        "format": "<font face='arial'><font size=6><font color={{msg.payload.color}}>{{msg.payload.message}}",
        "layout": "col-center",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 690,
        "y": 740,
        "wires": []
    },
    {
        "id": "7c4f311282cd565a",
        "type": "link in",
        "z": "c4f86fdc5e8c2f1f",
        "name": "link in 4",
        "links": ["7d9c0a9f82b9d46d"],
        "x": 255,
        "y": 620,
        "wires": [["946929da7e416a99"]]
    },
    {
        "id": "b39168ad34b26f0d",
        "type": "mqtt in",
        "z": "c4f86fdc5e8c2f1f",
        "name": "",
        "topic": "/entryA/condition",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "4f6c8a65bb8820c6",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 160,
        "y": 180,
        "wires": [["7409f591a9c73fce", "7620791a5eb0aa92"]]
    },
    {
        "id": "7620791a5eb0aa92",
        "type": "function",
        "z": "c4f86fdc5e8c2f1f",
        "name": "convert data",
        "func": "let { ppm, temp, battery, smoke } = msg.payload;\n\nmsg.payload = { smoke: smoke ? smoke : 0, CO: ppm ? ppm : 0, temperture: temp ? temp : 20, battery: battery ? battery : 0 };\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 180,
        "wires": [["636ed230f10922a2"]]
    },
    {
        "id": "1680a261e87d6703",
        "type": "link out",
        "z": "c4f86fdc5e8c2f1f",
        "name": "living room status",
        "mode": "link",
        "links": ["c97ad871543274fa", "478292a4ebaca8d2"],
        "x": 655,
        "y": 700,
        "wires": []
    },
    {
        "id": "ed235f997cdd3879",
        "type": "finite-state-machine",
        "z": "c4f86fdc5e8c2f1f",
        "name": "",
        "fsmDefinition": "{\"state\":{\"status\":\"Normal\",\"data\":{\"x\":5}},\"transitions\":{\"Normal\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Normal\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Fire\":{\"temperture\":\"Fire\",\"CO\":\"Fire\",\"smoke\":\"Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Fire\",\"expire\":\"Fire\",\"reset\":\"Normal\"},\"CO too High\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"CO too High\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Smoke Detected\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Smoke Detected\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Potential Fire\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Potential Fire\",\"expire\":\"Normal\",\"reset\":\"Normal\"}}}",
        "sendInitialState": true,
        "sendStateWithoutChange": true,
        "showTransitionErrors": true,
        "x": 310,
        "y": 740,
        "wires": [["3a4a0c5b142f19bd", "3c7ccb8b68191945"]]
    },
    {
        "id": "946929da7e416a99",
        "type": "function",
        "z": "c4f86fdc5e8c2f1f",
        "name": "check transition to FSM",
        "func": "const TEMP_ERROR_LIMIT = 40; // in C\nconst CO_ERROR_LIMIT = 15; // in ppm\n\nconst { smoke, temperture, CO } = msg.payload;\nmsg.topic = \"\"\nmsg.data = {smoke, temperture, CO}\nmsg.control = {}\n\nif (temperture >= TEMP_ERROR_LIMIT) {\n    msg.topic += \"temperture\";\n}\nif (CO >= CO_ERROR_LIMIT) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"CO\";\n}\nif (smoke === 1) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"smoke\";\n} \nif (msg.topic===\"\"){\n    msg.topic = \"normal\";\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 620,
        "wires": [["ed235f997cdd3879", "0b8387db623558c7"]]
    },
    {
        "id": "a2fc9c6997f136b9",
        "type": "debug",
        "z": "c4f86fdc5e8c2f1f",
        "name": "state",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 820,
        "wires": []
    },
    {
        "id": "0b8387db623558c7",
        "type": "debug",
        "z": "c4f86fdc5e8c2f1f",
        "name": "trasition",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 780,
        "y": 620,
        "wires": []
    },
    {
        "id": "1859c7d50fa5cfd6",
        "type": "inject",
        "z": "c4f86fdc5e8c2f1f",
        "name": "reset",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "reset",
        "payload": "",
        "payloadType": "date",
        "x": 90,
        "y": 740,
        "wires": [["ed235f997cdd3879"]]
    },
    {
        "id": "3a4a0c5b142f19bd",
        "type": "function",
        "z": "c4f86fdc5e8c2f1f",
        "name": "function 3",
        "func": "msg.state_color = {\n    \"Normal\": \"green\",\n    \"Fire\": \"red\",\n    \"CO too High\": \"orange\",\n    \"Smoke Detected\": \"orange\",\n    \"Potential Fire\": \"orange\"\n}\nmsg.payload = {\n    place: \"entryA\",\n    message: msg.payload.status,\n    color: msg.state_color[msg.payload.status]\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 740,
        "wires": [
            [
                "a2fc9c6997f136b9",
                "873b6e7bc80ac25b",
                "1680a261e87d6703",
                "5f78dea116749154"
            ]
        ]
    },
    {
        "id": "3c7ccb8b68191945",
        "type": "debug",
        "z": "c4f86fdc5e8c2f1f",
        "name": "debug 14",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 460,
        "y": 820,
        "wires": []
    },
    {
        "id": "c94ad424cc09c097",
        "type": "line-notify",
        "z": "c4f86fdc5e8c2f1f",
        "d": true,
        "name": "test YCK",
        "message": "",
        "contentType": "message",
        "imageThumbnail": "",
        "imageUrl": "",
        "sticker": "default",
        "stickerPackageId": "1",
        "stickerId": "1",
        "silent": false,
        "creds": "63115de6b1972cd9",
        "x": 980,
        "y": 920,
        "wires": [[]]
    },
    {
        "id": "b32db8fb39d8378a",
        "type": "inject",
        "z": "c4f86fdc5e8c2f1f",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 270,
        "y": 920,
        "wires": [["5f78dea116749154"]]
    },
    {
        "id": "5f78dea116749154",
        "type": "rbe",
        "z": "c4f86fdc5e8c2f1f",
        "name": "block the same value",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": true,
        "property": "payload",
        "topi": "topic",
        "x": 600,
        "y": 920,
        "wires": [["bd6f5a79e878f6f1"]]
    },
    {
        "id": "bd6f5a79e878f6f1",
        "type": "function",
        "z": "c4f86fdc5e8c2f1f",
        "name": "modify message",
        "func": "const place = \"entry A\"\nif (msg.payload.message==\"Normal\"){\n    return;\n}\nmsg.payload = \"\\n注意！\\n\" + place + \": \" + msg.payload.message\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 920,
        "wires": [["c94ad424cc09c097"]]
    },
    {
        "id": "a2a506dc5fc09f9d",
        "type": "ui_ui_control",
        "z": "c4f86fdc5e8c2f1f",
        "name": "navigation",
        "events": "all",
        "x": 530,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "dc342354a490dc6b",
        "type": "ui_template",
        "z": "c4f86fdc5e8c2f1f",
        "group": "dc87ea581ec639fa",
        "name": "Back Home",
        "order": 2,
        "width": 2,
        "height": 1,
        "format": "<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#e67e22\"\n    ng-click=\"send({payload: 'Home'})\">\n    Back\n</md-button>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 370,
        "y": 1020,
        "wires": [["a2a506dc5fc09f9d"]]
    },
    {
        "id": "14f1b971d66fbb10",
        "type": "ui_template",
        "z": "c4f86fdc5e8c2f1f",
        "group": "dc87ea581ec639fa",
        "name": "button css",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<style>\n  * {\n      overflow: hidden;\n  }\n  .filled { \n      height: 90% !important;\n      width: 90% !important;\n      padding: 0 !important;\n      margin: 4% !important;\n  }\n  .nr-dashboard-template {\n      padding: 0;\n      margin: 0;\n  }\n  \n  .rounded {\n  border-radius: 12px 12px 12px 12px;\n}\n \n   .bigfont {\n  font-size: 18px;\n}\n\n   .smallfont {\n  font-size: 12px;\n}\n  \n</style>\n\n<script>\n$('.vibrate').on('click', function() {\n  navigator.vibrate(100);\n});\n\nfunction restore_bg(x) {\n            $(this).css(\"background-color\", x);\n    };\n\n$('.touched').on('mousedown', function() {\n    \n    var x= $(this).css(\"background-color\");\n    $(this).css(\"background-color\", \"yellow\");\n    \n    setTimeout(restore_bg.bind(this,x),100);\n    navigator.vibrate(80);\n    });\n    \n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "global",
        "className": "",
        "x": 190,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "4722bd65b8dacb09",
        "type": "inject",
        "z": "c4f86fdc5e8c2f1f",
        "name": "normal",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":8,\"temperture\":30,\"battery\":0}",
        "payloadType": "json",
        "x": 200,
        "y": 220,
        "wires": [["b00e51772f30698e"]]
    },
    {
        "id": "3f2d5e81f92d42bb",
        "type": "inject",
        "z": "c4f86fdc5e8c2f1f",
        "name": "smoke",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":1,\"CO\":8,\"temperture\":30}",
        "payloadType": "json",
        "x": 190,
        "y": 260,
        "wires": [["b00e51772f30698e"]]
    },
    {
        "id": "30b8ba957fb1d326",
        "type": "inject",
        "z": "c4f86fdc5e8c2f1f",
        "name": "CO",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":30}",
        "payloadType": "json",
        "x": 190,
        "y": 300,
        "wires": [["b00e51772f30698e"]]
    },
    {
        "id": "f1dc2a3a1c828ccb",
        "type": "inject",
        "z": "c4f86fdc5e8c2f1f",
        "name": "fire",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":45}",
        "payloadType": "json",
        "x": 190,
        "y": 340,
        "wires": [["b00e51772f30698e"]]
    },
    {
        "id": "b00e51772f30698e",
        "type": "delay",
        "z": "c4f86fdc5e8c2f1f",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 410,
        "y": 280,
        "wires": [["636ed230f10922a2"]]
    },
    {
        "id": "248cc873c74358be",
        "type": "link in",
        "z": "c4f86fdc5e8c2f1f",
        "name": "all reset",
        "links": ["1765ee585273167c"],
        "x": 135,
        "y": 800,
        "wires": [["ed235f997cdd3879"]]
    },
    {
        "id": "9f538090f79fc5b0",
        "type": "link in",
        "z": "c4f86fdc5e8c2f1f",
        "name": "reset",
        "links": ["1765ee585273167c"],
        "x": 95,
        "y": 380,
        "wires": [["744f50089607e97c"]]
    },
    {
        "id": "744f50089607e97c",
        "type": "function",
        "z": "c4f86fdc5e8c2f1f",
        "name": "reset normal",
        "func": "msg.payload = { \"smoke\": 0, \"CO\": 8, \"temperture\": 30 }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 210,
        "y": 380,
        "wires": [["b00e51772f30698e"]]
    },
    {
        "id": "67cc6e3904a0776f",
        "type": "ui_ui_control",
        "z": "c4f86fdc5e8c2f1f",
        "name": "",
        "events": "all",
        "x": 80,
        "y": 840,
        "wires": [["7629735c9aaea2a7"]]
    },
    {
        "id": "7629735c9aaea2a7",
        "type": "function",
        "z": "c4f86fdc5e8c2f1f",
        "name": "trigger when chage page",
        "func": "msg.topic = \"normal\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 270,
        "y": 840,
        "wires": [["ed235f997cdd3879"]]
    },
    {
        "id": "21999be9f6d1c555",
        "type": "ui_template",
        "z": "c4f86fdc5e8c2f1f",
        "group": "dc87ea581ec639fa",
        "name": "煙霧顯示",
        "order": 6,
        "width": 3,
        "height": 2,
        "format": "<div id=\"graphics\" ng-init=\"checkSVG()\" style=\"display: flex; justify-content:center;align-items:center\">\n    <p id=\"e1_text\">煙霧</p>\n    <svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0\" y=\"0\" height=\"34\"\n        viewBox=\"0 0 34 34\" width=\"34\" preserveAspectRatio=\"xMidYMid meet\">\n        <circle id=\"e1_circle\" cx=\"17\" cy=\"17\" style=\"fill:green;stroke-width:0px;overflow:hidden\" r=\"16\" />\n    </svg>\n    <script>\n        (function($scope) {\n                $scope.$watch('msg', function() {\n                    if (!$scope.msg) return;\n                    const color=$scope.msg.payload?.color;\n                    const topic=$scope.msg.topic;\n                    if (color === undefined || color === null ||\n                        !topic || typeof topic !== 'string' || !topic.includes('@')) return;\n                    const id = topic.split('@')[0], cxType = topic.split('@')[1];\n                    document.getElementById(id+\"_circle\").style.fill=color;\n                    document.getElementById(id+\"_text\").style.cssText = `color:${color} !important;font-weight:bold` ;\n                });\n            })(scope);\n    </script>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 500,
        "y": 440,
        "wires": [["8abba1f061ced1bf"]]
    },
    {
        "id": "e2279ec8abe35395",
        "type": "ui_template",
        "z": "c4f86fdc5e8c2f1f",
        "group": "dc87ea581ec639fa",
        "name": "power icon",
        "order": 3,
        "width": 1,
        "height": 1,
        "format": "<div style=\"display: flex; justify-content:center;align-items:center;height: auto; width: auto\">\n    <img id=\"battery\" style=\"height: auto; width: auto;display: none\" src=\"/half-battery.png\">\n    <img id=\"charging\" style=\"height: auto; width: auto;display: block\" src=\"/low-battery.png\">\n</div>\n\n<script>\n    (function($scope) {\n        $scope.$watch('msg', function() {\n            if (!$scope.msg) return;\n            const battery=$scope.msg.payload?.battery;\n            // console.log(battery);\n            if(battery){\n                $(\"#battery\").css(\"display\",battery?\"block\":\"none\");\n                $(\"#charging\").css(\"display\",battery?\"none\":\"block\");\n            }\n        });\n    })(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 510,
        "y": 400,
        "wires": [[]]
    },
    {
        "id": "57aeb515404ebd88",
        "type": "link in",
        "z": "c4f86fdc5e8c2f1f",
        "name": "link in 7",
        "links": ["7d9c0a9f82b9d46d"],
        "x": 365,
        "y": 400,
        "wires": [["e2279ec8abe35395"]]
    },
    {
        "id": "636ed230f10922a2",
        "type": "function",
        "z": "c4f86fdc5e8c2f1f",
        "name": "add node information",
        "func": "msg.payload.place = \"entryA\";\nmsg.payload.time = Date.now();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 740,
        "y": 200,
        "wires": [["7d9c0a9f82b9d46d"]]
    },
    {
        "id": "49bd899931024a02",
        "type": "comment",
        "z": "c4f86fdc5e8c2f1f",
        "name": "改place",
        "info": "改place",
        "x": 510,
        "y": 700,
        "wires": []
    },
    {
        "id": "78d1a4c779dcec15",
        "type": "comment",
        "z": "c4f86fdc5e8c2f1f",
        "name": "改place",
        "info": "改place",
        "x": 748.3333129882812,
        "y": 166.3333282470703,
        "wires": []
    },
    {
        "id": "591c95db981965f2",
        "type": "comment",
        "z": "c4f86fdc5e8c2f1f",
        "name": "改place",
        "info": "改place",
        "x": 97.33332824707031,
        "y": 146.3333282470703,
        "wires": []
    },
    {
        "id": "530b2aeb823488c3",
        "type": "comment",
        "z": "c4f86fdc5e8c2f1f",
        "name": "改place",
        "info": "改place",
        "x": 842.3333129882812,
        "y": 885.3333740234375,
        "wires": []
    },
    {
        "id": "bcd09c8f389c0524",
        "type": "comment",
        "z": "c4f86fdc5e8c2f1f",
        "name": "改group",
        "info": "",
        "x": 390,
        "y": 980,
        "wires": []
    },
    {
        "id": "ed0480a9440fb007",
        "type": "comment",
        "z": "c4f86fdc5e8c2f1f",
        "name": "改group",
        "info": "",
        "x": 750,
        "y": 700,
        "wires": []
    },
    {
        "id": "2cbb46d7639f30da",
        "type": "comment",
        "z": "c4f86fdc5e8c2f1f",
        "name": "改group",
        "info": "",
        "x": 530,
        "y": 360,
        "wires": []
    },
    {
        "id": "5372e888d81e06e9",
        "type": "random",
        "z": "05895f55507a8cbc",
        "name": "偵煙器",
        "low": "0",
        "high": "1",
        "inte": "true",
        "property": "payload",
        "x": 230,
        "y": 40,
        "wires": [["ecdeb2ae7a170627"]]
    },
    {
        "id": "26576498416c79f6",
        "type": "random",
        "z": "05895f55507a8cbc",
        "name": "CO(ppm)",
        "low": "0",
        "high": 10,
        "inte": "false",
        "property": "payload",
        "x": 240,
        "y": 80,
        "wires": [["d6f9088a2b7f4057"]]
    },
    {
        "id": "bfa163a5b6f6a354",
        "type": "random",
        "z": "05895f55507a8cbc",
        "name": "溫度",
        "low": "-10",
        "high": "50",
        "inte": "false",
        "property": "payload",
        "x": 230,
        "y": 120,
        "wires": [["244bfec608b1e032"]]
    },
    {
        "id": "1ac85e107d31c142",
        "type": "join",
        "z": "05895f55507a8cbc",
        "name": "",
        "mode": "custom",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "1",
        "count": "3",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 550,
        "y": 80,
        "wires": [["1c1f8c81f6fbf610"]]
    },
    {
        "id": "e8725f7b0bb0dfd8",
        "type": "debug",
        "z": "05895f55507a8cbc",
        "name": "combine",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 400,
        "y": 220,
        "wires": []
    },
    {
        "id": "ecdeb2ae7a170627",
        "type": "change",
        "z": "05895f55507a8cbc",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "smoke",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 40,
        "wires": [["1ac85e107d31c142"]]
    },
    {
        "id": "d6f9088a2b7f4057",
        "type": "change",
        "z": "05895f55507a8cbc",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "CO",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 80,
        "wires": [["1ac85e107d31c142"]]
    },
    {
        "id": "244bfec608b1e032",
        "type": "change",
        "z": "05895f55507a8cbc",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperture",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 120,
        "wires": [["1ac85e107d31c142"]]
    },
    {
        "id": "62fb621d8628237c",
        "type": "inject",
        "z": "05895f55507a8cbc",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 70,
        "y": 80,
        "wires": [["5372e888d81e06e9", "26576498416c79f6", "bfa163a5b6f6a354"]]
    },
    {
        "id": "8748fd2114944f91",
        "type": "link out",
        "z": "05895f55507a8cbc",
        "name": "link out 1",
        "mode": "link",
        "links": [
            "aa0fdbd07780b429",
            "030285d2ef532fcd",
            "cca9b256e62a5942",
            "454e6db11d71db62",
            "ab819f3f66e9b635"
        ],
        "x": 895,
        "y": 200,
        "wires": []
    },
    {
        "id": "aa0fdbd07780b429",
        "type": "link in",
        "z": "05895f55507a8cbc",
        "name": "link in 1",
        "links": ["8748fd2114944f91"],
        "x": 255,
        "y": 440,
        "wires": [["3433a7e67868436b"]]
    },
    {
        "id": "3433a7e67868436b",
        "type": "function",
        "z": "05895f55507a8cbc",
        "name": "function 2",
        "func": "if(msg.payload.smoke===0){\n    msg.payload.color =\"#008000\"; //\"green\";\n}else{\n    msg.payload.color = \"#b22222\"; // \"firebrick\";\n}\nmsg.topic = \"e1@cx_color\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 440,
        "wires": [["90ecebf90e3249e9"]]
    },
    {
        "id": "dd9124a97e0d9870",
        "type": "debug",
        "z": "05895f55507a8cbc",
        "name": "debug 9",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 440,
        "wires": []
    },
    {
        "id": "030285d2ef532fcd",
        "type": "link in",
        "z": "05895f55507a8cbc",
        "name": "link in 2",
        "links": ["8748fd2114944f91"],
        "x": 255,
        "y": 500,
        "wires": [["7d350818fbd7b656"]]
    },
    {
        "id": "7d350818fbd7b656",
        "type": "function",
        "z": "05895f55507a8cbc",
        "name": "溫度",
        "func": "msg.payload = msg.payload.temperture;\nmsg.topic = \"temperture\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 500,
        "wires": [["3a1c3f2b530dc5a5"]]
    },
    {
        "id": "d62d36f171d7068a",
        "type": "debug",
        "z": "05895f55507a8cbc",
        "name": "debug 10",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 500,
        "wires": []
    },
    {
        "id": "3a1c3f2b530dc5a5",
        "type": "ui_chart",
        "z": "05895f55507a8cbc",
        "name": "",
        "group": "260eb05ccce4ca18",
        "order": 4,
        "width": 11,
        "height": 5,
        "label": "溫度",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "-10",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 490,
        "y": 500,
        "wires": [["d62d36f171d7068a"]]
    },
    {
        "id": "cca9b256e62a5942",
        "type": "link in",
        "z": "05895f55507a8cbc",
        "name": "link in 3",
        "links": ["8748fd2114944f91"],
        "x": 255,
        "y": 560,
        "wires": [["91ed0c60ed1c9cf2"]]
    },
    {
        "id": "91ed0c60ed1c9cf2",
        "type": "function",
        "z": "05895f55507a8cbc",
        "name": "CO",
        "func": "msg.payload = msg.payload.CO;\nmsg.topic = \"CO\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 560,
        "wires": [["6d411c25c58c0962"]]
    },
    {
        "id": "f34e04da39ef2f95",
        "type": "debug",
        "z": "05895f55507a8cbc",
        "name": "debug 11",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 560,
        "wires": []
    },
    {
        "id": "6d411c25c58c0962",
        "type": "ui_chart",
        "z": "05895f55507a8cbc",
        "name": "",
        "group": "260eb05ccce4ca18",
        "order": 7,
        "width": 14,
        "height": 4,
        "label": "CO(ppm)",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 500,
        "y": 560,
        "wires": [["f34e04da39ef2f95"]]
    },
    {
        "id": "c298d58e093fa0cb",
        "type": "ui_text",
        "z": "05895f55507a8cbc",
        "group": "260eb05ccce4ca18",
        "order": 5,
        "width": 3,
        "height": 2,
        "name": "",
        "label": "status",
        "format": "<font face='arial'><font size=6><font color={{msg.payload.color}}>{{msg.payload.message}}",
        "layout": "col-center",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 690,
        "y": 740,
        "wires": []
    },
    {
        "id": "454e6db11d71db62",
        "type": "link in",
        "z": "05895f55507a8cbc",
        "name": "link in 4",
        "links": ["8748fd2114944f91"],
        "x": 255,
        "y": 620,
        "wires": [["72b9e8b36dc56bd3"]]
    },
    {
        "id": "4ed50c27575955a3",
        "type": "mqtt in",
        "z": "05895f55507a8cbc",
        "name": "",
        "topic": "/entryB/condition",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "4f6c8a65bb8820c6",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 160,
        "y": 180,
        "wires": [["e8725f7b0bb0dfd8", "84b3d81ac571fb1c"]]
    },
    {
        "id": "84b3d81ac571fb1c",
        "type": "function",
        "z": "05895f55507a8cbc",
        "name": "convert data",
        "func": "let { ppm, temp, battery, smoke } = msg.payload;\n\nmsg.payload = { smoke: smoke ? smoke : 0, CO: ppm ? ppm : 0, temperture: temp ? temp : 20, battery: battery ? battery : 0 };\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 180,
        "wires": [["1c1f8c81f6fbf610"]]
    },
    {
        "id": "83195951c4afa9b7",
        "type": "link out",
        "z": "05895f55507a8cbc",
        "name": "living room status",
        "mode": "link",
        "links": ["c97ad871543274fa", "478292a4ebaca8d2"],
        "x": 655,
        "y": 700,
        "wires": []
    },
    {
        "id": "47c79fc2567cf25b",
        "type": "finite-state-machine",
        "z": "05895f55507a8cbc",
        "name": "",
        "fsmDefinition": "{\"state\":{\"status\":\"Normal\",\"data\":{\"x\":5}},\"transitions\":{\"Normal\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Normal\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Fire\":{\"temperture\":\"Fire\",\"CO\":\"Fire\",\"smoke\":\"Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Fire\",\"expire\":\"Fire\",\"reset\":\"Normal\"},\"CO too High\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"CO too High\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Smoke Detected\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Smoke Detected\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Potential Fire\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Potential Fire\",\"expire\":\"Normal\",\"reset\":\"Normal\"}}}",
        "sendInitialState": true,
        "sendStateWithoutChange": true,
        "showTransitionErrors": true,
        "x": 310,
        "y": 740,
        "wires": [["a04ea9855810a37a", "6c5362234729a5d4"]]
    },
    {
        "id": "72b9e8b36dc56bd3",
        "type": "function",
        "z": "05895f55507a8cbc",
        "name": "check transition to FSM",
        "func": "const TEMP_ERROR_LIMIT = 40; // in C\nconst CO_ERROR_LIMIT = 15; // in ppm\n\nconst { smoke, temperture, CO } = msg.payload;\nmsg.topic = \"\"\nmsg.data = {smoke, temperture, CO}\nmsg.control = {}\n\nif (temperture >= TEMP_ERROR_LIMIT) {\n    msg.topic += \"temperture\";\n}\nif (CO >= CO_ERROR_LIMIT) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"CO\";\n}\nif (smoke === 1) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"smoke\";\n} \nif (msg.topic===\"\"){\n    msg.topic = \"normal\";\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 620,
        "wires": [["47c79fc2567cf25b", "9c27b08fd08c6a9b"]]
    },
    {
        "id": "1a463d1f16146cf8",
        "type": "debug",
        "z": "05895f55507a8cbc",
        "name": "state",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 820,
        "wires": []
    },
    {
        "id": "9c27b08fd08c6a9b",
        "type": "debug",
        "z": "05895f55507a8cbc",
        "name": "trasition",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 780,
        "y": 620,
        "wires": []
    },
    {
        "id": "e8690f8f418c1a00",
        "type": "inject",
        "z": "05895f55507a8cbc",
        "name": "reset",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "reset",
        "payload": "",
        "payloadType": "date",
        "x": 90,
        "y": 740,
        "wires": [["47c79fc2567cf25b"]]
    },
    {
        "id": "a04ea9855810a37a",
        "type": "function",
        "z": "05895f55507a8cbc",
        "name": "function 3",
        "func": "msg.state_color = {\n    \"Normal\": \"green\",\n    \"Fire\": \"red\",\n    \"CO too High\": \"orange\",\n    \"Smoke Detected\": \"orange\",\n    \"Potential Fire\": \"orange\"\n}\nmsg.payload = {\n    place: \"entryB\",\n    message: msg.payload.status,\n    color: msg.state_color[msg.payload.status]\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 740,
        "wires": [
            [
                "1a463d1f16146cf8",
                "c298d58e093fa0cb",
                "83195951c4afa9b7",
                "1c31869c64895048"
            ]
        ]
    },
    {
        "id": "6c5362234729a5d4",
        "type": "debug",
        "z": "05895f55507a8cbc",
        "name": "debug 14",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 460,
        "y": 820,
        "wires": []
    },
    {
        "id": "2c85e2c9f66a632b",
        "type": "line-notify",
        "z": "05895f55507a8cbc",
        "d": true,
        "name": "test YCK",
        "message": "",
        "contentType": "message",
        "imageThumbnail": "",
        "imageUrl": "",
        "sticker": "default",
        "stickerPackageId": "1",
        "stickerId": "1",
        "silent": false,
        "creds": "63115de6b1972cd9",
        "x": 980,
        "y": 920,
        "wires": [[]]
    },
    {
        "id": "97152530453e3c8f",
        "type": "inject",
        "z": "05895f55507a8cbc",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 270,
        "y": 920,
        "wires": [["1c31869c64895048"]]
    },
    {
        "id": "1c31869c64895048",
        "type": "rbe",
        "z": "05895f55507a8cbc",
        "name": "block the same value",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": true,
        "property": "payload",
        "topi": "topic",
        "x": 600,
        "y": 920,
        "wires": [["6451b549b3f1ac96"]]
    },
    {
        "id": "6451b549b3f1ac96",
        "type": "function",
        "z": "05895f55507a8cbc",
        "name": "modify message",
        "func": "const place = \"entry B\"\nif (msg.payload.message==\"Normal\"){\n    return;\n}\nmsg.payload = \"\\n注意！\\n\" + place + \": \" + msg.payload.message\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 920,
        "wires": [["2c85e2c9f66a632b"]]
    },
    {
        "id": "f534e175a3d9f26b",
        "type": "ui_ui_control",
        "z": "05895f55507a8cbc",
        "name": "navigation",
        "events": "all",
        "x": 530,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "6c96a335b5be0739",
        "type": "ui_template",
        "z": "05895f55507a8cbc",
        "group": "260eb05ccce4ca18",
        "name": "Back Home",
        "order": 2,
        "width": 2,
        "height": 1,
        "format": "<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#e67e22\"\n    ng-click=\"send({payload: 'Home'})\">\n    Back\n</md-button>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 370,
        "y": 1020,
        "wires": [["f534e175a3d9f26b"]]
    },
    {
        "id": "4f88e263b4a1f911",
        "type": "ui_template",
        "z": "05895f55507a8cbc",
        "group": "dc87ea581ec639fa",
        "name": "button css",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<style>\n  * {\n      overflow: hidden;\n  }\n  .filled { \n      height: 90% !important;\n      width: 90% !important;\n      padding: 0 !important;\n      margin: 4% !important;\n  }\n  .nr-dashboard-template {\n      padding: 0;\n      margin: 0;\n  }\n  \n  .rounded {\n  border-radius: 12px 12px 12px 12px;\n}\n \n   .bigfont {\n  font-size: 18px;\n}\n\n   .smallfont {\n  font-size: 12px;\n}\n  \n</style>\n\n<script>\n$('.vibrate').on('click', function() {\n  navigator.vibrate(100);\n});\n\nfunction restore_bg(x) {\n            $(this).css(\"background-color\", x);\n    };\n\n$('.touched').on('mousedown', function() {\n    \n    var x= $(this).css(\"background-color\");\n    $(this).css(\"background-color\", \"yellow\");\n    \n    setTimeout(restore_bg.bind(this,x),100);\n    navigator.vibrate(80);\n    });\n    \n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "global",
        "className": "",
        "x": 190,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "a3163d3cd61abf3a",
        "type": "inject",
        "z": "05895f55507a8cbc",
        "name": "normal",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":8,\"temperture\":30,\"battery\":0}",
        "payloadType": "json",
        "x": 200,
        "y": 220,
        "wires": [["b243049056506dce"]]
    },
    {
        "id": "d02a4d27fad92751",
        "type": "inject",
        "z": "05895f55507a8cbc",
        "name": "smoke",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":1,\"CO\":8,\"temperture\":30}",
        "payloadType": "json",
        "x": 190,
        "y": 260,
        "wires": [["b243049056506dce"]]
    },
    {
        "id": "c8a229a1f5324367",
        "type": "inject",
        "z": "05895f55507a8cbc",
        "name": "CO",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":30}",
        "payloadType": "json",
        "x": 190,
        "y": 300,
        "wires": [["b243049056506dce"]]
    },
    {
        "id": "b2b9421f2c8db71e",
        "type": "inject",
        "z": "05895f55507a8cbc",
        "name": "fire",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":45}",
        "payloadType": "json",
        "x": 190,
        "y": 340,
        "wires": [["b243049056506dce"]]
    },
    {
        "id": "b243049056506dce",
        "type": "delay",
        "z": "05895f55507a8cbc",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 410,
        "y": 280,
        "wires": [["1c1f8c81f6fbf610"]]
    },
    {
        "id": "0611f2bfdeabac76",
        "type": "link in",
        "z": "05895f55507a8cbc",
        "name": "all reset",
        "links": ["1765ee585273167c"],
        "x": 135,
        "y": 800,
        "wires": [["47c79fc2567cf25b"]]
    },
    {
        "id": "3fe5aef0eb906bc2",
        "type": "link in",
        "z": "05895f55507a8cbc",
        "name": "reset",
        "links": ["1765ee585273167c"],
        "x": 95,
        "y": 380,
        "wires": [["6380cd08448ec3f5"]]
    },
    {
        "id": "6380cd08448ec3f5",
        "type": "function",
        "z": "05895f55507a8cbc",
        "name": "reset normal",
        "func": "msg.payload = { \"smoke\": 0, \"CO\": 8, \"temperture\": 30 }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 210,
        "y": 380,
        "wires": [["b243049056506dce"]]
    },
    {
        "id": "3fdcd9463645fdd7",
        "type": "ui_ui_control",
        "z": "05895f55507a8cbc",
        "name": "",
        "events": "all",
        "x": 80,
        "y": 840,
        "wires": [["2b57e0799660d8b1"]]
    },
    {
        "id": "2b57e0799660d8b1",
        "type": "function",
        "z": "05895f55507a8cbc",
        "name": "trigger when chage page",
        "func": "msg.topic = \"normal\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 270,
        "y": 840,
        "wires": [["47c79fc2567cf25b"]]
    },
    {
        "id": "90ecebf90e3249e9",
        "type": "ui_template",
        "z": "05895f55507a8cbc",
        "group": "260eb05ccce4ca18",
        "name": "煙霧顯示",
        "order": 6,
        "width": 3,
        "height": 2,
        "format": "<div id=\"graphics\" ng-init=\"checkSVG()\" style=\"display: flex; justify-content:center;align-items:center\">\n    <p id=\"e1_text\">煙霧</p>\n    <svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0\" y=\"0\" height=\"34\"\n        viewBox=\"0 0 34 34\" width=\"34\" preserveAspectRatio=\"xMidYMid meet\">\n        <circle id=\"e1_circle\" cx=\"17\" cy=\"17\" style=\"fill:green;stroke-width:0px;overflow:hidden\" r=\"16\" />\n    </svg>\n    <script>\n        (function($scope) {\n                $scope.$watch('msg', function() {\n                    if (!$scope.msg) return;\n                    const color=$scope.msg.payload?.color;\n                    const topic=$scope.msg.topic;\n                    if (color === undefined || color === null ||\n                        !topic || typeof topic !== 'string' || !topic.includes('@')) return;\n                    const id = topic.split('@')[0], cxType = topic.split('@')[1];\n                    document.getElementById(id+\"_circle\").style.fill=color;\n                    document.getElementById(id+\"_text\").style.cssText = `color:${color} !important;font-weight:bold` ;\n                });\n            })(scope);\n    </script>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 500,
        "y": 440,
        "wires": [["dd9124a97e0d9870"]]
    },
    {
        "id": "5b06ec38d2391949",
        "type": "ui_template",
        "z": "05895f55507a8cbc",
        "group": "260eb05ccce4ca18",
        "name": "power icon",
        "order": 3,
        "width": 1,
        "height": 1,
        "format": "<div style=\"display: flex; justify-content:center;align-items:center;height: auto; width: auto\">\n    <img id=\"battery\" style=\"height: auto; width: auto;display: none\" src=\"/half-battery.png\">\n    <img id=\"charging\" style=\"height: auto; width: auto;display: block\" src=\"/low-battery.png\">\n</div>\n\n<script>\n    (function($scope) {\n        $scope.$watch('msg', function() {\n            if (!$scope.msg) return;\n            const battery=$scope.msg.payload?.battery;\n            // console.log(battery);\n            if(battery){\n                $(\"#battery\").css(\"display\",battery?\"block\":\"none\");\n                $(\"#charging\").css(\"display\",battery?\"none\":\"block\");\n            }\n        });\n    })(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 510,
        "y": 400,
        "wires": [[]]
    },
    {
        "id": "ab819f3f66e9b635",
        "type": "link in",
        "z": "05895f55507a8cbc",
        "name": "link in 7",
        "links": ["8748fd2114944f91"],
        "x": 365,
        "y": 400,
        "wires": [["5b06ec38d2391949"]]
    },
    {
        "id": "1c1f8c81f6fbf610",
        "type": "function",
        "z": "05895f55507a8cbc",
        "name": "add node information",
        "func": "msg.payload.place = \"entryB\";\nmsg.payload.time = Date.now();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 740,
        "y": 200,
        "wires": [["8748fd2114944f91"]]
    },
    {
        "id": "df93e575c73e9dec",
        "type": "comment",
        "z": "05895f55507a8cbc",
        "name": "改place",
        "info": "改place",
        "x": 510,
        "y": 700,
        "wires": []
    },
    {
        "id": "4d29b4f27a317816",
        "type": "comment",
        "z": "05895f55507a8cbc",
        "name": "改place",
        "info": "改place",
        "x": 748.3333129882812,
        "y": 166.3333282470703,
        "wires": []
    },
    {
        "id": "3b55b15969136b77",
        "type": "comment",
        "z": "05895f55507a8cbc",
        "name": "改place",
        "info": "改place",
        "x": 97.33332824707031,
        "y": 146.3333282470703,
        "wires": []
    },
    {
        "id": "39a75c5e360237ff",
        "type": "comment",
        "z": "05895f55507a8cbc",
        "name": "改place",
        "info": "改place",
        "x": 842.3333129882812,
        "y": 885.3333740234375,
        "wires": []
    },
    {
        "id": "62b3a71db2256628",
        "type": "comment",
        "z": "05895f55507a8cbc",
        "name": "改group",
        "info": "",
        "x": 390,
        "y": 980,
        "wires": []
    },
    {
        "id": "e0a80ed5cadfd71a",
        "type": "comment",
        "z": "05895f55507a8cbc",
        "name": "改group",
        "info": "",
        "x": 750,
        "y": 700,
        "wires": []
    },
    {
        "id": "86da4d081a0b1092",
        "type": "comment",
        "z": "05895f55507a8cbc",
        "name": "改group",
        "info": "",
        "x": 530,
        "y": 360,
        "wires": []
    },
    {
        "id": "1589a2183dfddd9f",
        "type": "random",
        "z": "f141c113f55a94bd",
        "name": "偵煙器",
        "low": "0",
        "high": "1",
        "inte": "true",
        "property": "payload",
        "x": 230,
        "y": 40,
        "wires": [["ee18fe05f8cb4b8a"]]
    },
    {
        "id": "8a4f3a3b1361d115",
        "type": "random",
        "z": "f141c113f55a94bd",
        "name": "CO(ppm)",
        "low": "0",
        "high": 10,
        "inte": "false",
        "property": "payload",
        "x": 240,
        "y": 80,
        "wires": [["b203bb873dc91610"]]
    },
    {
        "id": "1a1d960308a7ade2",
        "type": "random",
        "z": "f141c113f55a94bd",
        "name": "溫度",
        "low": "-10",
        "high": "50",
        "inte": "false",
        "property": "payload",
        "x": 230,
        "y": 120,
        "wires": [["88e9e8e767f4d90a"]]
    },
    {
        "id": "2e44b59bbb23cf35",
        "type": "join",
        "z": "f141c113f55a94bd",
        "name": "",
        "mode": "custom",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "1",
        "count": "3",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 550,
        "y": 80,
        "wires": [["75578b7fa1eda59e"]]
    },
    {
        "id": "abd3fd21bef110dd",
        "type": "debug",
        "z": "f141c113f55a94bd",
        "name": "combine",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 400,
        "y": 220,
        "wires": []
    },
    {
        "id": "ee18fe05f8cb4b8a",
        "type": "change",
        "z": "f141c113f55a94bd",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "smoke",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 40,
        "wires": [["2e44b59bbb23cf35"]]
    },
    {
        "id": "b203bb873dc91610",
        "type": "change",
        "z": "f141c113f55a94bd",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "CO",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 80,
        "wires": [["2e44b59bbb23cf35"]]
    },
    {
        "id": "88e9e8e767f4d90a",
        "type": "change",
        "z": "f141c113f55a94bd",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperture",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 120,
        "wires": [["2e44b59bbb23cf35"]]
    },
    {
        "id": "ce06fa1eec4964cd",
        "type": "inject",
        "z": "f141c113f55a94bd",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 70,
        "y": 80,
        "wires": [["1589a2183dfddd9f", "8a4f3a3b1361d115", "1a1d960308a7ade2"]]
    },
    {
        "id": "906b03b8876a715b",
        "type": "link out",
        "z": "f141c113f55a94bd",
        "name": "link out 1",
        "mode": "link",
        "links": [
            "53da42b1dc5c7d4d",
            "47fc9a9333bd6aed",
            "cf7fa0ace335a74d",
            "5c718dffa8ce2bf6",
            "57c491e29ae1aba6"
        ],
        "x": 895,
        "y": 200,
        "wires": []
    },
    {
        "id": "53da42b1dc5c7d4d",
        "type": "link in",
        "z": "f141c113f55a94bd",
        "name": "link in 1",
        "links": ["906b03b8876a715b"],
        "x": 255,
        "y": 440,
        "wires": [["0d1b07654942fb6e"]]
    },
    {
        "id": "0d1b07654942fb6e",
        "type": "function",
        "z": "f141c113f55a94bd",
        "name": "function 2",
        "func": "if(msg.payload.smoke===0){\n    msg.payload.color =\"#008000\"; //\"green\";\n}else{\n    msg.payload.color = \"#b22222\"; // \"firebrick\";\n}\nmsg.topic = \"e1@cx_color\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 440,
        "wires": [["1a2ddc89b7b206b2"]]
    },
    {
        "id": "054df014d9e3e3a7",
        "type": "debug",
        "z": "f141c113f55a94bd",
        "name": "debug 9",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 440,
        "wires": []
    },
    {
        "id": "47fc9a9333bd6aed",
        "type": "link in",
        "z": "f141c113f55a94bd",
        "name": "link in 2",
        "links": ["906b03b8876a715b"],
        "x": 255,
        "y": 500,
        "wires": [["1bae25cb92996f65"]]
    },
    {
        "id": "1bae25cb92996f65",
        "type": "function",
        "z": "f141c113f55a94bd",
        "name": "溫度",
        "func": "msg.payload = msg.payload.temperture;\nmsg.topic = \"temperture\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 500,
        "wires": [["1021ef17cbc63d0e"]]
    },
    {
        "id": "2c9d2ff3d8e42363",
        "type": "debug",
        "z": "f141c113f55a94bd",
        "name": "debug 10",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 500,
        "wires": []
    },
    {
        "id": "1021ef17cbc63d0e",
        "type": "ui_chart",
        "z": "f141c113f55a94bd",
        "name": "",
        "group": "a728dc84b50e05ad",
        "order": 4,
        "width": 11,
        "height": 5,
        "label": "溫度",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "-10",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 490,
        "y": 500,
        "wires": [["2c9d2ff3d8e42363"]]
    },
    {
        "id": "cf7fa0ace335a74d",
        "type": "link in",
        "z": "f141c113f55a94bd",
        "name": "link in 3",
        "links": ["906b03b8876a715b"],
        "x": 255,
        "y": 560,
        "wires": [["cd700bb65ce67825"]]
    },
    {
        "id": "cd700bb65ce67825",
        "type": "function",
        "z": "f141c113f55a94bd",
        "name": "CO",
        "func": "msg.payload = msg.payload.CO;\nmsg.topic = \"CO\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 560,
        "wires": [["a20bbd7816d380fc"]]
    },
    {
        "id": "15e97b7eb9fcac24",
        "type": "debug",
        "z": "f141c113f55a94bd",
        "name": "debug 11",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 560,
        "wires": []
    },
    {
        "id": "a20bbd7816d380fc",
        "type": "ui_chart",
        "z": "f141c113f55a94bd",
        "name": "",
        "group": "a728dc84b50e05ad",
        "order": 7,
        "width": 14,
        "height": 4,
        "label": "CO(ppm)",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 500,
        "y": 560,
        "wires": [["15e97b7eb9fcac24"]]
    },
    {
        "id": "95252afbbfe9809c",
        "type": "ui_text",
        "z": "f141c113f55a94bd",
        "group": "a728dc84b50e05ad",
        "order": 5,
        "width": 3,
        "height": 2,
        "name": "",
        "label": "status",
        "format": "<font face='arial'><font size=6><font color={{msg.payload.color}}>{{msg.payload.message}}",
        "layout": "col-center",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 690,
        "y": 740,
        "wires": []
    },
    {
        "id": "5c718dffa8ce2bf6",
        "type": "link in",
        "z": "f141c113f55a94bd",
        "name": "link in 4",
        "links": ["906b03b8876a715b"],
        "x": 255,
        "y": 620,
        "wires": [["6581352233f16301"]]
    },
    {
        "id": "1f616193b386c9ee",
        "type": "mqtt in",
        "z": "f141c113f55a94bd",
        "name": "",
        "topic": "/aisleA/condition",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "4f6c8a65bb8820c6",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 160,
        "y": 180,
        "wires": [["abd3fd21bef110dd", "6bedc254a7c1acde"]]
    },
    {
        "id": "6bedc254a7c1acde",
        "type": "function",
        "z": "f141c113f55a94bd",
        "name": "convert data",
        "func": "let { ppm, temp, battery, smoke } = msg.payload;\n\nmsg.payload = { smoke: smoke ? smoke : 0, CO: ppm ? ppm : 0, temperture: temp ? temp : 20, battery: battery ? battery : 0 };\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 180,
        "wires": [["75578b7fa1eda59e"]]
    },
    {
        "id": "a227e6cd6d4d9f45",
        "type": "link out",
        "z": "f141c113f55a94bd",
        "name": "living room status",
        "mode": "link",
        "links": ["c97ad871543274fa", "478292a4ebaca8d2"],
        "x": 655,
        "y": 700,
        "wires": []
    },
    {
        "id": "8a4f9ba968d1c043",
        "type": "finite-state-machine",
        "z": "f141c113f55a94bd",
        "name": "",
        "fsmDefinition": "{\"state\":{\"status\":\"Normal\",\"data\":{\"x\":5}},\"transitions\":{\"Normal\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Normal\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Fire\":{\"temperture\":\"Fire\",\"CO\":\"Fire\",\"smoke\":\"Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Fire\",\"expire\":\"Fire\",\"reset\":\"Normal\"},\"CO too High\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"CO too High\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Smoke Detected\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Smoke Detected\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Potential Fire\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Potential Fire\",\"expire\":\"Normal\",\"reset\":\"Normal\"}}}",
        "sendInitialState": true,
        "sendStateWithoutChange": true,
        "showTransitionErrors": true,
        "x": 310,
        "y": 740,
        "wires": [["3355ea87ba5c0dec", "1c9d48782f6d6cfa"]]
    },
    {
        "id": "6581352233f16301",
        "type": "function",
        "z": "f141c113f55a94bd",
        "name": "check transition to FSM",
        "func": "const TEMP_ERROR_LIMIT = 40; // in C\nconst CO_ERROR_LIMIT = 15; // in ppm\n\nconst { smoke, temperture, CO } = msg.payload;\nmsg.topic = \"\"\nmsg.data = {smoke, temperture, CO}\nmsg.control = {}\n\nif (temperture >= TEMP_ERROR_LIMIT) {\n    msg.topic += \"temperture\";\n}\nif (CO >= CO_ERROR_LIMIT) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"CO\";\n}\nif (smoke === 1) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"smoke\";\n} \nif (msg.topic===\"\"){\n    msg.topic = \"normal\";\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 620,
        "wires": [["8a4f9ba968d1c043", "c798ebf1a2d23ce5"]]
    },
    {
        "id": "cb30f21cb2294f8d",
        "type": "debug",
        "z": "f141c113f55a94bd",
        "name": "state",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 820,
        "wires": []
    },
    {
        "id": "c798ebf1a2d23ce5",
        "type": "debug",
        "z": "f141c113f55a94bd",
        "name": "trasition",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 780,
        "y": 620,
        "wires": []
    },
    {
        "id": "2c214a439112b4f2",
        "type": "inject",
        "z": "f141c113f55a94bd",
        "name": "reset",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "reset",
        "payload": "",
        "payloadType": "date",
        "x": 90,
        "y": 740,
        "wires": [["8a4f9ba968d1c043"]]
    },
    {
        "id": "3355ea87ba5c0dec",
        "type": "function",
        "z": "f141c113f55a94bd",
        "name": "function 3",
        "func": "msg.state_color = {\n    \"Normal\": \"green\",\n    \"Fire\": \"red\",\n    \"CO too High\": \"orange\",\n    \"Smoke Detected\": \"orange\",\n    \"Potential Fire\": \"orange\"\n}\nmsg.payload = {\n    place: \"aisleA\",\n    message: msg.payload.status,\n    color: msg.state_color[msg.payload.status]\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 740,
        "wires": [
            [
                "cb30f21cb2294f8d",
                "95252afbbfe9809c",
                "a227e6cd6d4d9f45",
                "36177751ecd6bd40"
            ]
        ]
    },
    {
        "id": "1c9d48782f6d6cfa",
        "type": "debug",
        "z": "f141c113f55a94bd",
        "name": "debug 14",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 460,
        "y": 820,
        "wires": []
    },
    {
        "id": "469406475570d406",
        "type": "line-notify",
        "z": "f141c113f55a94bd",
        "d": true,
        "name": "test YCK",
        "message": "",
        "contentType": "message",
        "imageThumbnail": "",
        "imageUrl": "",
        "sticker": "default",
        "stickerPackageId": "1",
        "stickerId": "1",
        "silent": false,
        "creds": "63115de6b1972cd9",
        "x": 980,
        "y": 920,
        "wires": [[]]
    },
    {
        "id": "45b37535c201c288",
        "type": "inject",
        "z": "f141c113f55a94bd",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 270,
        "y": 920,
        "wires": [["36177751ecd6bd40"]]
    },
    {
        "id": "36177751ecd6bd40",
        "type": "rbe",
        "z": "f141c113f55a94bd",
        "name": "block the same value",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": true,
        "property": "payload",
        "topi": "topic",
        "x": 600,
        "y": 920,
        "wires": [["f76fd78207275126"]]
    },
    {
        "id": "f76fd78207275126",
        "type": "function",
        "z": "f141c113f55a94bd",
        "name": "modify message",
        "func": "const place = \"aisle A\"\nif (msg.payload.message==\"Normal\"){\n    return;\n}\nmsg.payload = \"\\n注意！\\n\" + place + \": \" + msg.payload.message\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 920,
        "wires": [["469406475570d406"]]
    },
    {
        "id": "dfe2bfcea7ea71a5",
        "type": "ui_ui_control",
        "z": "f141c113f55a94bd",
        "name": "navigation",
        "events": "all",
        "x": 530,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "610448697cb276bf",
        "type": "ui_template",
        "z": "f141c113f55a94bd",
        "group": "a728dc84b50e05ad",
        "name": "Back Home",
        "order": 2,
        "width": 2,
        "height": 1,
        "format": "<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#e67e22\"\n    ng-click=\"send({payload: 'Home'})\">\n    Back\n</md-button>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 370,
        "y": 1020,
        "wires": [["dfe2bfcea7ea71a5"]]
    },
    {
        "id": "2a028a6cc2e3e2b3",
        "type": "ui_template",
        "z": "f141c113f55a94bd",
        "group": "dc87ea581ec639fa",
        "name": "button css",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<style>\n  * {\n      overflow: hidden;\n  }\n  .filled { \n      height: 90% !important;\n      width: 90% !important;\n      padding: 0 !important;\n      margin: 4% !important;\n  }\n  .nr-dashboard-template {\n      padding: 0;\n      margin: 0;\n  }\n  \n  .rounded {\n  border-radius: 12px 12px 12px 12px;\n}\n \n   .bigfont {\n  font-size: 18px;\n}\n\n   .smallfont {\n  font-size: 12px;\n}\n  \n</style>\n\n<script>\n$('.vibrate').on('click', function() {\n  navigator.vibrate(100);\n});\n\nfunction restore_bg(x) {\n            $(this).css(\"background-color\", x);\n    };\n\n$('.touched').on('mousedown', function() {\n    \n    var x= $(this).css(\"background-color\");\n    $(this).css(\"background-color\", \"yellow\");\n    \n    setTimeout(restore_bg.bind(this,x),100);\n    navigator.vibrate(80);\n    });\n    \n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "global",
        "className": "",
        "x": 190,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "417adc90084d7810",
        "type": "inject",
        "z": "f141c113f55a94bd",
        "name": "normal",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":8,\"temperture\":30,\"battery\":0}",
        "payloadType": "json",
        "x": 200,
        "y": 220,
        "wires": [["49339aef8ac095ae"]]
    },
    {
        "id": "b91ee9343971cf30",
        "type": "inject",
        "z": "f141c113f55a94bd",
        "name": "smoke",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":1,\"CO\":8,\"temperture\":30}",
        "payloadType": "json",
        "x": 190,
        "y": 260,
        "wires": [["49339aef8ac095ae"]]
    },
    {
        "id": "11986d12582b618b",
        "type": "inject",
        "z": "f141c113f55a94bd",
        "name": "CO",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":30}",
        "payloadType": "json",
        "x": 190,
        "y": 300,
        "wires": [["49339aef8ac095ae"]]
    },
    {
        "id": "01b4997fb5cd42d8",
        "type": "inject",
        "z": "f141c113f55a94bd",
        "name": "fire",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":45}",
        "payloadType": "json",
        "x": 190,
        "y": 340,
        "wires": [["49339aef8ac095ae"]]
    },
    {
        "id": "49339aef8ac095ae",
        "type": "delay",
        "z": "f141c113f55a94bd",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 410,
        "y": 280,
        "wires": [["75578b7fa1eda59e"]]
    },
    {
        "id": "aa595bc0048126e2",
        "type": "link in",
        "z": "f141c113f55a94bd",
        "name": "all reset",
        "links": ["1765ee585273167c"],
        "x": 135,
        "y": 800,
        "wires": [["8a4f9ba968d1c043"]]
    },
    {
        "id": "7dac4d9cd2b1ea7a",
        "type": "link in",
        "z": "f141c113f55a94bd",
        "name": "reset",
        "links": ["1765ee585273167c"],
        "x": 95,
        "y": 380,
        "wires": [["36d9d61f425f141d"]]
    },
    {
        "id": "36d9d61f425f141d",
        "type": "function",
        "z": "f141c113f55a94bd",
        "name": "reset normal",
        "func": "msg.payload = { \"smoke\": 0, \"CO\": 8, \"temperture\": 30 }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 210,
        "y": 380,
        "wires": [["49339aef8ac095ae"]]
    },
    {
        "id": "8db834b4d8bc05c6",
        "type": "ui_ui_control",
        "z": "f141c113f55a94bd",
        "name": "",
        "events": "all",
        "x": 80,
        "y": 840,
        "wires": [["5e21a9e2848ed3f3"]]
    },
    {
        "id": "5e21a9e2848ed3f3",
        "type": "function",
        "z": "f141c113f55a94bd",
        "name": "trigger when chage page",
        "func": "msg.topic = \"normal\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 270,
        "y": 840,
        "wires": [["8a4f9ba968d1c043"]]
    },
    {
        "id": "1a2ddc89b7b206b2",
        "type": "ui_template",
        "z": "f141c113f55a94bd",
        "group": "a728dc84b50e05ad",
        "name": "煙霧顯示",
        "order": 6,
        "width": 3,
        "height": 2,
        "format": "<div id=\"graphics\" ng-init=\"checkSVG()\" style=\"display: flex; justify-content:center;align-items:center\">\n    <p id=\"e1_text\">煙霧</p>\n    <svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0\" y=\"0\" height=\"34\"\n        viewBox=\"0 0 34 34\" width=\"34\" preserveAspectRatio=\"xMidYMid meet\">\n        <circle id=\"e1_circle\" cx=\"17\" cy=\"17\" style=\"fill:green;stroke-width:0px;overflow:hidden\" r=\"16\" />\n    </svg>\n    <script>\n        (function($scope) {\n                $scope.$watch('msg', function() {\n                    if (!$scope.msg) return;\n                    const color=$scope.msg.payload?.color;\n                    const topic=$scope.msg.topic;\n                    if (color === undefined || color === null ||\n                        !topic || typeof topic !== 'string' || !topic.includes('@')) return;\n                    const id = topic.split('@')[0], cxType = topic.split('@')[1];\n                    document.getElementById(id+\"_circle\").style.fill=color;\n                    document.getElementById(id+\"_text\").style.cssText = `color:${color} !important;font-weight:bold` ;\n                });\n            })(scope);\n    </script>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 500,
        "y": 440,
        "wires": [["054df014d9e3e3a7"]]
    },
    {
        "id": "1d6fbbfaaa69a96a",
        "type": "ui_template",
        "z": "f141c113f55a94bd",
        "group": "a728dc84b50e05ad",
        "name": "power icon",
        "order": 3,
        "width": 1,
        "height": 1,
        "format": "<div style=\"display: flex; justify-content:center;align-items:center;height: auto; width: auto\">\n    <img id=\"battery\" style=\"height: auto; width: auto;display: none\" src=\"/half-battery.png\">\n    <img id=\"charging\" style=\"height: auto; width: auto;display: block\" src=\"/low-battery.png\">\n</div>\n\n<script>\n    (function($scope) {\n        $scope.$watch('msg', function() {\n            if (!$scope.msg) return;\n            const battery=$scope.msg.payload?.battery;\n            // console.log(battery);\n            if(battery){\n                $(\"#battery\").css(\"display\",battery?\"block\":\"none\");\n                $(\"#charging\").css(\"display\",battery?\"none\":\"block\");\n            }\n        });\n    })(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 510,
        "y": 400,
        "wires": [[]]
    },
    {
        "id": "57c491e29ae1aba6",
        "type": "link in",
        "z": "f141c113f55a94bd",
        "name": "link in 7",
        "links": ["906b03b8876a715b"],
        "x": 365,
        "y": 400,
        "wires": [["1d6fbbfaaa69a96a"]]
    },
    {
        "id": "75578b7fa1eda59e",
        "type": "function",
        "z": "f141c113f55a94bd",
        "name": "add node information",
        "func": "msg.payload.place = \"aisleA\";\nmsg.payload.time = Date.now();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 740,
        "y": 200,
        "wires": [["906b03b8876a715b"]]
    },
    {
        "id": "31894a8b2b87a653",
        "type": "comment",
        "z": "f141c113f55a94bd",
        "name": "改place",
        "info": "改place",
        "x": 510,
        "y": 700,
        "wires": []
    },
    {
        "id": "b8f69089b14e72ec",
        "type": "comment",
        "z": "f141c113f55a94bd",
        "name": "改place",
        "info": "改place",
        "x": 748.3333129882812,
        "y": 166.3333282470703,
        "wires": []
    },
    {
        "id": "0a22a202833e8693",
        "type": "comment",
        "z": "f141c113f55a94bd",
        "name": "改place",
        "info": "改place",
        "x": 97.33332824707031,
        "y": 146.3333282470703,
        "wires": []
    },
    {
        "id": "ade1b67ba60bde16",
        "type": "comment",
        "z": "f141c113f55a94bd",
        "name": "改place",
        "info": "改place",
        "x": 842.3333129882812,
        "y": 885.3333740234375,
        "wires": []
    },
    {
        "id": "025a6a23a76755e7",
        "type": "comment",
        "z": "f141c113f55a94bd",
        "name": "改group",
        "info": "",
        "x": 390,
        "y": 980,
        "wires": []
    },
    {
        "id": "be53f6784e819b26",
        "type": "comment",
        "z": "f141c113f55a94bd",
        "name": "改group",
        "info": "",
        "x": 750,
        "y": 700,
        "wires": []
    },
    {
        "id": "1c3b31cc98263a75",
        "type": "comment",
        "z": "f141c113f55a94bd",
        "name": "改group",
        "info": "",
        "x": 530,
        "y": 360,
        "wires": []
    },
    {
        "id": "0d76b272bef5156b",
        "type": "random",
        "z": "901e2cd0c21d04eb",
        "name": "偵煙器",
        "low": "0",
        "high": "1",
        "inte": "true",
        "property": "payload",
        "x": 230,
        "y": 40,
        "wires": [["9438bfaf3ea7e74c"]]
    },
    {
        "id": "9fd564a622ea8f5c",
        "type": "random",
        "z": "901e2cd0c21d04eb",
        "name": "CO(ppm)",
        "low": "0",
        "high": 10,
        "inte": "false",
        "property": "payload",
        "x": 240,
        "y": 80,
        "wires": [["cbf2c4689d8c7bc5"]]
    },
    {
        "id": "03a487f575d43283",
        "type": "random",
        "z": "901e2cd0c21d04eb",
        "name": "溫度",
        "low": "-10",
        "high": "50",
        "inte": "false",
        "property": "payload",
        "x": 230,
        "y": 120,
        "wires": [["3e46e79ae031405c"]]
    },
    {
        "id": "34519e6f925a0af0",
        "type": "join",
        "z": "901e2cd0c21d04eb",
        "name": "",
        "mode": "custom",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "1",
        "count": "3",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 550,
        "y": 80,
        "wires": [["e6f834ad3a6b7dd2"]]
    },
    {
        "id": "6e9056db0d87e3e6",
        "type": "debug",
        "z": "901e2cd0c21d04eb",
        "name": "combine",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 400,
        "y": 220,
        "wires": []
    },
    {
        "id": "9438bfaf3ea7e74c",
        "type": "change",
        "z": "901e2cd0c21d04eb",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "smoke",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 40,
        "wires": [["34519e6f925a0af0"]]
    },
    {
        "id": "cbf2c4689d8c7bc5",
        "type": "change",
        "z": "901e2cd0c21d04eb",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "CO",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 80,
        "wires": [["34519e6f925a0af0"]]
    },
    {
        "id": "3e46e79ae031405c",
        "type": "change",
        "z": "901e2cd0c21d04eb",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperture",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 120,
        "wires": [["34519e6f925a0af0"]]
    },
    {
        "id": "f428926d63412854",
        "type": "inject",
        "z": "901e2cd0c21d04eb",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 70,
        "y": 80,
        "wires": [["0d76b272bef5156b", "9fd564a622ea8f5c", "03a487f575d43283"]]
    },
    {
        "id": "70328a4908eb9246",
        "type": "link out",
        "z": "901e2cd0c21d04eb",
        "name": "link out 1",
        "mode": "link",
        "links": [
            "b5824c282d927bd4",
            "258cf2ede5a134b7",
            "021ba477fbe2deb0",
            "71c27c9edf0deab6",
            "6ddd5fb3c19b694b"
        ],
        "x": 895,
        "y": 200,
        "wires": []
    },
    {
        "id": "b5824c282d927bd4",
        "type": "link in",
        "z": "901e2cd0c21d04eb",
        "name": "link in 1",
        "links": ["70328a4908eb9246"],
        "x": 255,
        "y": 440,
        "wires": [["a56efc50f04f5bd4"]]
    },
    {
        "id": "a56efc50f04f5bd4",
        "type": "function",
        "z": "901e2cd0c21d04eb",
        "name": "function 2",
        "func": "if(msg.payload.smoke===0){\n    msg.payload.color =\"#008000\"; //\"green\";\n}else{\n    msg.payload.color = \"#b22222\"; // \"firebrick\";\n}\nmsg.topic = \"e1@cx_color\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 440,
        "wires": [["52d3c5b43339b764"]]
    },
    {
        "id": "f4787284cebff631",
        "type": "debug",
        "z": "901e2cd0c21d04eb",
        "name": "debug 9",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 440,
        "wires": []
    },
    {
        "id": "258cf2ede5a134b7",
        "type": "link in",
        "z": "901e2cd0c21d04eb",
        "name": "link in 2",
        "links": ["70328a4908eb9246"],
        "x": 255,
        "y": 500,
        "wires": [["a8edae569b2d5cb5"]]
    },
    {
        "id": "a8edae569b2d5cb5",
        "type": "function",
        "z": "901e2cd0c21d04eb",
        "name": "溫度",
        "func": "msg.payload = msg.payload.temperture;\nmsg.topic = \"temperture\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 500,
        "wires": [["417bbdcfddb2f927"]]
    },
    {
        "id": "d25b6b51d46d3cdc",
        "type": "debug",
        "z": "901e2cd0c21d04eb",
        "name": "debug 10",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 500,
        "wires": []
    },
    {
        "id": "417bbdcfddb2f927",
        "type": "ui_chart",
        "z": "901e2cd0c21d04eb",
        "name": "",
        "group": "9d22087fef187392",
        "order": 4,
        "width": 11,
        "height": 5,
        "label": "溫度",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "-10",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 490,
        "y": 500,
        "wires": [["d25b6b51d46d3cdc"]]
    },
    {
        "id": "021ba477fbe2deb0",
        "type": "link in",
        "z": "901e2cd0c21d04eb",
        "name": "link in 3",
        "links": ["70328a4908eb9246"],
        "x": 255,
        "y": 560,
        "wires": [["080fd540fd5440f5"]]
    },
    {
        "id": "080fd540fd5440f5",
        "type": "function",
        "z": "901e2cd0c21d04eb",
        "name": "CO",
        "func": "msg.payload = msg.payload.CO;\nmsg.topic = \"CO\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 560,
        "wires": [["16a9c311f2fe2acc"]]
    },
    {
        "id": "def339e4e7d768ed",
        "type": "debug",
        "z": "901e2cd0c21d04eb",
        "name": "debug 11",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 560,
        "wires": []
    },
    {
        "id": "16a9c311f2fe2acc",
        "type": "ui_chart",
        "z": "901e2cd0c21d04eb",
        "name": "",
        "group": "9d22087fef187392",
        "order": 7,
        "width": 14,
        "height": 4,
        "label": "CO(ppm)",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 500,
        "y": 560,
        "wires": [["def339e4e7d768ed"]]
    },
    {
        "id": "60c34ca5826278fe",
        "type": "ui_text",
        "z": "901e2cd0c21d04eb",
        "group": "9d22087fef187392",
        "order": 5,
        "width": 3,
        "height": 2,
        "name": "",
        "label": "status",
        "format": "<font face='arial'><font size=6><font color={{msg.payload.color}}>{{msg.payload.message}}",
        "layout": "col-center",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 690,
        "y": 740,
        "wires": []
    },
    {
        "id": "71c27c9edf0deab6",
        "type": "link in",
        "z": "901e2cd0c21d04eb",
        "name": "link in 4",
        "links": ["70328a4908eb9246"],
        "x": 255,
        "y": 620,
        "wires": [["a77fcecfac79dc7b"]]
    },
    {
        "id": "5726559c255126bc",
        "type": "mqtt in",
        "z": "901e2cd0c21d04eb",
        "name": "",
        "topic": "/aisleB/condition",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "4f6c8a65bb8820c6",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 160,
        "y": 180,
        "wires": [["6e9056db0d87e3e6", "376b8d6e56238da5"]]
    },
    {
        "id": "376b8d6e56238da5",
        "type": "function",
        "z": "901e2cd0c21d04eb",
        "name": "convert data",
        "func": "let { ppm, temp, battery, smoke } = msg.payload;\n\nmsg.payload = { smoke: smoke ? smoke : 0, CO: ppm ? ppm : 0, temperture: temp ? temp : 20, battery: battery ? battery : 0 };\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 180,
        "wires": [["e6f834ad3a6b7dd2"]]
    },
    {
        "id": "7268bfa2364e39f4",
        "type": "link out",
        "z": "901e2cd0c21d04eb",
        "name": "living room status",
        "mode": "link",
        "links": ["c97ad871543274fa", "478292a4ebaca8d2"],
        "x": 655,
        "y": 700,
        "wires": []
    },
    {
        "id": "bbce7a779f17ab36",
        "type": "finite-state-machine",
        "z": "901e2cd0c21d04eb",
        "name": "",
        "fsmDefinition": "{\"state\":{\"status\":\"Normal\",\"data\":{\"x\":5}},\"transitions\":{\"Normal\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Normal\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Fire\":{\"temperture\":\"Fire\",\"CO\":\"Fire\",\"smoke\":\"Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Fire\",\"expire\":\"Fire\",\"reset\":\"Normal\"},\"CO too High\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"CO too High\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Smoke Detected\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Smoke Detected\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Potential Fire\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Potential Fire\",\"expire\":\"Normal\",\"reset\":\"Normal\"}}}",
        "sendInitialState": true,
        "sendStateWithoutChange": true,
        "showTransitionErrors": true,
        "x": 310,
        "y": 740,
        "wires": [["0db0332c2be3c6af", "29c0b80fae0294ec"]]
    },
    {
        "id": "a77fcecfac79dc7b",
        "type": "function",
        "z": "901e2cd0c21d04eb",
        "name": "check transition to FSM",
        "func": "const TEMP_ERROR_LIMIT = 40; // in C\nconst CO_ERROR_LIMIT = 15; // in ppm\n\nconst { smoke, temperture, CO } = msg.payload;\nmsg.topic = \"\"\nmsg.data = {smoke, temperture, CO}\nmsg.control = {}\n\nif (temperture >= TEMP_ERROR_LIMIT) {\n    msg.topic += \"temperture\";\n}\nif (CO >= CO_ERROR_LIMIT) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"CO\";\n}\nif (smoke === 1) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"smoke\";\n} \nif (msg.topic===\"\"){\n    msg.topic = \"normal\";\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 620,
        "wires": [["bbce7a779f17ab36", "bee205b19833ca7f"]]
    },
    {
        "id": "95905b38eebb8b02",
        "type": "debug",
        "z": "901e2cd0c21d04eb",
        "name": "state",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 820,
        "wires": []
    },
    {
        "id": "bee205b19833ca7f",
        "type": "debug",
        "z": "901e2cd0c21d04eb",
        "name": "trasition",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 780,
        "y": 620,
        "wires": []
    },
    {
        "id": "7414b91d6ef23861",
        "type": "inject",
        "z": "901e2cd0c21d04eb",
        "name": "reset",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "reset",
        "payload": "",
        "payloadType": "date",
        "x": 90,
        "y": 740,
        "wires": [["bbce7a779f17ab36"]]
    },
    {
        "id": "0db0332c2be3c6af",
        "type": "function",
        "z": "901e2cd0c21d04eb",
        "name": "function 3",
        "func": "msg.state_color = {\n    \"Normal\": \"green\",\n    \"Fire\": \"red\",\n    \"CO too High\": \"orange\",\n    \"Smoke Detected\": \"orange\",\n    \"Potential Fire\": \"orange\"\n}\nmsg.payload = {\n    place: \"aisleB\",\n    message: msg.payload.status,\n    color: msg.state_color[msg.payload.status]\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 740,
        "wires": [
            [
                "95905b38eebb8b02",
                "60c34ca5826278fe",
                "7268bfa2364e39f4",
                "9140810947c0550d"
            ]
        ]
    },
    {
        "id": "29c0b80fae0294ec",
        "type": "debug",
        "z": "901e2cd0c21d04eb",
        "name": "debug 14",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 460,
        "y": 820,
        "wires": []
    },
    {
        "id": "003e21b20e879979",
        "type": "line-notify",
        "z": "901e2cd0c21d04eb",
        "d": true,
        "name": "test YCK",
        "message": "",
        "contentType": "message",
        "imageThumbnail": "",
        "imageUrl": "",
        "sticker": "default",
        "stickerPackageId": "1",
        "stickerId": "1",
        "silent": false,
        "creds": "63115de6b1972cd9",
        "x": 980,
        "y": 920,
        "wires": [[]]
    },
    {
        "id": "f1d47fbda1627671",
        "type": "inject",
        "z": "901e2cd0c21d04eb",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 270,
        "y": 920,
        "wires": [["9140810947c0550d"]]
    },
    {
        "id": "9140810947c0550d",
        "type": "rbe",
        "z": "901e2cd0c21d04eb",
        "name": "block the same value",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": true,
        "property": "payload",
        "topi": "topic",
        "x": 600,
        "y": 920,
        "wires": [["affda3034bf1be0e"]]
    },
    {
        "id": "affda3034bf1be0e",
        "type": "function",
        "z": "901e2cd0c21d04eb",
        "name": "modify message",
        "func": "const place = \"aisle B\"\nif (msg.payload.message==\"Normal\"){\n    return;\n}\nmsg.payload = \"\\n注意！\\n\" + place + \": \" + msg.payload.message\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 920,
        "wires": [["003e21b20e879979"]]
    },
    {
        "id": "81fc66e31adcb0f5",
        "type": "ui_ui_control",
        "z": "901e2cd0c21d04eb",
        "name": "navigation",
        "events": "all",
        "x": 530,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "8c608771e3fcec85",
        "type": "ui_template",
        "z": "901e2cd0c21d04eb",
        "group": "9d22087fef187392",
        "name": "Back Home",
        "order": 2,
        "width": 2,
        "height": 1,
        "format": "<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#e67e22\"\n    ng-click=\"send({payload: 'Home'})\">\n    Back\n</md-button>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 370,
        "y": 1020,
        "wires": [["81fc66e31adcb0f5"]]
    },
    {
        "id": "2a373ff96b64b67f",
        "type": "ui_template",
        "z": "901e2cd0c21d04eb",
        "group": "dc87ea581ec639fa",
        "name": "button css",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<style>\n  * {\n      overflow: hidden;\n  }\n  .filled { \n      height: 90% !important;\n      width: 90% !important;\n      padding: 0 !important;\n      margin: 4% !important;\n  }\n  .nr-dashboard-template {\n      padding: 0;\n      margin: 0;\n  }\n  \n  .rounded {\n  border-radius: 12px 12px 12px 12px;\n}\n \n   .bigfont {\n  font-size: 18px;\n}\n\n   .smallfont {\n  font-size: 12px;\n}\n  \n</style>\n\n<script>\n$('.vibrate').on('click', function() {\n  navigator.vibrate(100);\n});\n\nfunction restore_bg(x) {\n            $(this).css(\"background-color\", x);\n    };\n\n$('.touched').on('mousedown', function() {\n    \n    var x= $(this).css(\"background-color\");\n    $(this).css(\"background-color\", \"yellow\");\n    \n    setTimeout(restore_bg.bind(this,x),100);\n    navigator.vibrate(80);\n    });\n    \n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "global",
        "className": "",
        "x": 190,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "ea357cbe38a682ff",
        "type": "inject",
        "z": "901e2cd0c21d04eb",
        "name": "normal",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":8,\"temperture\":30,\"battery\":0}",
        "payloadType": "json",
        "x": 200,
        "y": 220,
        "wires": [["dbf559a93eaa088a"]]
    },
    {
        "id": "4b889ba8227ef291",
        "type": "inject",
        "z": "901e2cd0c21d04eb",
        "name": "smoke",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":1,\"CO\":8,\"temperture\":30}",
        "payloadType": "json",
        "x": 190,
        "y": 260,
        "wires": [["dbf559a93eaa088a"]]
    },
    {
        "id": "f64b39c0ff457675",
        "type": "inject",
        "z": "901e2cd0c21d04eb",
        "name": "CO",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":30}",
        "payloadType": "json",
        "x": 190,
        "y": 300,
        "wires": [["dbf559a93eaa088a"]]
    },
    {
        "id": "9f0d2bdaf17282ca",
        "type": "inject",
        "z": "901e2cd0c21d04eb",
        "name": "fire",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":45}",
        "payloadType": "json",
        "x": 190,
        "y": 340,
        "wires": [["dbf559a93eaa088a"]]
    },
    {
        "id": "dbf559a93eaa088a",
        "type": "delay",
        "z": "901e2cd0c21d04eb",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 410,
        "y": 280,
        "wires": [["e6f834ad3a6b7dd2"]]
    },
    {
        "id": "2721a9c1e0838997",
        "type": "link in",
        "z": "901e2cd0c21d04eb",
        "name": "all reset",
        "links": ["1765ee585273167c"],
        "x": 135,
        "y": 800,
        "wires": [["bbce7a779f17ab36"]]
    },
    {
        "id": "a1396e32f89cf206",
        "type": "link in",
        "z": "901e2cd0c21d04eb",
        "name": "reset",
        "links": ["1765ee585273167c"],
        "x": 95,
        "y": 380,
        "wires": [["7d0433d994d25b93"]]
    },
    {
        "id": "7d0433d994d25b93",
        "type": "function",
        "z": "901e2cd0c21d04eb",
        "name": "reset normal",
        "func": "msg.payload = { \"smoke\": 0, \"CO\": 8, \"temperture\": 30 }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 210,
        "y": 380,
        "wires": [["dbf559a93eaa088a"]]
    },
    {
        "id": "83e4bd305fdaa64f",
        "type": "ui_ui_control",
        "z": "901e2cd0c21d04eb",
        "name": "",
        "events": "all",
        "x": 80,
        "y": 840,
        "wires": [["4692d0caa762ad03"]]
    },
    {
        "id": "4692d0caa762ad03",
        "type": "function",
        "z": "901e2cd0c21d04eb",
        "name": "trigger when chage page",
        "func": "msg.topic = \"normal\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 270,
        "y": 840,
        "wires": [["bbce7a779f17ab36"]]
    },
    {
        "id": "52d3c5b43339b764",
        "type": "ui_template",
        "z": "901e2cd0c21d04eb",
        "group": "9d22087fef187392",
        "name": "煙霧顯示",
        "order": 6,
        "width": 3,
        "height": 2,
        "format": "<div id=\"graphics\" ng-init=\"checkSVG()\" style=\"display: flex; justify-content:center;align-items:center\">\n    <p id=\"e1_text\">煙霧</p>\n    <svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0\" y=\"0\" height=\"34\"\n        viewBox=\"0 0 34 34\" width=\"34\" preserveAspectRatio=\"xMidYMid meet\">\n        <circle id=\"e1_circle\" cx=\"17\" cy=\"17\" style=\"fill:green;stroke-width:0px;overflow:hidden\" r=\"16\" />\n    </svg>\n    <script>\n        (function($scope) {\n                $scope.$watch('msg', function() {\n                    if (!$scope.msg) return;\n                    const color=$scope.msg.payload?.color;\n                    const topic=$scope.msg.topic;\n                    if (color === undefined || color === null ||\n                        !topic || typeof topic !== 'string' || !topic.includes('@')) return;\n                    const id = topic.split('@')[0], cxType = topic.split('@')[1];\n                    document.getElementById(id+\"_circle\").style.fill=color;\n                    document.getElementById(id+\"_text\").style.cssText = `color:${color} !important;font-weight:bold` ;\n                });\n            })(scope);\n    </script>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 500,
        "y": 440,
        "wires": [["f4787284cebff631"]]
    },
    {
        "id": "7c927caf6d445114",
        "type": "ui_template",
        "z": "901e2cd0c21d04eb",
        "group": "9d22087fef187392",
        "name": "power icon",
        "order": 3,
        "width": 1,
        "height": 1,
        "format": "<div style=\"display: flex; justify-content:center;align-items:center;height: auto; width: auto\">\n    <img id=\"battery\" style=\"height: auto; width: auto;display: none\" src=\"/half-battery.png\">\n    <img id=\"charging\" style=\"height: auto; width: auto;display: block\" src=\"/low-battery.png\">\n</div>\n\n<script>\n    (function($scope) {\n        $scope.$watch('msg', function() {\n            if (!$scope.msg) return;\n            const battery=$scope.msg.payload?.battery;\n            // console.log(battery);\n            if(battery){\n                $(\"#battery\").css(\"display\",battery?\"block\":\"none\");\n                $(\"#charging\").css(\"display\",battery?\"none\":\"block\");\n            }\n        });\n    })(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 510,
        "y": 400,
        "wires": [[]]
    },
    {
        "id": "6ddd5fb3c19b694b",
        "type": "link in",
        "z": "901e2cd0c21d04eb",
        "name": "link in 7",
        "links": ["70328a4908eb9246"],
        "x": 365,
        "y": 400,
        "wires": [["7c927caf6d445114"]]
    },
    {
        "id": "e6f834ad3a6b7dd2",
        "type": "function",
        "z": "901e2cd0c21d04eb",
        "name": "add node information",
        "func": "msg.payload.place = \"aisleB\";\nmsg.payload.time = Date.now();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 740,
        "y": 200,
        "wires": [["70328a4908eb9246"]]
    },
    {
        "id": "2c6bf6db86881a2c",
        "type": "comment",
        "z": "901e2cd0c21d04eb",
        "name": "改place",
        "info": "改place",
        "x": 510,
        "y": 700,
        "wires": []
    },
    {
        "id": "ed5db6c7ad02a0f9",
        "type": "comment",
        "z": "901e2cd0c21d04eb",
        "name": "改place",
        "info": "改place",
        "x": 748.3333129882812,
        "y": 166.3333282470703,
        "wires": []
    },
    {
        "id": "947e1040c4583610",
        "type": "comment",
        "z": "901e2cd0c21d04eb",
        "name": "改place",
        "info": "改place",
        "x": 97.33332824707031,
        "y": 146.3333282470703,
        "wires": []
    },
    {
        "id": "0f049a7bfaaf477e",
        "type": "comment",
        "z": "901e2cd0c21d04eb",
        "name": "改place",
        "info": "改place",
        "x": 842.3333129882812,
        "y": 885.3333740234375,
        "wires": []
    },
    {
        "id": "394bd2140d9cb159",
        "type": "comment",
        "z": "901e2cd0c21d04eb",
        "name": "改group",
        "info": "",
        "x": 390,
        "y": 980,
        "wires": []
    },
    {
        "id": "cb62402437b69d75",
        "type": "comment",
        "z": "901e2cd0c21d04eb",
        "name": "改group",
        "info": "",
        "x": 750,
        "y": 700,
        "wires": []
    },
    {
        "id": "555e0f2dbabb0793",
        "type": "comment",
        "z": "901e2cd0c21d04eb",
        "name": "改group",
        "info": "",
        "x": 530,
        "y": 360,
        "wires": []
    },
    {
        "id": "c3f19a4e5860b663",
        "type": "random",
        "z": "d1a1753721bf8ad1",
        "name": "偵煙器",
        "low": "0",
        "high": "1",
        "inte": "true",
        "property": "payload",
        "x": 230,
        "y": 40,
        "wires": [["a1bb584bc7bc4c6b"]]
    },
    {
        "id": "5465be4dbb9964e7",
        "type": "random",
        "z": "d1a1753721bf8ad1",
        "name": "CO(ppm)",
        "low": "0",
        "high": 10,
        "inte": "false",
        "property": "payload",
        "x": 240,
        "y": 80,
        "wires": [["79298a28fe3ec385"]]
    },
    {
        "id": "22ae42c98239f6c3",
        "type": "random",
        "z": "d1a1753721bf8ad1",
        "name": "溫度",
        "low": "-10",
        "high": "50",
        "inte": "false",
        "property": "payload",
        "x": 230,
        "y": 120,
        "wires": [["557fcdd4f6f12b5f"]]
    },
    {
        "id": "73575bfb06e4797b",
        "type": "join",
        "z": "d1a1753721bf8ad1",
        "name": "",
        "mode": "custom",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "1",
        "count": "3",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 550,
        "y": 80,
        "wires": [["09b31f5772d2fa57"]]
    },
    {
        "id": "113af3b060bff100",
        "type": "debug",
        "z": "d1a1753721bf8ad1",
        "name": "combine",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 400,
        "y": 220,
        "wires": []
    },
    {
        "id": "a1bb584bc7bc4c6b",
        "type": "change",
        "z": "d1a1753721bf8ad1",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "smoke",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 40,
        "wires": [["73575bfb06e4797b"]]
    },
    {
        "id": "79298a28fe3ec385",
        "type": "change",
        "z": "d1a1753721bf8ad1",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "CO",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 80,
        "wires": [["73575bfb06e4797b"]]
    },
    {
        "id": "557fcdd4f6f12b5f",
        "type": "change",
        "z": "d1a1753721bf8ad1",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperture",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 120,
        "wires": [["73575bfb06e4797b"]]
    },
    {
        "id": "cf73b48457279c5e",
        "type": "inject",
        "z": "d1a1753721bf8ad1",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 70,
        "y": 80,
        "wires": [["c3f19a4e5860b663", "5465be4dbb9964e7", "22ae42c98239f6c3"]]
    },
    {
        "id": "10f3cc895326e4ea",
        "type": "link out",
        "z": "d1a1753721bf8ad1",
        "name": "link out 1",
        "mode": "link",
        "links": [
            "20fe92d63e6091db",
            "fe0f438269839327",
            "30ebac68058dea21",
            "5c929a350e841c70",
            "22b7b90de5f52226"
        ],
        "x": 895,
        "y": 200,
        "wires": []
    },
    {
        "id": "20fe92d63e6091db",
        "type": "link in",
        "z": "d1a1753721bf8ad1",
        "name": "link in 1",
        "links": ["10f3cc895326e4ea"],
        "x": 255,
        "y": 440,
        "wires": [["6e295efdd0e5417b"]]
    },
    {
        "id": "6e295efdd0e5417b",
        "type": "function",
        "z": "d1a1753721bf8ad1",
        "name": "function 2",
        "func": "if(msg.payload.smoke===0){\n    msg.payload.color =\"#008000\"; //\"green\";\n}else{\n    msg.payload.color = \"#b22222\"; // \"firebrick\";\n}\nmsg.topic = \"e1@cx_color\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 440,
        "wires": [["c02aa5e69b8f6e5a"]]
    },
    {
        "id": "0c56b1c438c04582",
        "type": "debug",
        "z": "d1a1753721bf8ad1",
        "name": "debug 9",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 440,
        "wires": []
    },
    {
        "id": "fe0f438269839327",
        "type": "link in",
        "z": "d1a1753721bf8ad1",
        "name": "link in 2",
        "links": ["10f3cc895326e4ea"],
        "x": 255,
        "y": 500,
        "wires": [["c462a41ee57132d1"]]
    },
    {
        "id": "c462a41ee57132d1",
        "type": "function",
        "z": "d1a1753721bf8ad1",
        "name": "溫度",
        "func": "msg.payload = msg.payload.temperture;\nmsg.topic = \"temperture\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 500,
        "wires": [["eca59e84c5e8a037"]]
    },
    {
        "id": "75a63a2dc535b214",
        "type": "debug",
        "z": "d1a1753721bf8ad1",
        "name": "debug 10",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 500,
        "wires": []
    },
    {
        "id": "eca59e84c5e8a037",
        "type": "ui_chart",
        "z": "d1a1753721bf8ad1",
        "name": "",
        "group": "2cfd868ec03347d9",
        "order": 4,
        "width": 11,
        "height": 5,
        "label": "溫度",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "-10",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 490,
        "y": 500,
        "wires": [["75a63a2dc535b214"]]
    },
    {
        "id": "30ebac68058dea21",
        "type": "link in",
        "z": "d1a1753721bf8ad1",
        "name": "link in 3",
        "links": ["10f3cc895326e4ea"],
        "x": 255,
        "y": 560,
        "wires": [["632a6c4f8d168f94"]]
    },
    {
        "id": "632a6c4f8d168f94",
        "type": "function",
        "z": "d1a1753721bf8ad1",
        "name": "CO",
        "func": "msg.payload = msg.payload.CO;\nmsg.topic = \"CO\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 560,
        "wires": [["4458c139761d9b39"]]
    },
    {
        "id": "25274ee4771fa17d",
        "type": "debug",
        "z": "d1a1753721bf8ad1",
        "name": "debug 11",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 560,
        "wires": []
    },
    {
        "id": "4458c139761d9b39",
        "type": "ui_chart",
        "z": "d1a1753721bf8ad1",
        "name": "",
        "group": "2cfd868ec03347d9",
        "order": 7,
        "width": 14,
        "height": 4,
        "label": "CO(ppm)",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 500,
        "y": 560,
        "wires": [["25274ee4771fa17d"]]
    },
    {
        "id": "5f33daefe939b4ac",
        "type": "ui_text",
        "z": "d1a1753721bf8ad1",
        "group": "2cfd868ec03347d9",
        "order": 5,
        "width": 3,
        "height": 2,
        "name": "",
        "label": "status",
        "format": "<font face='arial'><font size=6><font color={{msg.payload.color}}>{{msg.payload.message}}",
        "layout": "col-center",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 690,
        "y": 740,
        "wires": []
    },
    {
        "id": "5c929a350e841c70",
        "type": "link in",
        "z": "d1a1753721bf8ad1",
        "name": "link in 4",
        "links": ["10f3cc895326e4ea"],
        "x": 255,
        "y": 620,
        "wires": [["f4283de9f3177414"]]
    },
    {
        "id": "342335504558fde6",
        "type": "mqtt in",
        "z": "d1a1753721bf8ad1",
        "name": "",
        "topic": "/aisleC/condition",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "4f6c8a65bb8820c6",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 160,
        "y": 180,
        "wires": [["113af3b060bff100", "6f81899c59f5ca14"]]
    },
    {
        "id": "6f81899c59f5ca14",
        "type": "function",
        "z": "d1a1753721bf8ad1",
        "name": "convert data",
        "func": "let { ppm, temp, battery, smoke } = msg.payload;\n\nmsg.payload = { smoke: smoke ? smoke : 0, CO: ppm ? ppm : 0, temperture: temp ? temp : 20, battery: battery ? battery : 0 };\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 180,
        "wires": [["09b31f5772d2fa57"]]
    },
    {
        "id": "2d62b9078b8d0cac",
        "type": "link out",
        "z": "d1a1753721bf8ad1",
        "name": "living room status",
        "mode": "link",
        "links": ["c97ad871543274fa", "478292a4ebaca8d2"],
        "x": 655,
        "y": 700,
        "wires": []
    },
    {
        "id": "588001ed01f738c4",
        "type": "finite-state-machine",
        "z": "d1a1753721bf8ad1",
        "name": "",
        "fsmDefinition": "{\"state\":{\"status\":\"Normal\",\"data\":{\"x\":5}},\"transitions\":{\"Normal\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Normal\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Fire\":{\"temperture\":\"Fire\",\"CO\":\"Fire\",\"smoke\":\"Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Fire\",\"expire\":\"Fire\",\"reset\":\"Normal\"},\"CO too High\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"CO too High\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Smoke Detected\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Smoke Detected\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Potential Fire\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Potential Fire\",\"expire\":\"Normal\",\"reset\":\"Normal\"}}}",
        "sendInitialState": true,
        "sendStateWithoutChange": true,
        "showTransitionErrors": true,
        "x": 310,
        "y": 740,
        "wires": [["87673d427c93236a", "052481e04cc28409"]]
    },
    {
        "id": "f4283de9f3177414",
        "type": "function",
        "z": "d1a1753721bf8ad1",
        "name": "check transition to FSM",
        "func": "const TEMP_ERROR_LIMIT = 40; // in C\nconst CO_ERROR_LIMIT = 15; // in ppm\n\nconst { smoke, temperture, CO } = msg.payload;\nmsg.topic = \"\"\nmsg.data = {smoke, temperture, CO}\nmsg.control = {}\n\nif (temperture >= TEMP_ERROR_LIMIT) {\n    msg.topic += \"temperture\";\n}\nif (CO >= CO_ERROR_LIMIT) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"CO\";\n}\nif (smoke === 1) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"smoke\";\n} \nif (msg.topic===\"\"){\n    msg.topic = \"normal\";\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 620,
        "wires": [["588001ed01f738c4", "6f66d5411dd0ca24"]]
    },
    {
        "id": "dd80b730c7818be5",
        "type": "debug",
        "z": "d1a1753721bf8ad1",
        "name": "state",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 820,
        "wires": []
    },
    {
        "id": "6f66d5411dd0ca24",
        "type": "debug",
        "z": "d1a1753721bf8ad1",
        "name": "trasition",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 780,
        "y": 620,
        "wires": []
    },
    {
        "id": "1f6c756f246efcee",
        "type": "inject",
        "z": "d1a1753721bf8ad1",
        "name": "reset",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "reset",
        "payload": "",
        "payloadType": "date",
        "x": 90,
        "y": 740,
        "wires": [["588001ed01f738c4"]]
    },
    {
        "id": "87673d427c93236a",
        "type": "function",
        "z": "d1a1753721bf8ad1",
        "name": "function 3",
        "func": "msg.state_color = {\n    \"Normal\": \"green\",\n    \"Fire\": \"red\",\n    \"CO too High\": \"orange\",\n    \"Smoke Detected\": \"orange\",\n    \"Potential Fire\": \"orange\"\n}\nmsg.payload = {\n    place: \"aisleC\",\n    message: msg.payload.status,\n    color: msg.state_color[msg.payload.status]\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 740,
        "wires": [
            [
                "dd80b730c7818be5",
                "5f33daefe939b4ac",
                "2d62b9078b8d0cac",
                "6b8e41589f8d4494"
            ]
        ]
    },
    {
        "id": "052481e04cc28409",
        "type": "debug",
        "z": "d1a1753721bf8ad1",
        "name": "debug 14",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 460,
        "y": 820,
        "wires": []
    },
    {
        "id": "0e9c5e9574d39a6a",
        "type": "line-notify",
        "z": "d1a1753721bf8ad1",
        "d": true,
        "name": "test YCK",
        "message": "",
        "contentType": "message",
        "imageThumbnail": "",
        "imageUrl": "",
        "sticker": "default",
        "stickerPackageId": "1",
        "stickerId": "1",
        "silent": false,
        "creds": "63115de6b1972cd9",
        "x": 980,
        "y": 920,
        "wires": [[]]
    },
    {
        "id": "23251dd2a1e65261",
        "type": "inject",
        "z": "d1a1753721bf8ad1",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 270,
        "y": 920,
        "wires": [["6b8e41589f8d4494"]]
    },
    {
        "id": "6b8e41589f8d4494",
        "type": "rbe",
        "z": "d1a1753721bf8ad1",
        "name": "block the same value",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": true,
        "property": "payload",
        "topi": "topic",
        "x": 600,
        "y": 920,
        "wires": [["205c44c4e638a396"]]
    },
    {
        "id": "205c44c4e638a396",
        "type": "function",
        "z": "d1a1753721bf8ad1",
        "name": "modify message",
        "func": "const place = \"aisle C\"\nif (msg.payload.message==\"Normal\"){\n    return;\n}\nmsg.payload = \"\\n注意！\\n\" + place + \": \" + msg.payload.message\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 920,
        "wires": [["0e9c5e9574d39a6a"]]
    },
    {
        "id": "b3a94719700b0380",
        "type": "ui_ui_control",
        "z": "d1a1753721bf8ad1",
        "name": "navigation",
        "events": "all",
        "x": 530,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "3685571fab18e978",
        "type": "ui_template",
        "z": "d1a1753721bf8ad1",
        "group": "2cfd868ec03347d9",
        "name": "Back Home",
        "order": 2,
        "width": 2,
        "height": 1,
        "format": "<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#e67e22\"\n    ng-click=\"send({payload: 'Home'})\">\n    Back\n</md-button>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 370,
        "y": 1020,
        "wires": [["b3a94719700b0380"]]
    },
    {
        "id": "346914fe3748fcdd",
        "type": "ui_template",
        "z": "d1a1753721bf8ad1",
        "group": "dc87ea581ec639fa",
        "name": "button css",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<style>\n  * {\n      overflow: hidden;\n  }\n  .filled { \n      height: 90% !important;\n      width: 90% !important;\n      padding: 0 !important;\n      margin: 4% !important;\n  }\n  .nr-dashboard-template {\n      padding: 0;\n      margin: 0;\n  }\n  \n  .rounded {\n  border-radius: 12px 12px 12px 12px;\n}\n \n   .bigfont {\n  font-size: 18px;\n}\n\n   .smallfont {\n  font-size: 12px;\n}\n  \n</style>\n\n<script>\n$('.vibrate').on('click', function() {\n  navigator.vibrate(100);\n});\n\nfunction restore_bg(x) {\n            $(this).css(\"background-color\", x);\n    };\n\n$('.touched').on('mousedown', function() {\n    \n    var x= $(this).css(\"background-color\");\n    $(this).css(\"background-color\", \"yellow\");\n    \n    setTimeout(restore_bg.bind(this,x),100);\n    navigator.vibrate(80);\n    });\n    \n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "global",
        "className": "",
        "x": 190,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "7058c1c7fe2e7b86",
        "type": "inject",
        "z": "d1a1753721bf8ad1",
        "name": "normal",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":8,\"temperture\":30,\"battery\":0}",
        "payloadType": "json",
        "x": 200,
        "y": 220,
        "wires": [["c0e9377efbfd6d57"]]
    },
    {
        "id": "f99f1772dfa004e1",
        "type": "inject",
        "z": "d1a1753721bf8ad1",
        "name": "smoke",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":1,\"CO\":8,\"temperture\":30}",
        "payloadType": "json",
        "x": 190,
        "y": 260,
        "wires": [["c0e9377efbfd6d57"]]
    },
    {
        "id": "55c312ec7f7d6b98",
        "type": "inject",
        "z": "d1a1753721bf8ad1",
        "name": "CO",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":30}",
        "payloadType": "json",
        "x": 190,
        "y": 300,
        "wires": [["c0e9377efbfd6d57"]]
    },
    {
        "id": "f556ad723a4fbbc9",
        "type": "inject",
        "z": "d1a1753721bf8ad1",
        "name": "fire",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":45}",
        "payloadType": "json",
        "x": 190,
        "y": 340,
        "wires": [["c0e9377efbfd6d57"]]
    },
    {
        "id": "c0e9377efbfd6d57",
        "type": "delay",
        "z": "d1a1753721bf8ad1",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 410,
        "y": 280,
        "wires": [["09b31f5772d2fa57"]]
    },
    {
        "id": "67fa57f5f5ca45b2",
        "type": "link in",
        "z": "d1a1753721bf8ad1",
        "name": "all reset",
        "links": ["1765ee585273167c"],
        "x": 135,
        "y": 800,
        "wires": [["588001ed01f738c4"]]
    },
    {
        "id": "8e199961ae921715",
        "type": "link in",
        "z": "d1a1753721bf8ad1",
        "name": "reset",
        "links": ["1765ee585273167c"],
        "x": 95,
        "y": 380,
        "wires": [["8c26eff3cbd52225"]]
    },
    {
        "id": "8c26eff3cbd52225",
        "type": "function",
        "z": "d1a1753721bf8ad1",
        "name": "reset normal",
        "func": "msg.payload = { \"smoke\": 0, \"CO\": 8, \"temperture\": 30 }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 210,
        "y": 380,
        "wires": [["c0e9377efbfd6d57"]]
    },
    {
        "id": "1bf99e8f33415dd3",
        "type": "ui_ui_control",
        "z": "d1a1753721bf8ad1",
        "name": "",
        "events": "all",
        "x": 80,
        "y": 840,
        "wires": [["3251a0521c0af790"]]
    },
    {
        "id": "3251a0521c0af790",
        "type": "function",
        "z": "d1a1753721bf8ad1",
        "name": "trigger when chage page",
        "func": "msg.topic = \"normal\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 270,
        "y": 840,
        "wires": [["588001ed01f738c4"]]
    },
    {
        "id": "c02aa5e69b8f6e5a",
        "type": "ui_template",
        "z": "d1a1753721bf8ad1",
        "group": "2cfd868ec03347d9",
        "name": "煙霧顯示",
        "order": 6,
        "width": 3,
        "height": 2,
        "format": "<div id=\"graphics\" ng-init=\"checkSVG()\" style=\"display: flex; justify-content:center;align-items:center\">\n    <p id=\"e1_text\">煙霧</p>\n    <svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0\" y=\"0\" height=\"34\"\n        viewBox=\"0 0 34 34\" width=\"34\" preserveAspectRatio=\"xMidYMid meet\">\n        <circle id=\"e1_circle\" cx=\"17\" cy=\"17\" style=\"fill:green;stroke-width:0px;overflow:hidden\" r=\"16\" />\n    </svg>\n    <script>\n        (function($scope) {\n                $scope.$watch('msg', function() {\n                    if (!$scope.msg) return;\n                    const color=$scope.msg.payload?.color;\n                    const topic=$scope.msg.topic;\n                    if (color === undefined || color === null ||\n                        !topic || typeof topic !== 'string' || !topic.includes('@')) return;\n                    const id = topic.split('@')[0], cxType = topic.split('@')[1];\n                    document.getElementById(id+\"_circle\").style.fill=color;\n                    document.getElementById(id+\"_text\").style.cssText = `color:${color} !important;font-weight:bold` ;\n                });\n            })(scope);\n    </script>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 500,
        "y": 440,
        "wires": [["0c56b1c438c04582"]]
    },
    {
        "id": "164af25a3e832bbf",
        "type": "ui_template",
        "z": "d1a1753721bf8ad1",
        "group": "2cfd868ec03347d9",
        "name": "power icon",
        "order": 3,
        "width": 1,
        "height": 1,
        "format": "<div style=\"display: flex; justify-content:center;align-items:center;height: auto; width: auto\">\n    <img id=\"battery\" style=\"height: auto; width: auto;display: none\" src=\"/half-battery.png\">\n    <img id=\"charging\" style=\"height: auto; width: auto;display: block\" src=\"/low-battery.png\">\n</div>\n\n<script>\n    (function($scope) {\n        $scope.$watch('msg', function() {\n            if (!$scope.msg) return;\n            const battery=$scope.msg.payload?.battery;\n            // console.log(battery);\n            if(battery){\n                $(\"#battery\").css(\"display\",battery?\"block\":\"none\");\n                $(\"#charging\").css(\"display\",battery?\"none\":\"block\");\n            }\n        });\n    })(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 510,
        "y": 400,
        "wires": [[]]
    },
    {
        "id": "22b7b90de5f52226",
        "type": "link in",
        "z": "d1a1753721bf8ad1",
        "name": "link in 7",
        "links": ["10f3cc895326e4ea"],
        "x": 365,
        "y": 400,
        "wires": [["164af25a3e832bbf"]]
    },
    {
        "id": "09b31f5772d2fa57",
        "type": "function",
        "z": "d1a1753721bf8ad1",
        "name": "add node information",
        "func": "msg.payload.place = \"aisleC\";\nmsg.payload.time = Date.now();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 740,
        "y": 200,
        "wires": [["10f3cc895326e4ea"]]
    },
    {
        "id": "1dc763f17849b1ef",
        "type": "comment",
        "z": "d1a1753721bf8ad1",
        "name": "改place",
        "info": "改place",
        "x": 510,
        "y": 700,
        "wires": []
    },
    {
        "id": "1fb5613b326b7eb1",
        "type": "comment",
        "z": "d1a1753721bf8ad1",
        "name": "改place",
        "info": "改place",
        "x": 748.3333129882812,
        "y": 166.3333282470703,
        "wires": []
    },
    {
        "id": "6bc58b787e7ba528",
        "type": "comment",
        "z": "d1a1753721bf8ad1",
        "name": "改place",
        "info": "改place",
        "x": 97.33332824707031,
        "y": 146.3333282470703,
        "wires": []
    },
    {
        "id": "0b77fa850190c690",
        "type": "comment",
        "z": "d1a1753721bf8ad1",
        "name": "改place",
        "info": "改place",
        "x": 842.3333129882812,
        "y": 885.3333740234375,
        "wires": []
    },
    {
        "id": "8313272399aa4c34",
        "type": "comment",
        "z": "d1a1753721bf8ad1",
        "name": "改group",
        "info": "",
        "x": 390,
        "y": 980,
        "wires": []
    },
    {
        "id": "fa444512457ab47f",
        "type": "comment",
        "z": "d1a1753721bf8ad1",
        "name": "改group",
        "info": "",
        "x": 750,
        "y": 700,
        "wires": []
    },
    {
        "id": "3cf5bc179cb17667",
        "type": "comment",
        "z": "d1a1753721bf8ad1",
        "name": "改group",
        "info": "",
        "x": 530,
        "y": 360,
        "wires": []
    },
    {
        "id": "33ed107e171e9a3e",
        "type": "random",
        "z": "57c7b1d92e451835",
        "name": "偵煙器",
        "low": "0",
        "high": "1",
        "inte": "true",
        "property": "payload",
        "x": 230,
        "y": 40,
        "wires": [["70c7b160c71f895a"]]
    },
    {
        "id": "ac78907d257d775b",
        "type": "random",
        "z": "57c7b1d92e451835",
        "name": "CO(ppm)",
        "low": "0",
        "high": 10,
        "inte": "false",
        "property": "payload",
        "x": 240,
        "y": 80,
        "wires": [["2f8dc254378a8cf0"]]
    },
    {
        "id": "cc3f19b6f1e87f13",
        "type": "random",
        "z": "57c7b1d92e451835",
        "name": "溫度",
        "low": "-10",
        "high": "50",
        "inte": "false",
        "property": "payload",
        "x": 230,
        "y": 120,
        "wires": [["60d647b962a0d5e7"]]
    },
    {
        "id": "311748186db4b96f",
        "type": "join",
        "z": "57c7b1d92e451835",
        "name": "",
        "mode": "custom",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "1",
        "count": "3",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 550,
        "y": 80,
        "wires": [["5c95aa95ad46e1ea"]]
    },
    {
        "id": "8c45b70d2a80fc60",
        "type": "debug",
        "z": "57c7b1d92e451835",
        "name": "combine",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 400,
        "y": 220,
        "wires": []
    },
    {
        "id": "70c7b160c71f895a",
        "type": "change",
        "z": "57c7b1d92e451835",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "smoke",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 40,
        "wires": [["311748186db4b96f"]]
    },
    {
        "id": "2f8dc254378a8cf0",
        "type": "change",
        "z": "57c7b1d92e451835",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "CO",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 80,
        "wires": [["311748186db4b96f"]]
    },
    {
        "id": "60d647b962a0d5e7",
        "type": "change",
        "z": "57c7b1d92e451835",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperture",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 120,
        "wires": [["311748186db4b96f"]]
    },
    {
        "id": "258b753eadccd855",
        "type": "inject",
        "z": "57c7b1d92e451835",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 70,
        "y": 80,
        "wires": [["33ed107e171e9a3e", "ac78907d257d775b", "cc3f19b6f1e87f13"]]
    },
    {
        "id": "3c9bec707a983094",
        "type": "link out",
        "z": "57c7b1d92e451835",
        "name": "link out 1",
        "mode": "link",
        "links": [
            "4fdd8c08b8af2238",
            "c295ab92ff8718ca",
            "11abe27090e01121",
            "33bfcfa9dd06b68e",
            "32ad5eee10b8ea6e"
        ],
        "x": 895,
        "y": 200,
        "wires": []
    },
    {
        "id": "4fdd8c08b8af2238",
        "type": "link in",
        "z": "57c7b1d92e451835",
        "name": "link in 1",
        "links": ["3c9bec707a983094"],
        "x": 255,
        "y": 440,
        "wires": [["d8aad97e02942f72"]]
    },
    {
        "id": "d8aad97e02942f72",
        "type": "function",
        "z": "57c7b1d92e451835",
        "name": "function 2",
        "func": "if(msg.payload.smoke===0){\n    msg.payload.color =\"#008000\"; //\"green\";\n}else{\n    msg.payload.color = \"#b22222\"; // \"firebrick\";\n}\nmsg.topic = \"e1@cx_color\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 440,
        "wires": [["e9e9b9c5aad4d6dc"]]
    },
    {
        "id": "be5d4f55e3148de6",
        "type": "debug",
        "z": "57c7b1d92e451835",
        "name": "debug 9",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 440,
        "wires": []
    },
    {
        "id": "c295ab92ff8718ca",
        "type": "link in",
        "z": "57c7b1d92e451835",
        "name": "link in 2",
        "links": ["3c9bec707a983094"],
        "x": 255,
        "y": 500,
        "wires": [["7efec9a468557198"]]
    },
    {
        "id": "7efec9a468557198",
        "type": "function",
        "z": "57c7b1d92e451835",
        "name": "溫度",
        "func": "msg.payload = msg.payload.temperture;\nmsg.topic = \"temperture\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 500,
        "wires": [["30ab38f549c973bc"]]
    },
    {
        "id": "75e4700fd04159dc",
        "type": "debug",
        "z": "57c7b1d92e451835",
        "name": "debug 10",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 500,
        "wires": []
    },
    {
        "id": "30ab38f549c973bc",
        "type": "ui_chart",
        "z": "57c7b1d92e451835",
        "name": "",
        "group": "96e7171c97b237eb",
        "order": 4,
        "width": 11,
        "height": 5,
        "label": "溫度",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "-10",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 490,
        "y": 500,
        "wires": [["75e4700fd04159dc"]]
    },
    {
        "id": "11abe27090e01121",
        "type": "link in",
        "z": "57c7b1d92e451835",
        "name": "link in 3",
        "links": ["3c9bec707a983094"],
        "x": 255,
        "y": 560,
        "wires": [["c7bc6f3ecd2017dc"]]
    },
    {
        "id": "c7bc6f3ecd2017dc",
        "type": "function",
        "z": "57c7b1d92e451835",
        "name": "CO",
        "func": "msg.payload = msg.payload.CO;\nmsg.topic = \"CO\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 560,
        "wires": [["23d805f13ae8ac5f"]]
    },
    {
        "id": "d22c472954590f18",
        "type": "debug",
        "z": "57c7b1d92e451835",
        "name": "debug 11",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 560,
        "wires": []
    },
    {
        "id": "23d805f13ae8ac5f",
        "type": "ui_chart",
        "z": "57c7b1d92e451835",
        "name": "",
        "group": "96e7171c97b237eb",
        "order": 7,
        "width": 14,
        "height": 4,
        "label": "CO(ppm)",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 500,
        "y": 560,
        "wires": [["d22c472954590f18"]]
    },
    {
        "id": "a763760cb68348af",
        "type": "ui_text",
        "z": "57c7b1d92e451835",
        "group": "96e7171c97b237eb",
        "order": 5,
        "width": 3,
        "height": 2,
        "name": "",
        "label": "status",
        "format": "<font face='arial'><font size=6><font color={{msg.payload.color}}>{{msg.payload.message}}",
        "layout": "col-center",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 690,
        "y": 740,
        "wires": []
    },
    {
        "id": "33bfcfa9dd06b68e",
        "type": "link in",
        "z": "57c7b1d92e451835",
        "name": "link in 4",
        "links": ["3c9bec707a983094"],
        "x": 255,
        "y": 620,
        "wires": [["09bb21f2247d9954"]]
    },
    {
        "id": "22e97827e53f55c6",
        "type": "mqtt in",
        "z": "57c7b1d92e451835",
        "name": "",
        "topic": "/intersection/condition",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "4f6c8a65bb8820c6",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 160,
        "y": 180,
        "wires": [["8c45b70d2a80fc60", "f0a819be637c181b"]]
    },
    {
        "id": "f0a819be637c181b",
        "type": "function",
        "z": "57c7b1d92e451835",
        "name": "convert data",
        "func": "let { ppm, temp, battery, smoke } = msg.payload;\n\nmsg.payload = { smoke: smoke ? smoke : 0, CO: ppm ? ppm : 0, temperture: temp ? temp : 20, battery: battery ? battery : 0 };\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 180,
        "wires": [["5c95aa95ad46e1ea"]]
    },
    {
        "id": "04fcdfd718e648bf",
        "type": "link out",
        "z": "57c7b1d92e451835",
        "name": "living room status",
        "mode": "link",
        "links": ["c97ad871543274fa", "478292a4ebaca8d2"],
        "x": 655,
        "y": 700,
        "wires": []
    },
    {
        "id": "971dcd1a10014d30",
        "type": "finite-state-machine",
        "z": "57c7b1d92e451835",
        "name": "",
        "fsmDefinition": "{\"state\":{\"status\":\"Normal\",\"data\":{\"x\":5}},\"transitions\":{\"Normal\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Normal\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Fire\":{\"temperture\":\"Fire\",\"CO\":\"Fire\",\"smoke\":\"Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Fire\",\"expire\":\"Fire\",\"reset\":\"Normal\"},\"CO too High\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"CO too High\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Smoke Detected\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Smoke Detected\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Potential Fire\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Potential Fire\",\"expire\":\"Normal\",\"reset\":\"Normal\"}}}",
        "sendInitialState": true,
        "sendStateWithoutChange": true,
        "showTransitionErrors": true,
        "x": 310,
        "y": 740,
        "wires": [["fc240a9d6d064072", "3efa7d09bc6cc961"]]
    },
    {
        "id": "09bb21f2247d9954",
        "type": "function",
        "z": "57c7b1d92e451835",
        "name": "check transition to FSM",
        "func": "const TEMP_ERROR_LIMIT = 40; // in C\nconst CO_ERROR_LIMIT = 15; // in ppm\n\nconst { smoke, temperture, CO } = msg.payload;\nmsg.topic = \"\"\nmsg.data = {smoke, temperture, CO}\nmsg.control = {}\n\nif (temperture >= TEMP_ERROR_LIMIT) {\n    msg.topic += \"temperture\";\n}\nif (CO >= CO_ERROR_LIMIT) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"CO\";\n}\nif (smoke === 1) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"smoke\";\n} \nif (msg.topic===\"\"){\n    msg.topic = \"normal\";\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 620,
        "wires": [["971dcd1a10014d30", "282cd4b4667ecf83"]]
    },
    {
        "id": "0ba6d7b86c15fdd6",
        "type": "debug",
        "z": "57c7b1d92e451835",
        "name": "state",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 820,
        "wires": []
    },
    {
        "id": "282cd4b4667ecf83",
        "type": "debug",
        "z": "57c7b1d92e451835",
        "name": "trasition",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 780,
        "y": 620,
        "wires": []
    },
    {
        "id": "bf1d31e29bbe6ce3",
        "type": "inject",
        "z": "57c7b1d92e451835",
        "name": "reset",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "reset",
        "payload": "",
        "payloadType": "date",
        "x": 90,
        "y": 740,
        "wires": [["971dcd1a10014d30"]]
    },
    {
        "id": "fc240a9d6d064072",
        "type": "function",
        "z": "57c7b1d92e451835",
        "name": "function 3",
        "func": "msg.state_color = {\n    \"Normal\": \"green\",\n    \"Fire\": \"red\",\n    \"CO too High\": \"orange\",\n    \"Smoke Detected\": \"orange\",\n    \"Potential Fire\": \"orange\"\n}\nmsg.payload = {\n    place: \"intersection\",\n    message: msg.payload.status,\n    color: msg.state_color[msg.payload.status]\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 740,
        "wires": [
            [
                "0ba6d7b86c15fdd6",
                "a763760cb68348af",
                "04fcdfd718e648bf",
                "8231bc33d1e00aeb"
            ]
        ]
    },
    {
        "id": "3efa7d09bc6cc961",
        "type": "debug",
        "z": "57c7b1d92e451835",
        "name": "debug 14",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 460,
        "y": 820,
        "wires": []
    },
    {
        "id": "4378195d414d5d03",
        "type": "line-notify",
        "z": "57c7b1d92e451835",
        "d": true,
        "name": "test YCK",
        "message": "",
        "contentType": "message",
        "imageThumbnail": "",
        "imageUrl": "",
        "sticker": "default",
        "stickerPackageId": "1",
        "stickerId": "1",
        "silent": false,
        "creds": "63115de6b1972cd9",
        "x": 980,
        "y": 920,
        "wires": [[]]
    },
    {
        "id": "6ef331ce77486f48",
        "type": "inject",
        "z": "57c7b1d92e451835",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 270,
        "y": 920,
        "wires": [["8231bc33d1e00aeb"]]
    },
    {
        "id": "8231bc33d1e00aeb",
        "type": "rbe",
        "z": "57c7b1d92e451835",
        "name": "block the same value",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": true,
        "property": "payload",
        "topi": "topic",
        "x": 600,
        "y": 920,
        "wires": [["192b43b6da12e13c"]]
    },
    {
        "id": "192b43b6da12e13c",
        "type": "function",
        "z": "57c7b1d92e451835",
        "name": "modify message",
        "func": "const place = \"intersection\"\nif (msg.payload.message==\"Normal\"){\n    return;\n}\nmsg.payload = \"\\n注意！\\n\" + place + \": \" + msg.payload.message\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 920,
        "wires": [["4378195d414d5d03"]]
    },
    {
        "id": "c85e26de84759696",
        "type": "ui_ui_control",
        "z": "57c7b1d92e451835",
        "name": "navigation",
        "events": "all",
        "x": 530,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "d41c4b23b622bde7",
        "type": "ui_template",
        "z": "57c7b1d92e451835",
        "group": "96e7171c97b237eb",
        "name": "Back Home",
        "order": 2,
        "width": 2,
        "height": 1,
        "format": "<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#e67e22\"\n    ng-click=\"send({payload: 'Home'})\">\n    Back\n</md-button>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 370,
        "y": 1020,
        "wires": [["c85e26de84759696"]]
    },
    {
        "id": "6d886a8dc11d2d17",
        "type": "ui_template",
        "z": "57c7b1d92e451835",
        "group": "dc87ea581ec639fa",
        "name": "button css",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<style>\n  * {\n      overflow: hidden;\n  }\n  .filled { \n      height: 90% !important;\n      width: 90% !important;\n      padding: 0 !important;\n      margin: 4% !important;\n  }\n  .nr-dashboard-template {\n      padding: 0;\n      margin: 0;\n  }\n  \n  .rounded {\n  border-radius: 12px 12px 12px 12px;\n}\n \n   .bigfont {\n  font-size: 18px;\n}\n\n   .smallfont {\n  font-size: 12px;\n}\n  \n</style>\n\n<script>\n$('.vibrate').on('click', function() {\n  navigator.vibrate(100);\n});\n\nfunction restore_bg(x) {\n            $(this).css(\"background-color\", x);\n    };\n\n$('.touched').on('mousedown', function() {\n    \n    var x= $(this).css(\"background-color\");\n    $(this).css(\"background-color\", \"yellow\");\n    \n    setTimeout(restore_bg.bind(this,x),100);\n    navigator.vibrate(80);\n    });\n    \n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "global",
        "className": "",
        "x": 190,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "b142b627b3d59021",
        "type": "inject",
        "z": "57c7b1d92e451835",
        "name": "normal",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":8,\"temperture\":30,\"battery\":0}",
        "payloadType": "json",
        "x": 200,
        "y": 220,
        "wires": [["db6d78acf58f46dc"]]
    },
    {
        "id": "079afc1d6d8862df",
        "type": "inject",
        "z": "57c7b1d92e451835",
        "name": "smoke",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":1,\"CO\":8,\"temperture\":30}",
        "payloadType": "json",
        "x": 190,
        "y": 260,
        "wires": [["db6d78acf58f46dc"]]
    },
    {
        "id": "626dbe93a650784b",
        "type": "inject",
        "z": "57c7b1d92e451835",
        "name": "CO",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":30}",
        "payloadType": "json",
        "x": 190,
        "y": 300,
        "wires": [["db6d78acf58f46dc"]]
    },
    {
        "id": "47726ff4e1bc8824",
        "type": "inject",
        "z": "57c7b1d92e451835",
        "name": "fire",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":45}",
        "payloadType": "json",
        "x": 190,
        "y": 340,
        "wires": [["db6d78acf58f46dc"]]
    },
    {
        "id": "db6d78acf58f46dc",
        "type": "delay",
        "z": "57c7b1d92e451835",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 410,
        "y": 280,
        "wires": [["5c95aa95ad46e1ea"]]
    },
    {
        "id": "de8638a39edb4bbf",
        "type": "link in",
        "z": "57c7b1d92e451835",
        "name": "all reset",
        "links": ["1765ee585273167c"],
        "x": 135,
        "y": 800,
        "wires": [["971dcd1a10014d30"]]
    },
    {
        "id": "9aab84c74237fcae",
        "type": "link in",
        "z": "57c7b1d92e451835",
        "name": "reset",
        "links": ["1765ee585273167c"],
        "x": 95,
        "y": 380,
        "wires": [["d741fa5a759d86cc"]]
    },
    {
        "id": "d741fa5a759d86cc",
        "type": "function",
        "z": "57c7b1d92e451835",
        "name": "reset normal",
        "func": "msg.payload = { \"smoke\": 0, \"CO\": 8, \"temperture\": 30 }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 210,
        "y": 380,
        "wires": [["db6d78acf58f46dc"]]
    },
    {
        "id": "e6bb139397cbe35c",
        "type": "ui_ui_control",
        "z": "57c7b1d92e451835",
        "name": "",
        "events": "all",
        "x": 80,
        "y": 840,
        "wires": [["b783fa0558aa360c"]]
    },
    {
        "id": "b783fa0558aa360c",
        "type": "function",
        "z": "57c7b1d92e451835",
        "name": "trigger when chage page",
        "func": "msg.topic = \"normal\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 270,
        "y": 840,
        "wires": [["971dcd1a10014d30"]]
    },
    {
        "id": "e9e9b9c5aad4d6dc",
        "type": "ui_template",
        "z": "57c7b1d92e451835",
        "group": "96e7171c97b237eb",
        "name": "煙霧顯示",
        "order": 6,
        "width": 3,
        "height": 2,
        "format": "<div id=\"graphics\" ng-init=\"checkSVG()\" style=\"display: flex; justify-content:center;align-items:center\">\n    <p id=\"e1_text\">煙霧</p>\n    <svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0\" y=\"0\" height=\"34\"\n        viewBox=\"0 0 34 34\" width=\"34\" preserveAspectRatio=\"xMidYMid meet\">\n        <circle id=\"e1_circle\" cx=\"17\" cy=\"17\" style=\"fill:green;stroke-width:0px;overflow:hidden\" r=\"16\" />\n    </svg>\n    <script>\n        (function($scope) {\n                $scope.$watch('msg', function() {\n                    if (!$scope.msg) return;\n                    const color=$scope.msg.payload?.color;\n                    const topic=$scope.msg.topic;\n                    if (color === undefined || color === null ||\n                        !topic || typeof topic !== 'string' || !topic.includes('@')) return;\n                    const id = topic.split('@')[0], cxType = topic.split('@')[1];\n                    document.getElementById(id+\"_circle\").style.fill=color;\n                    document.getElementById(id+\"_text\").style.cssText = `color:${color} !important;font-weight:bold` ;\n                });\n            })(scope);\n    </script>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 500,
        "y": 440,
        "wires": [["be5d4f55e3148de6"]]
    },
    {
        "id": "bdfb55120fa5e3c2",
        "type": "ui_template",
        "z": "57c7b1d92e451835",
        "group": "96e7171c97b237eb",
        "name": "power icon",
        "order": 3,
        "width": 1,
        "height": 1,
        "format": "<div style=\"display: flex; justify-content:center;align-items:center;height: auto; width: auto\">\n    <img id=\"battery\" style=\"height: auto; width: auto;display: none\" src=\"/half-battery.png\">\n    <img id=\"charging\" style=\"height: auto; width: auto;display: block\" src=\"/low-battery.png\">\n</div>\n\n<script>\n    (function($scope) {\n        $scope.$watch('msg', function() {\n            if (!$scope.msg) return;\n            const battery=$scope.msg.payload?.battery;\n            // console.log(battery);\n            if(battery){\n                $(\"#battery\").css(\"display\",battery?\"block\":\"none\");\n                $(\"#charging\").css(\"display\",battery?\"none\":\"block\");\n            }\n        });\n    })(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 510,
        "y": 400,
        "wires": [[]]
    },
    {
        "id": "32ad5eee10b8ea6e",
        "type": "link in",
        "z": "57c7b1d92e451835",
        "name": "link in 7",
        "links": ["3c9bec707a983094"],
        "x": 365,
        "y": 400,
        "wires": [["bdfb55120fa5e3c2"]]
    },
    {
        "id": "5c95aa95ad46e1ea",
        "type": "function",
        "z": "57c7b1d92e451835",
        "name": "add node information",
        "func": "msg.payload.place = \"intersection\";\nmsg.payload.time = Date.now();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 740,
        "y": 200,
        "wires": [["3c9bec707a983094"]]
    },
    {
        "id": "9c14b740bcfc513e",
        "type": "comment",
        "z": "57c7b1d92e451835",
        "name": "改place",
        "info": "改place",
        "x": 510,
        "y": 700,
        "wires": []
    },
    {
        "id": "7559f0ece5180d09",
        "type": "comment",
        "z": "57c7b1d92e451835",
        "name": "改place",
        "info": "改place",
        "x": 748.3333129882812,
        "y": 166.3333282470703,
        "wires": []
    },
    {
        "id": "03d564c16ab0abab",
        "type": "comment",
        "z": "57c7b1d92e451835",
        "name": "改place",
        "info": "改place",
        "x": 97.33332824707031,
        "y": 146.3333282470703,
        "wires": []
    },
    {
        "id": "98d0e547eaef1273",
        "type": "comment",
        "z": "57c7b1d92e451835",
        "name": "改place",
        "info": "改place",
        "x": 842.3333129882812,
        "y": 885.3333740234375,
        "wires": []
    },
    {
        "id": "83fb4b320fdea428",
        "type": "comment",
        "z": "57c7b1d92e451835",
        "name": "改group",
        "info": "",
        "x": 390,
        "y": 980,
        "wires": []
    },
    {
        "id": "2fdfb0e70b8eb722",
        "type": "comment",
        "z": "57c7b1d92e451835",
        "name": "改group",
        "info": "",
        "x": 750,
        "y": 700,
        "wires": []
    },
    {
        "id": "def08a6f435e4e65",
        "type": "comment",
        "z": "57c7b1d92e451835",
        "name": "改group",
        "info": "",
        "x": 530,
        "y": 360,
        "wires": []
    },
    {
        "id": "58bece7ac26785b6",
        "type": "random",
        "z": "c2efc8683c66d9a1",
        "name": "偵煙器",
        "low": "0",
        "high": "1",
        "inte": "true",
        "property": "payload",
        "x": 230,
        "y": 40,
        "wires": [["9b59e5e5fa732412"]]
    },
    {
        "id": "de79367fd27163a8",
        "type": "random",
        "z": "c2efc8683c66d9a1",
        "name": "CO(ppm)",
        "low": "0",
        "high": 10,
        "inte": "false",
        "property": "payload",
        "x": 240,
        "y": 80,
        "wires": [["d3023f83796093d9"]]
    },
    {
        "id": "45c08ebd0f73eb96",
        "type": "random",
        "z": "c2efc8683c66d9a1",
        "name": "溫度",
        "low": "-10",
        "high": "50",
        "inte": "false",
        "property": "payload",
        "x": 230,
        "y": 120,
        "wires": [["efd3b9bac5963d9c"]]
    },
    {
        "id": "b0d2c105de5c947b",
        "type": "join",
        "z": "c2efc8683c66d9a1",
        "name": "",
        "mode": "custom",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "1",
        "count": "3",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 550,
        "y": 80,
        "wires": [["add2a09fa211e4ae"]]
    },
    {
        "id": "5eb2b69d4c6e9db6",
        "type": "debug",
        "z": "c2efc8683c66d9a1",
        "name": "combine",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 400,
        "y": 220,
        "wires": []
    },
    {
        "id": "9b59e5e5fa732412",
        "type": "change",
        "z": "c2efc8683c66d9a1",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "smoke",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 40,
        "wires": [["b0d2c105de5c947b"]]
    },
    {
        "id": "d3023f83796093d9",
        "type": "change",
        "z": "c2efc8683c66d9a1",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "CO",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 80,
        "wires": [["b0d2c105de5c947b"]]
    },
    {
        "id": "efd3b9bac5963d9c",
        "type": "change",
        "z": "c2efc8683c66d9a1",
        "name": "add topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperture",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 120,
        "wires": [["b0d2c105de5c947b"]]
    },
    {
        "id": "d55e83452fbbdfd7",
        "type": "inject",
        "z": "c2efc8683c66d9a1",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 70,
        "y": 80,
        "wires": [["58bece7ac26785b6", "de79367fd27163a8", "45c08ebd0f73eb96"]]
    },
    {
        "id": "0e29c3c7de2bc268",
        "type": "link out",
        "z": "c2efc8683c66d9a1",
        "name": "link out 1",
        "mode": "link",
        "links": [
            "7eab25f341ba4d42",
            "369f6446ee920700",
            "1b33a10eb9ab8621",
            "0e4551baf86f53ec",
            "e13d9bd9c95d6f28"
        ],
        "x": 895,
        "y": 200,
        "wires": []
    },
    {
        "id": "7eab25f341ba4d42",
        "type": "link in",
        "z": "c2efc8683c66d9a1",
        "name": "link in 1",
        "links": ["0e29c3c7de2bc268"],
        "x": 255,
        "y": 440,
        "wires": [["71f0a3723a920626"]]
    },
    {
        "id": "71f0a3723a920626",
        "type": "function",
        "z": "c2efc8683c66d9a1",
        "name": "function 2",
        "func": "if(msg.payload.smoke===0){\n    msg.payload.color =\"#008000\"; //\"green\";\n}else{\n    msg.payload.color = \"#b22222\"; // \"firebrick\";\n}\nmsg.topic = \"e1@cx_color\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 440,
        "wires": [["406751d24e0486c7"]]
    },
    {
        "id": "2d9f7d532aa95175",
        "type": "debug",
        "z": "c2efc8683c66d9a1",
        "name": "debug 9",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 440,
        "wires": []
    },
    {
        "id": "369f6446ee920700",
        "type": "link in",
        "z": "c2efc8683c66d9a1",
        "name": "link in 2",
        "links": ["0e29c3c7de2bc268"],
        "x": 255,
        "y": 500,
        "wires": [["28eef071c12a39c8"]]
    },
    {
        "id": "28eef071c12a39c8",
        "type": "function",
        "z": "c2efc8683c66d9a1",
        "name": "溫度",
        "func": "msg.payload = msg.payload.temperture;\nmsg.topic = \"temperture\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 500,
        "wires": [["4aa4c28ace00959f"]]
    },
    {
        "id": "d045e425f6732518",
        "type": "debug",
        "z": "c2efc8683c66d9a1",
        "name": "debug 10",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 500,
        "wires": []
    },
    {
        "id": "4aa4c28ace00959f",
        "type": "ui_chart",
        "z": "c2efc8683c66d9a1",
        "name": "",
        "group": "0253ddd8e0d72747",
        "order": 4,
        "width": 11,
        "height": 5,
        "label": "溫度",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "-10",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 490,
        "y": 500,
        "wires": [["d045e425f6732518"]]
    },
    {
        "id": "1b33a10eb9ab8621",
        "type": "link in",
        "z": "c2efc8683c66d9a1",
        "name": "link in 3",
        "links": ["0e29c3c7de2bc268"],
        "x": 255,
        "y": 560,
        "wires": [["ed4fb6ec2a176b7e"]]
    },
    {
        "id": "ed4fb6ec2a176b7e",
        "type": "function",
        "z": "c2efc8683c66d9a1",
        "name": "CO",
        "func": "msg.payload = msg.payload.CO;\nmsg.topic = \"CO\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 560,
        "wires": [["5475a1ef384d2168"]]
    },
    {
        "id": "e4773efe22645554",
        "type": "debug",
        "z": "c2efc8683c66d9a1",
        "name": "debug 11",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 560,
        "wires": []
    },
    {
        "id": "5475a1ef384d2168",
        "type": "ui_chart",
        "z": "c2efc8683c66d9a1",
        "name": "",
        "group": "0253ddd8e0d72747",
        "order": 7,
        "width": 14,
        "height": 4,
        "label": "CO(ppm)",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "50",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 500,
        "y": 560,
        "wires": [["e4773efe22645554"]]
    },
    {
        "id": "8463eb5a4f0f594b",
        "type": "ui_text",
        "z": "c2efc8683c66d9a1",
        "group": "0253ddd8e0d72747",
        "order": 5,
        "width": 3,
        "height": 2,
        "name": "",
        "label": "status",
        "format": "<font face='arial'><font size=6><font color={{msg.payload.color}}>{{msg.payload.message}}",
        "layout": "col-center",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 690,
        "y": 740,
        "wires": []
    },
    {
        "id": "0e4551baf86f53ec",
        "type": "link in",
        "z": "c2efc8683c66d9a1",
        "name": "link in 4",
        "links": ["0e29c3c7de2bc268"],
        "x": 255,
        "y": 620,
        "wires": [["5c6f70f1e02b560f"]]
    },
    {
        "id": "ef8bc3464129a5a2",
        "type": "mqtt in",
        "z": "c2efc8683c66d9a1",
        "name": "",
        "topic": "/studyroom/condition",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "4f6c8a65bb8820c6",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 160,
        "y": 180,
        "wires": [["5eb2b69d4c6e9db6", "443ede63dbc38f4b"]]
    },
    {
        "id": "443ede63dbc38f4b",
        "type": "function",
        "z": "c2efc8683c66d9a1",
        "name": "convert data",
        "func": "let { ppm, temp, battery, smoke } = msg.payload;\n\nmsg.payload = { smoke: smoke ? smoke : 0, CO: ppm ? ppm : 0, temperture: temp ? temp : 20, battery: battery ? battery : 0 };\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 180,
        "wires": [["add2a09fa211e4ae"]]
    },
    {
        "id": "9963e0ad05c81d8d",
        "type": "link out",
        "z": "c2efc8683c66d9a1",
        "name": "living room status",
        "mode": "link",
        "links": ["c97ad871543274fa", "478292a4ebaca8d2"],
        "x": 655,
        "y": 700,
        "wires": []
    },
    {
        "id": "5e4d28207de508cd",
        "type": "finite-state-machine",
        "z": "c2efc8683c66d9a1",
        "name": "",
        "fsmDefinition": "{\"state\":{\"status\":\"Normal\",\"data\":{\"x\":5}},\"transitions\":{\"Normal\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Normal\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Fire\":{\"temperture\":\"Fire\",\"CO\":\"Fire\",\"smoke\":\"Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Fire\",\"temperture_CO_smoke\":\"Fire\",\"test\":\"Fire\",\"normal\":\"Fire\",\"expire\":\"Fire\",\"reset\":\"Normal\"},\"CO too High\":{\"temperture\":\"Fire\",\"CO\":\"CO too High\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"CO too High\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Smoke Detected\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Smoke Detected\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Smoke Detected\",\"expire\":\"Normal\",\"reset\":\"Normal\"},\"Potential Fire\":{\"temperture\":\"Fire\",\"CO\":\"Potential Fire\",\"smoke\":\"Potential Fire\",\"temperture_CO\":\"Fire\",\"temperture_smoke\":\"Fire\",\"CO_smoke\":\"Potential Fire\",\"temperture_CO_smoke\":\"Fire\",\"normal\":\"Potential Fire\",\"expire\":\"Normal\",\"reset\":\"Normal\"}}}",
        "sendInitialState": true,
        "sendStateWithoutChange": true,
        "showTransitionErrors": true,
        "x": 310,
        "y": 740,
        "wires": [["e628440640afea3c", "b920915a4de35e49"]]
    },
    {
        "id": "5c6f70f1e02b560f",
        "type": "function",
        "z": "c2efc8683c66d9a1",
        "name": "check transition to FSM",
        "func": "const TEMP_ERROR_LIMIT = 40; // in C\nconst CO_ERROR_LIMIT = 15; // in ppm\n\nconst { smoke, temperture, CO } = msg.payload;\nmsg.topic = \"\"\nmsg.data = {smoke, temperture, CO}\nmsg.control = {}\n\nif (temperture >= TEMP_ERROR_LIMIT) {\n    msg.topic += \"temperture\";\n}\nif (CO >= CO_ERROR_LIMIT) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"CO\";\n}\nif (smoke === 1) {\n    if (msg.topic !== \"\") msg.topic += \"_\";\n    msg.topic += \"smoke\";\n} \nif (msg.topic===\"\"){\n    msg.topic = \"normal\";\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 620,
        "wires": [["5e4d28207de508cd", "b10aca74ce564e8a"]]
    },
    {
        "id": "f4f404526dd789e7",
        "type": "debug",
        "z": "c2efc8683c66d9a1",
        "name": "state",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 820,
        "wires": []
    },
    {
        "id": "b10aca74ce564e8a",
        "type": "debug",
        "z": "c2efc8683c66d9a1",
        "name": "trasition",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 780,
        "y": 620,
        "wires": []
    },
    {
        "id": "5e43a0d23b3423f5",
        "type": "inject",
        "z": "c2efc8683c66d9a1",
        "name": "reset",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "reset",
        "payload": "",
        "payloadType": "date",
        "x": 90,
        "y": 740,
        "wires": [["5e4d28207de508cd"]]
    },
    {
        "id": "e628440640afea3c",
        "type": "function",
        "z": "c2efc8683c66d9a1",
        "name": "function 3",
        "func": "msg.state_color = {\n    \"Normal\": \"green\",\n    \"Fire\": \"red\",\n    \"CO too High\": \"orange\",\n    \"Smoke Detected\": \"orange\",\n    \"Potential Fire\": \"orange\"\n}\nmsg.payload = {\n    place: \"studyroom\",\n    message: msg.payload.status,\n    color: msg.state_color[msg.payload.status]\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 740,
        "wires": [
            [
                "f4f404526dd789e7",
                "8463eb5a4f0f594b",
                "9963e0ad05c81d8d",
                "fc3d951e47faa929"
            ]
        ]
    },
    {
        "id": "b920915a4de35e49",
        "type": "debug",
        "z": "c2efc8683c66d9a1",
        "name": "debug 14",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 460,
        "y": 820,
        "wires": []
    },
    {
        "id": "be7f071224206fb5",
        "type": "line-notify",
        "z": "c2efc8683c66d9a1",
        "d": true,
        "name": "test YCK",
        "message": "",
        "contentType": "message",
        "imageThumbnail": "",
        "imageUrl": "",
        "sticker": "default",
        "stickerPackageId": "1",
        "stickerId": "1",
        "silent": false,
        "creds": "63115de6b1972cd9",
        "x": 980,
        "y": 920,
        "wires": [[]]
    },
    {
        "id": "1d85f87203b3565d",
        "type": "inject",
        "z": "c2efc8683c66d9a1",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 270,
        "y": 920,
        "wires": [["fc3d951e47faa929"]]
    },
    {
        "id": "fc3d951e47faa929",
        "type": "rbe",
        "z": "c2efc8683c66d9a1",
        "name": "block the same value",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": true,
        "property": "payload",
        "topi": "topic",
        "x": 600,
        "y": 920,
        "wires": [["b1dff6733033056e"]]
    },
    {
        "id": "b1dff6733033056e",
        "type": "function",
        "z": "c2efc8683c66d9a1",
        "name": "modify message",
        "func": "const place = \"study room\"\nif (msg.payload.message==\"Normal\"){\n    return;\n}\nmsg.payload = \"\\n注意！\\n\" + place + \": \" + msg.payload.message\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 920,
        "wires": [["be7f071224206fb5"]]
    },
    {
        "id": "448971eca4c993bf",
        "type": "ui_ui_control",
        "z": "c2efc8683c66d9a1",
        "name": "navigation",
        "events": "all",
        "x": 530,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "e7e1686470400ea9",
        "type": "ui_template",
        "z": "c2efc8683c66d9a1",
        "group": "0253ddd8e0d72747",
        "name": "Back Home",
        "order": 2,
        "width": 2,
        "height": 1,
        "format": "<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#e67e22\"\n    ng-click=\"send({payload: 'Home'})\">\n    Back\n</md-button>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 370,
        "y": 1020,
        "wires": [["448971eca4c993bf"]]
    },
    {
        "id": "f3f9bc29d954fe6c",
        "type": "ui_template",
        "z": "c2efc8683c66d9a1",
        "group": "dc87ea581ec639fa",
        "name": "button css",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<style>\n  * {\n      overflow: hidden;\n  }\n  .filled { \n      height: 90% !important;\n      width: 90% !important;\n      padding: 0 !important;\n      margin: 4% !important;\n  }\n  .nr-dashboard-template {\n      padding: 0;\n      margin: 0;\n  }\n  \n  .rounded {\n  border-radius: 12px 12px 12px 12px;\n}\n \n   .bigfont {\n  font-size: 18px;\n}\n\n   .smallfont {\n  font-size: 12px;\n}\n  \n</style>\n\n<script>\n$('.vibrate').on('click', function() {\n  navigator.vibrate(100);\n});\n\nfunction restore_bg(x) {\n            $(this).css(\"background-color\", x);\n    };\n\n$('.touched').on('mousedown', function() {\n    \n    var x= $(this).css(\"background-color\");\n    $(this).css(\"background-color\", \"yellow\");\n    \n    setTimeout(restore_bg.bind(this,x),100);\n    navigator.vibrate(80);\n    });\n    \n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "global",
        "className": "",
        "x": 190,
        "y": 1020,
        "wires": [[]]
    },
    {
        "id": "d423083d6b6e8725",
        "type": "inject",
        "z": "c2efc8683c66d9a1",
        "name": "normal",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":8,\"temperture\":30,\"battery\":0}",
        "payloadType": "json",
        "x": 200,
        "y": 220,
        "wires": [["0d4e5849cb2a79de"]]
    },
    {
        "id": "10b35449d1ad3983",
        "type": "inject",
        "z": "c2efc8683c66d9a1",
        "name": "smoke",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":1,\"CO\":8,\"temperture\":30}",
        "payloadType": "json",
        "x": 190,
        "y": 260,
        "wires": [["0d4e5849cb2a79de"]]
    },
    {
        "id": "502026d8b8229035",
        "type": "inject",
        "z": "c2efc8683c66d9a1",
        "name": "CO",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":30}",
        "payloadType": "json",
        "x": 190,
        "y": 300,
        "wires": [["0d4e5849cb2a79de"]]
    },
    {
        "id": "52050478a1d19a37",
        "type": "inject",
        "z": "c2efc8683c66d9a1",
        "name": "fire",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"smoke\":0,\"CO\":15,\"temperture\":45}",
        "payloadType": "json",
        "x": 190,
        "y": 340,
        "wires": [["0d4e5849cb2a79de"]]
    },
    {
        "id": "0d4e5849cb2a79de",
        "type": "delay",
        "z": "c2efc8683c66d9a1",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 410,
        "y": 280,
        "wires": [["add2a09fa211e4ae"]]
    },
    {
        "id": "2c7111d42b0835aa",
        "type": "link in",
        "z": "c2efc8683c66d9a1",
        "name": "all reset",
        "links": ["1765ee585273167c"],
        "x": 135,
        "y": 800,
        "wires": [["5e4d28207de508cd"]]
    },
    {
        "id": "05c1759334a8cbd3",
        "type": "link in",
        "z": "c2efc8683c66d9a1",
        "name": "reset",
        "links": ["1765ee585273167c"],
        "x": 95,
        "y": 380,
        "wires": [["d2047423ddeffc5c"]]
    },
    {
        "id": "d2047423ddeffc5c",
        "type": "function",
        "z": "c2efc8683c66d9a1",
        "name": "reset normal",
        "func": "msg.payload = { \"smoke\": 0, \"CO\": 8, \"temperture\": 30 }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 210,
        "y": 380,
        "wires": [["0d4e5849cb2a79de"]]
    },
    {
        "id": "d65ac95ac52785df",
        "type": "ui_ui_control",
        "z": "c2efc8683c66d9a1",
        "name": "",
        "events": "all",
        "x": 80,
        "y": 840,
        "wires": [["bcd694f9d581fc40"]]
    },
    {
        "id": "bcd694f9d581fc40",
        "type": "function",
        "z": "c2efc8683c66d9a1",
        "name": "trigger when chage page",
        "func": "msg.topic = \"normal\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 270,
        "y": 840,
        "wires": [["5e4d28207de508cd"]]
    },
    {
        "id": "406751d24e0486c7",
        "type": "ui_template",
        "z": "c2efc8683c66d9a1",
        "group": "0253ddd8e0d72747",
        "name": "煙霧顯示",
        "order": 6,
        "width": 3,
        "height": 2,
        "format": "<div id=\"graphics\" ng-init=\"checkSVG()\" style=\"display: flex; justify-content:center;align-items:center\">\n    <p id=\"e1_text\">煙霧</p>\n    <svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0\" y=\"0\" height=\"34\"\n        viewBox=\"0 0 34 34\" width=\"34\" preserveAspectRatio=\"xMidYMid meet\">\n        <circle id=\"e1_circle\" cx=\"17\" cy=\"17\" style=\"fill:green;stroke-width:0px;overflow:hidden\" r=\"16\" />\n    </svg>\n    <script>\n        (function($scope) {\n                $scope.$watch('msg', function() {\n                    if (!$scope.msg) return;\n                    const color=$scope.msg.payload?.color;\n                    const topic=$scope.msg.topic;\n                    if (color === undefined || color === null ||\n                        !topic || typeof topic !== 'string' || !topic.includes('@')) return;\n                    const id = topic.split('@')[0], cxType = topic.split('@')[1];\n                    document.getElementById(id+\"_circle\").style.fill=color;\n                    document.getElementById(id+\"_text\").style.cssText = `color:${color} !important;font-weight:bold` ;\n                });\n            })(scope);\n    </script>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 500,
        "y": 440,
        "wires": [["2d9f7d532aa95175"]]
    },
    {
        "id": "841e900a38092691",
        "type": "ui_template",
        "z": "c2efc8683c66d9a1",
        "group": "0253ddd8e0d72747",
        "name": "power icon",
        "order": 3,
        "width": 1,
        "height": 1,
        "format": "<div style=\"display: flex; justify-content:center;align-items:center;height: auto; width: auto\">\n    <img id=\"battery\" style=\"height: auto; width: auto;display: none\" src=\"/half-battery.png\">\n    <img id=\"charging\" style=\"height: auto; width: auto;display: block\" src=\"/low-battery.png\">\n</div>\n\n<script>\n    (function($scope) {\n        $scope.$watch('msg', function() {\n            if (!$scope.msg) return;\n            const battery=$scope.msg.payload?.battery;\n            // console.log(battery);\n            if(battery){\n                $(\"#battery\").css(\"display\",battery?\"block\":\"none\");\n                $(\"#charging\").css(\"display\",battery?\"none\":\"block\");\n            }\n        });\n    })(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 510,
        "y": 400,
        "wires": [[]]
    },
    {
        "id": "e13d9bd9c95d6f28",
        "type": "link in",
        "z": "c2efc8683c66d9a1",
        "name": "link in 7",
        "links": ["0e29c3c7de2bc268"],
        "x": 365,
        "y": 400,
        "wires": [["841e900a38092691"]]
    },
    {
        "id": "add2a09fa211e4ae",
        "type": "function",
        "z": "c2efc8683c66d9a1",
        "name": "add node information",
        "func": "msg.payload.place = \"studyroom\";\nmsg.payload.time = Date.now();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 740,
        "y": 200,
        "wires": [["0e29c3c7de2bc268"]]
    },
    {
        "id": "ee8eda0cf4e63e24",
        "type": "comment",
        "z": "c2efc8683c66d9a1",
        "name": "改place",
        "info": "改place",
        "x": 510,
        "y": 700,
        "wires": []
    },
    {
        "id": "0eb765d90f5e8455",
        "type": "comment",
        "z": "c2efc8683c66d9a1",
        "name": "改place",
        "info": "改place",
        "x": 748.3333129882812,
        "y": 166.3333282470703,
        "wires": []
    },
    {
        "id": "d3bc54fd55458671",
        "type": "comment",
        "z": "c2efc8683c66d9a1",
        "name": "改place",
        "info": "改place",
        "x": 97.33332824707031,
        "y": 146.3333282470703,
        "wires": []
    },
    {
        "id": "2bfa7cd578e62c21",
        "type": "comment",
        "z": "c2efc8683c66d9a1",
        "name": "改place",
        "info": "改place",
        "x": 842.3333129882812,
        "y": 885.3333740234375,
        "wires": []
    },
    {
        "id": "197b8803ba2ad453",
        "type": "comment",
        "z": "c2efc8683c66d9a1",
        "name": "改group",
        "info": "",
        "x": 390,
        "y": 980,
        "wires": []
    },
    {
        "id": "9cd7343a40ad97e3",
        "type": "comment",
        "z": "c2efc8683c66d9a1",
        "name": "改group",
        "info": "",
        "x": 750,
        "y": 700,
        "wires": []
    },
    {
        "id": "d54a46b018a30112",
        "type": "comment",
        "z": "c2efc8683c66d9a1",
        "name": "改group",
        "info": "",
        "x": 530,
        "y": 360,
        "wires": []
    }
]
